
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231493195</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0463000300">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0463000300">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0463000300" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0463000300" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0463000300" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0463000300',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="fe8RkYj5XnTyCAah5SIoz5Zb6pgwBNMYOgmwF9frSzPwXYpmR8_LZWpsKM7uOxnTyeU-7KzSZoBJXEX_id8C_xSSFTw1" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/new_taipei_city.svg" width="100%" class="vipstop-city" alt="新北市">                
 <span class="stationlist-title"><font style="border-style:solid;}">三峽-捷運台大醫院站</font></span> 

                        <a href="../EBus/VsSimpleMap?routeid=0463000300" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0463000300" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">新北市政府交通局公車申訴服務電話02-89682460</a></div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">三峽 - 捷運台大醫院站</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 0630 - 1740 <br>
                        [假日] 停駛
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> 班表:0630 0700 0720 0740 0800 1600 1630 1700 1720 1740<br>
[假日]<br /> <br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content">去程：國道3號、捷運府中站；返程：國道3號、捷運府中站-新北板橋公車站</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content">三段票</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">臺北客運三峽二站:02-8671-3796</span>
                </li>

                    <li>
                        <span class="stationlist-move-route-bus-item">備註 :</span>
                        <span class="stationlist-move-route-bus-content">例假日停駛</span>
                    </li>
            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 捷運台大醫院站</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 三峽</a>
                </p>


            <p> 
</p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">三峽二站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374100220" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="24.941182" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.378934" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">學成大成路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2385401820" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.946176" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3826686" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">北美館社區</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2385300260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.948895" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3843777" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">森林公園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2385300560" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.948158" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3797908" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">學勤路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2385300940" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.94629" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.37483" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">臺北大學正門</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374103540" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.94489" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.37368" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">學成路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374109340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.9416" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.37419" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">恩主公醫院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374106160" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.938831" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3635229" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">捷運府中站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2206301200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.009094" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.460151" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">萬華車站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1086200220" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.032837" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5007597" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">捷運西門站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1004200400" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.040946" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5082192" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">寶慶路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1004300220" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.041491" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.509834" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">博物館(襄陽)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1004600320" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.043373" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5146668" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">捷運台大醫院站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1004600040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.041935" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5161481" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">衡陽路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1004300160" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.0423" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.51088" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">捷運西門站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1084600340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.041649" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5078873" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">萬華車站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1086000560" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.033084" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.499973" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">新北板橋公車站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2204100260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.012769" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.46261" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">捷運府中站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2206301240" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.009314" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.459946" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">恩主公醫院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374106120" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.93848" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.362591" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">學成路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374109300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.94144" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.37434" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">臺北大學正門</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374103500" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.944914" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.373877" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">學勤路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374109600" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.94605" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.37486" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">森林公園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2385300520" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.947989" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.379996" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">上善若水社區</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2385300020" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.948611" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.384652" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">學成大成路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2385401860" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.94639" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.382497" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">三峽二站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2374100220" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.941182" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.378934" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0463000300";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 14;
        var existBackNum = 13;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0463000300',
                        url: './StopStatusRecent3OfRoute?routeid=0463000300&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0463000300',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0463000300',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0463000300');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0463000300","Name":"三峽-捷運台大醫院站","BeginStop":"三峽","GoDirStops":[{"UniStopId":"2374100220","Name":"三峽二站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.378934,"Latitude":24.941182,"PublicId":"2374100220"},{"UniStopId":"2385401820","Name":"學成大成路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3826686,"Latitude":24.946176,"PublicId":"2385401820"},{"UniStopId":"2385300260","Name":"北美館社區","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3843777,"Latitude":24.948895,"PublicId":"2385300260"},{"UniStopId":"2385300560","Name":"森林公園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3797908,"Latitude":24.948158,"PublicId":"2385300560"},{"UniStopId":"2385300940","Name":"學勤路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.37483,"Latitude":24.94629,"PublicId":"2385300940"},{"UniStopId":"2374103540","Name":"臺北大學正門","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.37368,"Latitude":24.94489,"PublicId":"2374103540"},{"UniStopId":"2374109340","Name":"學成路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.37419,"Latitude":24.9416,"PublicId":"2374109340"},{"UniStopId":"2374106160","Name":"恩主公醫院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3635229,"Latitude":24.938831,"PublicId":"2374106160"},{"UniStopId":"2206301200","Name":"捷運府中站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.460151,"Latitude":25.009094,"PublicId":"2206301200"},{"UniStopId":"1086200220","Name":"萬華車站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5007597,"Latitude":25.032837,"PublicId":"1086200220"},{"UniStopId":"1004200400","Name":"捷運西門站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5082192,"Latitude":25.040946,"PublicId":"1004200400"},{"UniStopId":"1004300220","Name":"寶慶路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.509834,"Latitude":25.041491,"PublicId":"1004300220"},{"UniStopId":"1004600320","Name":"博物館(襄陽)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5146668,"Latitude":25.043373,"PublicId":"1004600320"},{"UniStopId":"1004600040","Name":"捷運台大醫院站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5161481,"Latitude":25.041935,"PublicId":"1004600040"}],"LastStop":"捷運台大醫院站","BackDirStops":[{"UniStopId":"1004300160","Name":"衡陽路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.51088,"Latitude":25.0423,"PublicId":"1004300160"},{"UniStopId":"1084600340","Name":"捷運西門站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5078873,"Latitude":25.041649,"PublicId":"1084600340"},{"UniStopId":"1086000560","Name":"萬華車站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.499973,"Latitude":25.033084,"PublicId":"1086000560"},{"UniStopId":"2204100260","Name":"新北板橋公車站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.46261,"Latitude":25.012769,"PublicId":"2204100260"},{"UniStopId":"2206301240","Name":"捷運府中站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.459946,"Latitude":25.009314,"PublicId":"2206301240"},{"UniStopId":"2374106120","Name":"恩主公醫院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.362591,"Latitude":24.93848,"PublicId":"2374106120"},{"UniStopId":"2374109300","Name":"學成路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.37434,"Latitude":24.94144,"PublicId":"2374109300"},{"UniStopId":"2374103500","Name":"臺北大學正門","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.373877,"Latitude":24.944914,"PublicId":"2374103500"},{"UniStopId":"2374109600","Name":"學勤路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.37486,"Latitude":24.94605,"PublicId":"2374109600"},{"UniStopId":"2385300520","Name":"森林公園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.379996,"Latitude":24.947989,"PublicId":"2385300520"},{"UniStopId":"2385300020","Name":"上善若水社區","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.384652,"Latitude":24.948611,"PublicId":"2385300020"},{"UniStopId":"2385401860","Name":"學成大成路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.382497,"Latitude":24.94639,"PublicId":"2385401860"},{"UniStopId":"2374100220","Name":"三峽二站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.378934,"Latitude":24.941182,"PublicId":"2374100220"}],"RouteMapUrl":"../MapOverview?nid=0463000300","RouteTracks":null,"StopDirection":null,"TicketPrice":"三段票","BusTimeDesc":"0630 - 1740","HeadwayDesc":"班表:0630 0700 0720 0740 0800 1600 1630 1700 1720 1740","HolidayBusTimeDesc":"停駛","HolidayHeadwayDesc":"","RouteNote":"例假日停駛","SegmentBuffer":"去程：國道3號、捷運府中站；返程：國道3號、捷運府中站-新北板橋公車站","StopLng":0,"StopLat":0,"IsNtpcMainLine":true,"orgphone":"臺北客運三峽二站:02-8671-3796","aliasName":null,"aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":"LINESTRING (121.378834714789 24.9411554171215, 121.378623334143 24.9406289596636, 121.378428903831 24.9397934078649, 121.378050013994 24.9398612092042, 121.377527544851 24.9401044963628, 121.377240386237 24.9402680172398, 121.376586302729 24.9411015748815, 121.376184480086 24.9415821667275, 121.375781660364 24.942198361252, 121.375382828957 24.9427906258921, 121.376678033953 24.9438096401382, 121.37796526232 24.9445873613828, 121.378330241639 24.9448147367171, 121.380242754693 24.9456409441125, 121.382196125223 24.9462691678565, 121.382503623576 24.9463247663884, 121.384056115469 24.9465999855224, 121.384979144031 24.9466717776022, 121.385258023696 24.9487011076028, 121.384188029355 24.9486454709539, 121.383152064775 24.9485816579287, 121.381789721016 24.9484196702265, 121.380315704741 24.9481005131155, 121.379504253014 24.9478876912797, 121.377255840954 24.9471807626099, 121.375177929321 24.9463033335135, 121.374537575964 24.9459831794908, 121.373449337942 24.9454189462263, 121.374212721706 24.9443452810072, 121.375024312108 24.9433211670458, 121.375501621599 24.9426866930333, 121.374992573407 24.9421660300803, 121.374332126057 24.941519282386, 121.373983604334 24.9412925945838, 121.373754776569 24.9411894291826, 121.373512808195 24.9411374697081, 121.373289462607 24.9410955924103, 121.372720130773 24.9411653879066, 121.371030225948 24.941206479243, 121.370120375818 24.9412153108025, 121.369437748289 24.9412112535185, 121.369265253705 24.9412052710474, 121.369011901697 24.9411136136311, 121.368835650915 24.9410114350736, 121.368619891192 24.9407860811096, 121.368564686146 24.940607505909, 121.368512460849 24.9402545158854, 121.368406868629 24.9397000789761, 121.368285556889 24.9388725963801, 121.36698604699 24.9389436054283, 121.36577943811 24.9389010560014, 121.363801287373 24.9386811480439, 121.362809668836 24.938546062638, 121.361549860128 24.9384682905136, 121.36094961886 24.9385001970262, 121.360386768036 24.9385919282499, 121.359733183067 24.9387394958707, 121.359255083917 24.9388511686648, 121.358967925304 24.9389269466322, 121.358511263342 24.9390406135833, 121.358317830109 24.9390386194263, 121.358130379348 24.9389787947152, 121.357958881843 24.9388471803507, 121.357875127247 24.9387474724988, 121.357811314222 24.9385201385966, 121.357835244106 24.9383087579506, 121.357973771888 24.9381306259695, 121.358166274175 24.9380255876513, 121.358381643135 24.9379936811387, 121.358529210755 24.938009634395, 121.358656836806 24.9380415409076, 121.358880182394 24.9381452370735, 121.359163352693 24.9383047696365, 121.359568284512 24.9385951351936, 121.360716568834 24.9395452931871, 121.361950187153 24.9407615711066, 121.363571821289 24.9423654069915, 121.364316254478 24.9431725069648, 121.365591517903 24.9442792641205, 121.367020959419 24.9454725990952, 121.368884147824 24.9467630079405, 121.37030570514 24.9477072200678, 121.37196135402 24.9485886374783, 121.372926638535 24.9490384481095, 121.373976948246 24.94950295848, 121.375738785988 24.9501650186164, 121.376947245153 24.9505578675527, 121.378720050759 24.9510404535558, 121.380280958304 24.9513678985874, 121.381214741213 24.951531016187, 121.383226845664 24.95179823323, 121.384793368492 24.9518917154487, 121.385989020245 24.9519247852248, 121.386605944763 24.9519418125367, 121.388020030444 24.9518971524168, 121.389201815793 24.9518312293137, 121.391654153656 24.9516842096175, 121.393393491415 24.9515318927337, 121.397323043222 24.9512528312803, 121.400894578476 24.9509038537987, 121.402731197107 24.9507423270787, 121.403959099303 24.9505907711438, 121.407727317029 24.9502513948471, 121.408818903458 24.9501903770236, 121.410178461572 24.9501969032103, 121.410844425014 24.9502158696208, 121.41190645784 24.9503435492316, 121.412983509979 24.9505921866217, 121.413960638069 24.9509511712037, 121.414993812923 24.9514107738819, 121.415943433048 24.9520193012462, 121.416440333999 24.9524003363896, 121.417596512747 24.9534909265215, 121.418223357076 24.9541967573046, 121.419175800629 24.9553819082438, 121.420204998147 24.9564486074412, 121.420872043676 24.9570179392753, 121.422091470704 24.957905339157, 121.42262590479 24.9581605912578, 121.423363742894 24.9585075745823, 121.424338885686 24.9588804819483, 121.425100653674 24.9591257632639, 121.426709938403 24.9594448283898, 121.427929666557 24.9596353482425, 121.429736834942 24.9599996355674, 121.430492126388 24.9602129200175, 121.430802185965 24.9603055177402, 121.431075767945 24.9604642565313, 121.431495260314 24.9607420489232, 121.431697182103 24.9609496160728, 121.432042424273 24.9613538513851, 121.432230951969 24.9617267434658, 121.43235248385 24.9621442295231, 121.432392609207 24.9625146141843, 121.432474683801 24.9631644381514, 121.432603170988 24.9643275218959, 121.43252739302 24.9658729935999, 121.43258123526 24.9669378734578, 121.432670972327 24.9672718947616, 121.432808569163 24.9676647436979, 121.433665558149 24.9694953798583, 121.433791190043 24.9697825384717, 121.433795178357 24.9701065889902, 121.433761277687 24.9702870602021, 121.432801091074 24.9715742885697, 121.432426189551 24.9721157022054, 121.432346423269 24.9723749426203, 121.432294575186 24.9726491392129, 121.432388300567 24.9731426930797, 121.432482025948 24.9733401146264, 121.432637570197 24.973562463136, 121.432814551634 24.9737249869346, 121.433683007024 24.9743551405584, 121.434605803193 24.9749763204755, 121.435076424253 24.975375151883, 121.435486722064 24.9758417846298, 121.43645837508 24.9770831473855, 121.437453957981 24.9787173590777, 121.438025782512 24.9797842330927, 121.438664909842 24.9812479443581, 121.439003916539 24.9822579848976, 121.439380812219 24.9836907867289, 121.439501458719 24.9842252208149, 121.439912255069 24.9859043010404, 121.440212874242 24.9871287134614, 121.440298622995 24.9873829684837, 121.440502027013 24.9877269605726, 121.440779214841 24.9880240899712, 121.441530513505 24.9886283195535, 121.441829138521 24.9890261538825, 121.442528981363 24.9905837571475, 121.443528658856 24.9917800847511, 121.44383002467 24.9922037863364, 121.444247552468 24.9928320025883, 121.445076963054 24.9938670565333, 121.445384522354 24.9941479064359, 121.446229762285 24.9948878966364, 121.4483442283 24.9966138688771, 121.450032103495 24.99798689853, 121.450474307818 24.9984286043138, 121.450824780917 24.9988324211138, 121.451348745678 24.9996181189866, 121.451820405507 25.0005935461501, 121.452139927483 25.0014607200891, 121.452301454203 25.0026771558819, 121.452313419145 25.0033880728657, 121.452287495104 25.0039035624599, 121.452369255542 25.0040212177251, 121.452577283252 25.0039958904996, 121.452719632449 25.0039125787, 121.452864709169 25.0038025036234, 121.452980245478 25.003808921145, 121.45354490094 25.0038177250769, 121.454250631782 25.0039305230049, 121.454941669604 25.0041250369978, 121.455414333338 25.0043582302644, 121.455894426645 25.0046782924689, 121.456171897998 25.0049850994341, 121.458326301152 25.0074631327716, 121.459370242361 25.0085868402622, 121.460446090083 25.0097952994268, 121.462022700083 25.0116364306806, 121.462643152599 25.0123448291991, 121.461815577428 25.0129390879963, 121.461989069091 25.0132182699815, 121.462449781774 25.0128487292897, 121.462873608832 25.0125915053053, 121.463311667907 25.0130073681378, 121.464296308783 25.013749712832, 121.465650092142 25.014805120444, 121.467077715276 25.0157901916386, 121.46808055839 25.0164198817657, 121.470019859007 25.0177990375486, 121.472656243266 25.0196343838196, 121.475970997867 25.0219735435619, 121.477170178585 25.0228851962097, 121.481603654252 25.0260320229879, 121.483247422797 25.0267367993212, 121.484550582354 25.0269946390774, 121.486938715594 25.0273822688788, 121.489312759547 25.0277152931041, 121.490189191565 25.0280024517175, 121.491036765241 25.0284998978436, 121.492891274351 25.0301042932349, 121.494811855198 25.0318788502387, 121.49573641235 25.0326603639368, 121.496580398143 25.0330448025175, 121.497397288683 25.0332197285754, 121.498504326216 25.0332193286546, 121.499434103591 25.0330217449806, 121.500150897517 25.0330249290607, 121.501017767634 25.0330960929304, 121.502387901022 25.0333743566681, 121.504542159521 25.0339189815161, 121.505144784034 25.0342058528712, 121.50565969453 25.034625894197, 121.506068664054 25.0351893936802, 121.506359810982 25.0357138569811, 121.50662897405 25.0368108282098, 121.506841399906 25.0374966333725, 121.506797528451 25.0376781016629, 121.50812463996 25.0422606745348, 121.508571151297 25.0421495923688, 121.508941214238 25.0421290905771, 121.509294668672 25.0421887989928, 121.510145718117 25.0422048381378, 121.512046149774 25.0423005576756, 121.514070284881 25.0423453707569, 121.513971508393 25.0409535045968, 121.513843882343 25.0399165429374, 121.515605720085 25.0396513200514, 121.516191005176 25.0416853602295, 121.516685556121 25.0433823878683, 121.513233670289 25.0434262593232, 121.513237658603 25.0423713502504, 121.51305120492 25.0410292825642, 121.510443844594 25.0413323944339, 121.509372641367 25.0417022081842, 121.508475611598 25.04208219748, 121.507974081103 25.0404888660071, 121.507611144522 25.0392006405609, 121.507164453346 25.0375913558318, 121.506917134074 25.0371364601442, 121.506531308487 25.0357377868655, 121.506226676226 25.0350137382457, 121.505948634146 25.034694987711, 121.505351764599 25.0341763619052, 121.504664959122 25.0337791188228, 121.503263882181 25.0334604595288, 121.501498056124 25.0330376982369, 121.500133915978 25.0328772938778, 121.499555078195 25.0329055921505, 121.499042773496 25.0329865770863, 121.498342539193 25.0331081715375, 121.497827387701 25.0331036411917, 121.497067180053 25.033038707028, 121.496433195326 25.0328530824982, 121.49581051422 25.032543339364, 121.494985636796 25.0318241139001, 121.493002947145 25.0300085736971, 121.491803461687 25.0289656295665, 121.491070595942 25.0283995174263, 121.490157285053 25.0278907789234, 121.489327598274 25.0276671912577, 121.48702247019 25.0273304207959, 121.485594653751 25.0270831453232, 121.48435338581 25.0268778469227, 121.483052755697 25.0265795228661, 121.481999925534 25.026090702516, 121.481293385163 25.0257071159309, 121.4782043817 25.0235058503566, 121.474230752759 25.0206317792462, 121.469211651148 25.017088095806, 121.467834901375 25.0160895392307, 121.466574070094 25.0152432454358, 121.46565831804 25.0145932412588, 121.465008222845 25.0141106552557, 121.464094898922 25.0133648405238, 121.463475713162 25.0128663012644, 121.46203507999 25.0113376270764, 121.457869191958 25.0067199377508, 121.4559856519 25.0046532715232, 121.455146223138 25.0040989787073, 121.454663533214 25.0038906004391, 121.453854664195 25.0036840883402, 121.453559268754 25.0036602753013, 121.45287577143 25.0036323571028, 121.45276516436 25.0035523600323, 121.4526265018 25.0034768128539, 121.452419109468 25.0034030290435, 121.45241113284 25.0028416738375, 121.452323389931 25.0017528640951, 121.452227670393 25.0012284007942, 121.451886669539 25.000334021363, 121.451501016196 24.999570242842, 121.450880617314 24.9987127716916, 121.450599939711 24.9984106569004, 121.450165712016 24.9979629686455, 121.446989690114 24.9954054218557, 121.446138792588 24.9947307579129, 121.445198266836 24.9938719554833, 121.444870722483 24.9934931130294, 121.444315353808 24.9928040843898, 121.443608425138 24.9917302308252, 121.443252021722 24.9913626382435, 121.44289337378 24.990919999053, 121.442370796774 24.9900920113957, 121.441898934018 24.9890102006262, 121.4416282272 24.9885944188839, 121.441074350083 24.9881367598438, 121.440599740708 24.9877090131593, 121.440404313318 24.9873729976985, 121.44029513322 24.9870459559443, 121.439497470405 24.9837436318904, 121.439099636076 24.9822250813064, 121.438756641066 24.9812100553744, 121.438575172776 24.9806596680321, 121.438358308198 24.9801052923757, 121.43772416626 24.9788539588347, 121.436610429554 24.9770083664966, 121.436130336248 24.9762934611987, 121.435281323889 24.9753542132341, 121.434807213053 24.9749025366651, 121.434181546283 24.9744249360547, 121.432876370502 24.9736073316694, 121.43266897817 24.9734378283212, 121.432539856502 24.9733411117049, 121.432436160336 24.9730908449967, 121.432362376525 24.9728266191892, 121.43240624798 24.972466673844, 121.432505955832 24.9721575795032, 121.432911166143 24.9715233378412, 121.43357781524 24.9706619617251, 121.433862979696 24.9702382033547, 121.433906851151 24.9697316874672, 121.433525222896 24.9689059624314, 121.433188041495 24.9681744716652, 121.432895039685 24.9675120556137, 121.432698890526 24.9668760545897, 121.43261513593 24.9658550461865, 121.432718832096 24.9643514517803, 121.432714843782 24.9641899250603, 121.432628071322 24.9633426094311, 121.432333959788 24.9608437295516, 121.432202345423 24.9599523413559, 121.43204281286 24.9593361468313, 121.431811490644 24.959001128449, 121.431523191239 24.9587427733544, 121.431146439272 24.9585424723304, 121.430755584493 24.9584826476193, 121.430376694655 24.9585305073882, 121.429930003479 24.9586810662445, 121.428924924264 24.9591496800776, 121.428457318507 24.9592852958268, 121.428116816193 24.9593231848106, 121.427576399636 24.9593052373972, 121.426676037733 24.9592334477439, 121.425638078995 24.9590579619246, 121.424359824334 24.9586730896164, 121.423769553851 24.9584617089704, 121.42303670114 24.9581605912578, 121.42219516687 24.9577099117673, 121.42163074861 24.9573363380327, 121.420838641546 24.9567736550383, 121.420010008464 24.9559861463017, 121.417578693329 24.9532081022554, 121.416726191195 24.9523984744982, 121.41614327238 24.9519597410335, 121.414896930687 24.951184586019, 121.414050593806 24.9508021318286, 121.412693008587 24.9503405044356, 121.411585752892 24.9501301208682, 121.410816506815 24.9500443721156, 121.410048618234 24.9500432048381, 121.40904320267 24.950012465603, 121.407499226583 24.9501081851408, 121.400842730393 24.9506665491113, 121.396344909195 24.9510972870313, 121.394350752157 24.9512687845366, 121.389911260053 24.9516706071796, 121.387114229534 24.9517600011493, 121.385762416337 24.951746385147, 121.383697466724 24.9516506656092, 121.381585654422 24.9514193433929, 121.37941302033 24.9510245002995, 121.376419512143 24.9502313390321, 121.373787795481 24.9492472248026, 121.372671273925 24.9487401934132, 121.371881587739 24.9483493386338, 121.370329635024 24.9475157809922, 121.3697146332 24.9471538225486, 121.366878746271 24.9451307691755, 121.364746992398 24.9432662323455, 121.363451787402 24.9419500887009, 121.362695004807 24.9411364726296, 121.362340044854 24.9405641495599, 121.361598218436 24.9395710593553, 121.36138683779 24.9392440176011, 121.36136689622 24.9389209641611, 121.361442674187 24.9387694082262, 121.36162214832 24.9386018990351, 121.362606819316 24.9386443665797, 121.3655127487 24.9389967421285, 121.366926107501 24.9390386194263, 121.367621189987 24.9390354464912, 121.368247236538 24.9389947479714, 121.36846808943 24.9404415089021, 121.368528985325 24.9407082909828, 121.368680140642 24.9409158626889, 121.368929428542 24.9411317624821, 121.369101732828 24.9412172359896, 121.369356984929 24.9412790548578, 121.370692422879 24.9412737096014, 121.371698230381 24.9412646444067, 121.372820835703 24.9412112535185, 121.37334131069 24.9411394638652, 121.373506825724 24.9412252126178, 121.373981685968 24.9413892308478, 121.374407229699 24.9417062596511, 121.375383826035 24.9427686901647, 121.373320516801 24.9454725627437, 121.374659114758 24.9461914016213, 121.377175077594 24.9472645172055, 121.379495138811 24.9480423747882, 121.380311584434 24.9482285519547, 121.381590200824 24.9485025994004, 121.383739178188 24.9487488680918, 121.385441335137 24.948826284334, 121.385109329907 24.9465635710069, 121.384700527714 24.9465496119076, 121.384156334834 24.9465242437031, 121.382234997428 24.9461649787474, 121.380620146832 24.9456828446288, 121.378545063479 24.9448007361858, 121.378664873022 24.9445704052952, 121.378948086372 24.9440703157297, 121.379154110083 24.9436438882098, 121.379242021364 24.9434197824374, 121.379254496928 24.9431196910922, 121.379194161595 24.9424147272906, 121.378997931973 24.9416039651972, 121.378835711867 24.9411095515096)","wkt0":"LINESTRING (121.378835711867 24.9411095515096, 121.378997931973 24.9416039651972, 121.379194161595 24.9424147272906, 121.379254496928 24.9431196910922, 121.379242021364 24.9434197824374, 121.379154110083 24.9436438882098, 121.378948086372 24.9440703157297, 121.378664873022 24.9445704052952, 121.378545063479 24.9448007361858, 121.380620146832 24.9456828446288, 121.382234997428 24.9461649787474, 121.384156334834 24.9465242437031, 121.384700527714 24.9465496119076, 121.385109329907 24.9465635710069, 121.385441335137 24.948826284334, 121.383739178188 24.9487488680918, 121.381590200824 24.9485025994004, 121.380311584434 24.9482285519547, 121.379495138811 24.9480423747882, 121.377175077594 24.9472645172055, 121.374659114758 24.9461914016213, 121.373320516801 24.9454725627437, 121.375383826035 24.9427686901647, 121.374407229699 24.9417062596511, 121.373981685968 24.9413892308478, 121.373506825724 24.9412252126178, 121.37334131069 24.9411394638652, 121.372820835703 24.9412112535185, 121.371698230381 24.9412646444067, 121.370692422879 24.9412737096014, 121.369356984929 24.9412790548578, 121.369101732828 24.9412172359896, 121.368929428542 24.9411317624821, 121.368680140642 24.9409158626889, 121.368528985325 24.9407082909828, 121.36846808943 24.9404415089021, 121.368247236538 24.9389947479714, 121.367621189987 24.9390354464912, 121.366926107501 24.9390386194263, 121.3655127487 24.9389967421285, 121.362606819316 24.9386443665797, 121.36162214832 24.9386018990351, 121.361442674187 24.9387694082262, 121.36136689622 24.9389209641611, 121.36138683779 24.9392440176011, 121.361598218436 24.9395710593553, 121.362340044854 24.9405641495599, 121.362695004807 24.9411364726296, 121.363451787402 24.9419500887009, 121.364746992398 24.9432662323455, 121.366878746271 24.9451307691755, 121.3697146332 24.9471538225486, 121.370329635024 24.9475157809922, 121.371881587739 24.9483493386338, 121.372671273925 24.9487401934132, 121.373787795481 24.9492472248026, 121.376419512143 24.9502313390321, 121.37941302033 24.9510245002995, 121.381585654422 24.9514193433929, 121.383697466724 24.9516506656092, 121.385762416337 24.951746385147, 121.387114229534 24.9517600011493, 121.389911260053 24.9516706071796, 121.394350752157 24.9512687845366, 121.396344909195 24.9510972870313, 121.400842730393 24.9506665491113, 121.407499226583 24.9501081851408, 121.40904320267 24.950012465603, 121.410048618234 24.9500432048381, 121.410816506815 24.9500443721156, 121.411585752892 24.9501301208682, 121.412693008587 24.9503405044356, 121.414050593806 24.9508021318286, 121.414896930687 24.951184586019, 121.41614327238 24.9519597410335, 121.416726191195 24.9523984744982, 121.417578693329 24.9532081022554, 121.420010008464 24.9559861463017, 121.420838641546 24.9567736550383, 121.42163074861 24.9573363380327, 121.42219516687 24.9577099117673, 121.42303670114 24.9581605912578, 121.423769553851 24.9584617089704, 121.424359824334 24.9586730896164, 121.425638078995 24.9590579619246, 121.426676037733 24.9592334477439, 121.427576399636 24.9593052373972, 121.428116816193 24.9593231848106, 121.428457318507 24.9592852958268, 121.428924924264 24.9591496800776, 121.429930003479 24.9586810662445, 121.430376694655 24.9585305073882, 121.430755584493 24.9584826476193, 121.431146439272 24.9585424723304, 121.431523191239 24.9587427733544, 121.431811490644 24.959001128449, 121.43204281286 24.9593361468313, 121.432202345423 24.9599523413559, 121.432333959788 24.9608437295516, 121.432628071322 24.9633426094311, 121.432714843782 24.9641899250603, 121.432718832096 24.9643514517803, 121.43261513593 24.9658550461865, 121.432698890526 24.9668760545897, 121.432895039685 24.9675120556137, 121.433188041495 24.9681744716652, 121.433525222896 24.9689059624314, 121.433906851151 24.9697316874672, 121.433862979696 24.9702382033547, 121.43357781524 24.9706619617251, 121.432911166143 24.9715233378412, 121.432505955832 24.9721575795032, 121.43240624798 24.972466673844, 121.432362376525 24.9728266191892, 121.432436160336 24.9730908449967, 121.432539856502 24.9733411117049, 121.43266897817 24.9734378283212, 121.432876370502 24.9736073316694, 121.434181546283 24.9744249360547, 121.434807213053 24.9749025366651, 121.435281323889 24.9753542132341, 121.436130336248 24.9762934611987, 121.436610429554 24.9770083664966, 121.43772416626 24.9788539588347, 121.438358308198 24.9801052923757, 121.438575172776 24.9806596680321, 121.438756641066 24.9812100553744, 121.439099636076 24.9822250813064, 121.439497470405 24.9837436318904, 121.44029513322 24.9870459559443, 121.440404313318 24.9873729976985, 121.440599740708 24.9877090131593, 121.441074350083 24.9881367598438, 121.4416282272 24.9885944188839, 121.441898934018 24.9890102006262, 121.442370796774 24.9900920113957, 121.44289337378 24.990919999053, 121.443252021722 24.9913626382435, 121.443608425138 24.9917302308252, 121.444315353808 24.9928040843898, 121.444870722483 24.9934931130294, 121.445198266836 24.9938719554833, 121.446138792588 24.9947307579129, 121.446989690114 24.9954054218557, 121.450165712016 24.9979629686455, 121.450599939711 24.9984106569004, 121.450880617314 24.9987127716916, 121.451501016196 24.999570242842, 121.451886669539 25.000334021363, 121.452227670393 25.0012284007942, 121.452323389931 25.0017528640951, 121.45241113284 25.0028416738375, 121.452419109468 25.0034030290435, 121.4526265018 25.0034768128539, 121.45276516436 25.0035523600323, 121.45287577143 25.0036323571028, 121.453559268754 25.0036602753013, 121.453854664195 25.0036840883402, 121.454663533214 25.0038906004391, 121.455146223138 25.0040989787073, 121.4559856519 25.0046532715232, 121.457869191958 25.0067199377508, 121.46203507999 25.0113376270764, 121.463475713162 25.0128663012644, 121.464094898922 25.0133648405238, 121.465008222845 25.0141106552557, 121.46565831804 25.0145932412588, 121.466574070094 25.0152432454358, 121.467834901375 25.0160895392307, 121.469211651148 25.017088095806, 121.474230752759 25.0206317792462, 121.4782043817 25.0235058503566, 121.481293385163 25.0257071159309, 121.481999925534 25.026090702516, 121.483052755697 25.0265795228661, 121.48435338581 25.0268778469227, 121.485594653751 25.0270831453232, 121.48702247019 25.0273304207959, 121.489327598274 25.0276671912577, 121.490157285053 25.0278907789234, 121.491070595942 25.0283995174263, 121.491803461687 25.0289656295665, 121.493002947145 25.0300085736971, 121.494985636796 25.0318241139001, 121.49581051422 25.032543339364, 121.496433195326 25.0328530824982, 121.497067180053 25.033038707028, 121.497827387701 25.0331036411917, 121.498342539193 25.0331081715375, 121.499042773496 25.0329865770863, 121.499555078195 25.0329055921505, 121.500133915978 25.0328772938778, 121.501498056124 25.0330376982369, 121.503263882181 25.0334604595288, 121.504664959122 25.0337791188228, 121.505351764599 25.0341763619052, 121.505948634146 25.034694987711, 121.506226676226 25.0350137382457, 121.506531308487 25.0357377868655, 121.506917134074 25.0371364601442, 121.507164453346 25.0375913558318, 121.507611144522 25.0392006405609, 121.507974081103 25.0404888660071, 121.508475611598 25.04208219748, 121.509372641367 25.0417022081842, 121.510443844594 25.0413323944339, 121.51305120492 25.0410292825642, 121.513237658603 25.0423713502504, 121.513233670289 25.0434262593232, 121.516668050324 25.0433871901191, 121.516168352742 25.0417059067505, 121.515567831224 25.0396637798182, 121.513843882343 25.0399165429374, 121.513971508393 25.0409535045968, 121.514070284881 25.0423453707569, 121.512046149774 25.0423005576756)","wkt1":"LINESTRING (121.512046149774 25.0423005576756, 121.510145718117 25.0422048381378, 121.509294668672 25.0421887989928, 121.508941214238 25.0421290905771, 121.508571151297 25.0421495923688, 121.50812463996 25.0422606745348, 121.506797528451 25.0376781016629, 121.506841399906 25.0374966333725, 121.50662897405 25.0368108282098, 121.506359810982 25.0357138569811, 121.506068664054 25.0351893936802, 121.50565969453 25.034625894197, 121.505144784034 25.0342058528712, 121.504542159521 25.0339189815161, 121.502387901022 25.0333743566681, 121.501017767634 25.0330960929304, 121.500150897517 25.0330249290607, 121.499434103591 25.0330217449806, 121.498504326216 25.0332193286546, 121.497397288683 25.0332197285754, 121.496580398143 25.0330448025175, 121.49573641235 25.0326603639368, 121.494811855198 25.0318788502387, 121.492891274351 25.0301042932349, 121.491036765241 25.0284998978436, 121.490189191565 25.0280024517175, 121.489312759547 25.0277152931041, 121.486938715594 25.0273822688788, 121.484550582354 25.0269946390774, 121.483247422797 25.0267367993212, 121.481603654252 25.0260320229879, 121.477170178585 25.0228851962097, 121.475970997867 25.0219735435619, 121.472656243266 25.0196343838196, 121.470019859007 25.0177990375486, 121.46808055839 25.0164198817657, 121.467077715276 25.0157901916386, 121.465650092142 25.014805120444, 121.464296308783 25.013749712832, 121.463311667907 25.0130073681378, 121.462873608832 25.0125915053053, 121.462449781774 25.0128487292897, 121.461989069091 25.0132182699815, 121.461815577428 25.0129390879963, 121.462643152599 25.0123448291991, 121.462022700083 25.0116364306806, 121.460446090083 25.0097952994268, 121.459370242361 25.0085868402622, 121.458326301152 25.0074631327716, 121.456171897998 25.0049850994341, 121.455894426645 25.0046782924689, 121.455414333338 25.0043582302644, 121.454941669604 25.0041250369978, 121.454250631782 25.0039305230049, 121.45354490094 25.0038177250769, 121.452980245478 25.003808921145, 121.452864709169 25.0038025036234, 121.452719632449 25.0039125787, 121.452577283252 25.0039958904996, 121.452369255542 25.0040212177251, 121.452287495104 25.0039035624599, 121.452313419145 25.0033880728657, 121.452301454203 25.0026771558819, 121.452139927483 25.0014607200891, 121.451820405507 25.0005935461501, 121.451348745678 24.9996181189866, 121.450824780917 24.9988324211138, 121.450474307818 24.9984286043138, 121.450032103495 24.99798689853, 121.4483442283 24.9966138688771, 121.446229762285 24.9948878966364, 121.445384522354 24.9941479064359, 121.445076963054 24.9938670565333, 121.444247552468 24.9928320025883, 121.44383002467 24.9922037863364, 121.443528658856 24.9917800847511, 121.442528981363 24.9905837571475, 121.441829138521 24.9890261538825, 121.441530513505 24.9886283195535, 121.440779214841 24.9880240899712, 121.440502027013 24.9877269605726, 121.440298622995 24.9873829684837, 121.440212874242 24.9871287134614, 121.439912255069 24.9859043010404, 121.439501458719 24.9842252208149, 121.439380812219 24.9836907867289, 121.439003916539 24.9822579848976, 121.438664909842 24.9812479443581, 121.438025782512 24.9797842330927, 121.437453957981 24.9787173590777, 121.43645837508 24.9770831473855, 121.435486722064 24.9758417846298, 121.435076424253 24.975375151883, 121.434605803193 24.9749763204755, 121.433683007024 24.9743551405584, 121.432814551634 24.9737249869346, 121.432637570197 24.973562463136, 121.432482025948 24.9733401146264, 121.432388300567 24.9731426930797, 121.432294575186 24.9726491392129, 121.432346423269 24.9723749426203, 121.432426189551 24.9721157022054, 121.432801091074 24.9715742885697, 121.433761277687 24.9702870602021, 121.433795178357 24.9701065889902, 121.433791190043 24.9697825384717, 121.433665558149 24.9694953798583, 121.432808569163 24.9676647436979, 121.432670972327 24.9672718947616, 121.43258123526 24.9669378734578, 121.43252739302 24.9658729935999, 121.432603170988 24.9643275218959, 121.432474683801 24.9631644381514, 121.432392609207 24.9625146141843, 121.43235248385 24.9621442295231, 121.432230951969 24.9617267434658, 121.432042424273 24.9613538513851, 121.431697182103 24.9609496160728, 121.431495260314 24.9607420489232, 121.431075767945 24.9604642565313, 121.430802185965 24.9603055177402, 121.430492126388 24.9602129200175, 121.429736834942 24.9599996355674, 121.427929666557 24.9596353482425, 121.426709938403 24.9594448283898, 121.425100653674 24.9591257632639, 121.424338885686 24.9588804819483, 121.423363742894 24.9585075745823, 121.42262590479 24.9581605912578, 121.422091470704 24.957905339157, 121.420872043676 24.9570179392753, 121.420204998147 24.9564486074412, 121.419175800629 24.9553819082438, 121.418223357076 24.9541967573046, 121.417596512747 24.9534909265215, 121.416440333999 24.9524003363896, 121.415943433048 24.9520193012462, 121.414993812923 24.9514107738819, 121.413960638069 24.9509511712037, 121.412983509979 24.9505921866217, 121.41190645784 24.9503435492316, 121.410844425014 24.9502158696208, 121.410178461572 24.9501969032103, 121.408818903458 24.9501903770236, 121.407727317029 24.9502513948471, 121.403959099303 24.9505907711438, 121.402731197107 24.9507423270787, 121.400894578476 24.9509038537987, 121.397323043222 24.9512528312803, 121.393393491415 24.9515318927337, 121.391654153656 24.9516842096175, 121.389201815793 24.9518312293137, 121.388020030444 24.9518971524168, 121.386605944763 24.9519418125367, 121.385989020245 24.9519247852248, 121.384793368492 24.9518917154487, 121.383226845664 24.95179823323, 121.381214741213 24.951531016187, 121.380280958304 24.9513678985874, 121.378720050759 24.9510404535558, 121.376947245153 24.9505578675527, 121.375738785988 24.9501650186164, 121.373976948246 24.94950295848, 121.372926638535 24.9490384481095, 121.37196135402 24.9485886374783, 121.37030570514 24.9477072200678, 121.368884147824 24.9467630079405, 121.367020959419 24.9454725990952, 121.365591517903 24.9442792641205, 121.364316254478 24.9431725069648, 121.363571821289 24.9423654069915, 121.361950187153 24.9407615711066, 121.360716568834 24.9395452931871, 121.359568284512 24.9385951351936, 121.359163352693 24.9383047696365, 121.358880182394 24.9381452370735, 121.358656836806 24.9380415409076, 121.358529210755 24.938009634395, 121.358381643135 24.9379936811387, 121.358166274175 24.9380255876513, 121.357973771888 24.9381306259695, 121.357835244106 24.9383087579506, 121.357811314222 24.9385201385966, 121.357875127247 24.9387474724988, 121.357958881843 24.9388471803507, 121.358130379348 24.9389787947152, 121.358317830109 24.9390386194263, 121.358511263342 24.9390406135833, 121.358967925304 24.9389269466322, 121.359255083917 24.9388511686648, 121.359733183067 24.9387394958707, 121.360386768036 24.9385919282499, 121.36094961886 24.9385001970262, 121.361549860128 24.9384682905136, 121.362809668836 24.938546062638, 121.363801287373 24.9386811480439, 121.36577943811 24.9389010560014, 121.36698604699 24.9389436054283, 121.368285556889 24.9388725963801, 121.368406868629 24.9397000789761, 121.368512460849 24.9402545158854, 121.368564686146 24.940607505909, 121.368619891192 24.9407860811096, 121.368835650915 24.9410114350736, 121.369011901697 24.9411136136311, 121.369265253705 24.9412052710474, 121.369437748289 24.9412112535185, 121.370120375818 24.9412153108025, 121.371030225948 24.941206479243, 121.372720130773 24.9411653879066, 121.373289462607 24.9410955924103, 121.373512808195 24.9411374697081, 121.373754776569 24.9411894291826, 121.373983604334 24.9412925945838, 121.374332126057 24.941519282386, 121.374992573407 24.9421660300803, 121.375501621599 24.9426866930333, 121.375024312108 24.9433211670458, 121.374212721706 24.9443452810072, 121.373449337942 24.9454189462263, 121.374537575964 24.9459831794908, 121.375177929321 24.9463033335135, 121.377255840954 24.9471807626099, 121.379504253014 24.9478876912797, 121.380315704741 24.9481005131155, 121.381789721016 24.9484196702265, 121.383152064775 24.9485816579287, 121.384188029355 24.9486454709539, 121.385258023696 24.9487011076028, 121.384979144031 24.9466717776022, 121.384056115469 24.9465999855224, 121.382503623576 24.9463247663884, 121.382196125223 24.9462691678565, 121.380242754693 24.9456409441125, 121.378330241639 24.9448147367171, 121.37796526232 24.9445873613828, 121.376678033953 24.9438096401382, 121.375382828957 24.9427906258921, 121.375781660364 24.942198361252, 121.376184480086 24.9415821667275, 121.376586302729 24.9411015748815, 121.377240386237 24.9402680172398, 121.377527544851 24.9401044963628, 121.378050013994 24.9398612092042, 121.378428903831 24.9397934078649, 121.378623334143 24.9406289596636, 121.378834714789 24.9411554171215)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0463000300'=='0100020200' || '0463000300'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
