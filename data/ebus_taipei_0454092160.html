
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231493073</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454092160">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454092160">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454092160" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0454092160" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454092160" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454092160',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="HpZMuXR-dnlBMZ8Q6dJ-JyknTha5h24ZAX9x7ddoRv0LoSjxjs6mEDKKpUVXeQo68Zgkk_5NwPEKDfXOf4xuUHsDHRg1" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/new_taipei_city.svg" width="100%" class="vipstop-city" alt="新北市">                
 <span class="stationlist-title">F921假日 </span>                 

                        <a href="../EBus/VsSimpleMap?routeid=0454092160" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0454092160" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">新北市政府交通局公車申訴服務電話02-89682460</a></div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">萬里區公所 - 金山醫院</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 停駛 <br>
                        [假日] 0650 - 1610
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> 請參見F921正線<br>
[假日]<br /> F921假日去班表:0830 1010 1200 1420<br/>F921假日去-繞圳頭至獅頭山班表:0650<br/>F921假日去-繞圳頭至金山班表:1610<br/>F921假日返班表:0920 1100 1250 1510<br/>F921假日返-獅頭山繞圳頭班表:0740<br/>F921假日返-金山繞圳頭班表:1710<br/>繞駛圳頭06:50(至中山堂) 16:10   往金山區公所方向：   中山堂發車繞圳頭07:40；繞圳頭17:10<br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">基隆客運金山站:02-2498-2155</span>
                </li>

            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 金山醫院</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 萬里區公所</a>
                </p>


            <p> 
<a style="color:#4CAF50; word-spacing:20px;margin-top:5px;box-shadow: 0 1px;padding-bottom:3px;" href="./StopsOfRoute?routeid=0454092162" >①去</a> <a style="color:#4CAF50; word-spacing:20px;margin-top:5px;box-shadow: 0 1px;padding-bottom:3px;" href="./StopsOfRoute?routeid=0454092161" >②去程繞圳頭至獅頭山</a> <a style="color:#4CAF50; word-spacing:20px;margin-top:5px;box-shadow: 0 1px;padding-bottom:3px;" href="./StopsOfRoute?routeid=0454092163" >③去程繞圳頭至金山</a> <a style="color:#4CAF50; word-spacing:20px;margin-top:5px;box-shadow: 0 1px;padding-bottom:3px;" href="./StopsOfRoute?routeid=0454092164" >④返</a> <a style="color:#4CAF50; word-spacing:20px;margin-top:5px;box-shadow: 0 1px;padding-bottom:3px;" href="./StopsOfRoute?routeid=0454092165" >⑤返程獅頭山繞圳頭</a> <a style="color:#4CAF50; word-spacing:20px;margin-top:5px;box-shadow: 0 1px;padding-bottom:3px;" href="./StopsOfRoute?routeid=0454092166" >⑥返程金山繞圳頭</a> </p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">萬里區公所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074500440" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="25.178364" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.6899935" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">萬里北基路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074500260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.175345" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.686895" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">大坪國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074200460" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.167637" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6382365" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">圳頭</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074201220" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.171419" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6249247" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">大坪國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074200420" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.167453" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6382419" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">大鵬派出所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074100160" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.212757" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.646249" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">加投里</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074100300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.215035" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6440606" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">自強路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084500360" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.216809" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6423612" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">獅頭山公園(老街溫泉區)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084600100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.219393" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6419691" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">金山遊客中心(獅頭山公園)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084401000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.223614" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.644814" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">獅頭山公園(老街溫泉區)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084600140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.219393" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6416901" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">金山</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084102470" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.220074" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.639219" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">金山區公所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084501070" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.22217" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.637107" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">中正路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084400260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.221938" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.634037" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 15</span>
                                    <span class="auto-list-stationlist-place">金山醫院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084400860" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.221073" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.629897" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">金山醫院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084400820" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.221006" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.630204" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">中正路</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084400200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.221782" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.634023" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">金山區公所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084501030" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.222151" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.636933" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">金山</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084500440" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.22017" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.63897" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">獅頭山公園(老街溫泉區)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084600100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.219393" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6419691" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">金山遊客中心(獅頭山公園)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084401040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.22342" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.644722" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">獅頭山公園(老街溫泉區)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084600140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.219393" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6416901" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">自強路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2084100420" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.216311" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.642529" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">加投里</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074100340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.214991" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6438112" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">大鵬派出所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074100120" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.212729" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.645959" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">大坪國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074200460" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.167637" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6382365" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">圳頭</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074201260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.17155" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6249408" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">大坪國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074200420" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.167453" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6382419" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">萬里北基路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074500200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.175102" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.686858" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 15</span>
                                    <span class="auto-list-stationlist-place">萬里區公所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2074500400" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.178152" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.6899586" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0454092160";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 15;
        var existBackNum = 15;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0454092160',
                        url: './StopStatusRecent3OfRoute?routeid=0454092160&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0454092160',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0454092160',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0454092160');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0454092160","Name":"F921假日","BeginStop":"萬里區公所","GoDirStops":[{"UniStopId":"2074500440","Name":"萬里區公所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6899935,"Latitude":25.178364,"PublicId":"2074500440"},{"UniStopId":"2074500260","Name":"萬里北基路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.686895,"Latitude":25.175345,"PublicId":"2074500260"},{"UniStopId":"2074200460","Name":"大坪國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6382365,"Latitude":25.167637,"PublicId":"2074200460"},{"UniStopId":"2074201220","Name":"圳頭","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6249247,"Latitude":25.171419,"PublicId":"2074201220"},{"UniStopId":"2074200420","Name":"大坪國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6382419,"Latitude":25.167453,"PublicId":"2074200420"},{"UniStopId":"2074100160","Name":"大鵬派出所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.646249,"Latitude":25.212757,"PublicId":"2074100160"},{"UniStopId":"2074100300","Name":"加投里","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6440606,"Latitude":25.215035,"PublicId":"2074100300"},{"UniStopId":"2084500360","Name":"自強路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6423612,"Latitude":25.216809,"PublicId":"2084500360"},{"UniStopId":"2084600100","Name":"獅頭山公園(老街溫泉區)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6419691,"Latitude":25.219393,"PublicId":"2084600100"},{"UniStopId":"2084401000","Name":"金山遊客中心(獅頭山公園)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.644814,"Latitude":25.223614,"PublicId":"2084401000"},{"UniStopId":"2084600140","Name":"獅頭山公園(老街溫泉區)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6416901,"Latitude":25.219393,"PublicId":"2084600140"},{"UniStopId":"2084102470","Name":"金山","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.639219,"Latitude":25.220074,"PublicId":"2084102470"},{"UniStopId":"2084501070","Name":"金山區公所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.637107,"Latitude":25.22217,"PublicId":"2084501070"},{"UniStopId":"2084400260","Name":"中正路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.634037,"Latitude":25.221938,"PublicId":"2084400260"},{"UniStopId":"2084400860","Name":"金山醫院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.629897,"Latitude":25.221073,"PublicId":"2084400860"}],"LastStop":"金山醫院","BackDirStops":[{"UniStopId":"2084400820","Name":"金山醫院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.630204,"Latitude":25.221006,"PublicId":"2084400820"},{"UniStopId":"2084400200","Name":"中正路","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.634023,"Latitude":25.221782,"PublicId":"2084400200"},{"UniStopId":"2084501030","Name":"金山區公所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.636933,"Latitude":25.222151,"PublicId":"2084501030"},{"UniStopId":"2084500440","Name":"金山","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.63897,"Latitude":25.22017,"PublicId":"2084500440"},{"UniStopId":"2084600100","Name":"獅頭山公園(老街溫泉區)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6419691,"Latitude":25.219393,"PublicId":"2084600100"},{"UniStopId":"2084401040","Name":"金山遊客中心(獅頭山公園)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.644722,"Latitude":25.22342,"PublicId":"2084401040"},{"UniStopId":"2084600140","Name":"獅頭山公園(老街溫泉區)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6416901,"Latitude":25.219393,"PublicId":"2084600140"},{"UniStopId":"2084100420","Name":"自強路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.642529,"Latitude":25.216311,"PublicId":"2084100420"},{"UniStopId":"2074100340","Name":"加投里","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6438112,"Latitude":25.214991,"PublicId":"2074100340"},{"UniStopId":"2074100120","Name":"大鵬派出所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.645959,"Latitude":25.212729,"PublicId":"2074100120"},{"UniStopId":"2074200460","Name":"大坪國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6382365,"Latitude":25.167637,"PublicId":"2074200460"},{"UniStopId":"2074201260","Name":"圳頭","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6249408,"Latitude":25.17155,"PublicId":"2074201260"},{"UniStopId":"2074200420","Name":"大坪國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6382419,"Latitude":25.167453,"PublicId":"2074200420"},{"UniStopId":"2074500200","Name":"萬里北基路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.686858,"Latitude":25.175102,"PublicId":"2074500200"},{"UniStopId":"2074500400","Name":"萬里區公所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.6899586,"Latitude":25.178152,"PublicId":"2074500400"}],"RouteMapUrl":"../MapOverview?nid=0454092160","RouteTracks":null,"StopDirection":null,"TicketPrice":"","BusTimeDesc":"停駛","HeadwayDesc":"請參見F921正線","HolidayBusTimeDesc":"0650 - 1610","HolidayHeadwayDesc":"F921假日去班表:0830 1010 1200 1420;F921假日去-繞圳頭至獅頭山班表:0650;F921假日去-繞圳頭至金山班表:1610;F921假日返班表:0920 1100 1250 1510;F921假日返-獅頭山繞圳頭班表:0740;F921假日返-金山繞圳頭班表:1710;繞駛圳頭06:50(至中山堂) 16:10   往金山區公所方向：   中山堂發車繞圳頭07:40；繞圳頭17:10","RouteNote":"","SegmentBuffer":"","StopLng":0,"StopLat":0,"IsNtpcMainLine":false,"orgphone":"基隆客運金山站:02-2498-2155","aliasName":null,"aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":"LINESTRING (121.629825975788 25.2210150631747, 121.631849052942 25.2214331289905, 121.63672000389 25.2224019995541, 121.637647262369 25.2216305540985, 121.638942698743 25.2203902236102, 121.640032084115 25.2191363361041, 121.641410361329 25.2175712360944, 121.641715605704 25.2178707956928, 121.641724332823 25.2183778022081, 121.641845751783 25.2192640559563, 121.641964343391 25.2202755293845, 121.641910551045 25.2203412853398, 121.642056957241 25.2208716384642, 121.643189397872 25.2216335878095, 121.643685890632 25.2219575113672, 121.64392813039 25.2220989456432, 121.64462779097 25.2224272745785, 121.644706819544 25.2225143107393, 121.644734307743 25.2226075636997, 121.644730871718 25.2227287924413, 121.644696511469 25.2228065031096, 121.64475320588 25.2228970359755, 121.64479443818 25.2232502300741, 121.644708537556 25.2234336263853, 121.644754923893 25.2236282903876, 121.644830516442 25.2237370845047, 121.644789284142 25.2237495181119, 121.644710255569 25.2236267361853, 121.644660433207 25.22344489437, 121.644748051843 25.2232424590379, 121.644710255569 25.2228908191285, 121.644662151219 25.2228422500003, 121.644632945007 25.2227536598605, 121.64464840712 25.2226572985827, 121.644631226995 25.2225485034998, 121.644572814571 25.2224832264033, 121.643936720453 25.222173548272, 121.643684172619 25.222052318977, 121.643069916083 25.2216662352154, 121.642039088543 25.2209881797911, 121.641964900575 25.2198277418975, 121.641778745065 25.2183956782158, 121.641753981497 25.2178469377903, 121.641701666603 25.2174083445054, 121.642315504469 25.216811916624, 121.643463812382 25.2156104350107, 121.644432958168 25.2145788792514, 121.645140254163 25.2138887843121, 121.646202224783 25.2127747679413, 121.646785763936 25.2121373664026, 121.645933485829 25.2115895967896, 121.646890857084 25.2095399572784, 121.647056545655 25.2090821481704, 121.647442107855 25.2074156377867, 121.648122712037 25.205925474947, 121.648135250893 25.2043685800422, 121.646960077448 25.2027891761557, 121.646491655168 25.2020333458493, 121.646511897419 25.2012177732021, 121.64696415448 25.1988145477399, 121.646648956442 25.1971421513601, 121.645988226918 25.1959403089995, 121.644854189108 25.1953851673395, 121.645251418131 25.1939844900073, 121.645954867095 25.1921068010629, 121.646954032757 25.1902457152178, 121.647618728546 25.1890076263097, 121.648980161416 25.188168786276, 121.6502297331 25.1870923160401, 121.651503233876 25.1850051844316, 121.652769101568 25.1834897381513, 121.653188432944 25.1817047085472, 121.653779005297 25.17977143585, 121.654868956753 25.17779140545, 121.654907749722 25.1769962164311, 121.655173199226 25.175782902224, 121.654072088586 25.1752465286233, 121.652941226606 25.1754578497022, 121.651190631261 25.1769113964607, 121.650820586847 25.1756788250304, 121.651202074683 25.1743226446939, 121.650877379159 25.1726648211343, 121.650513215037 25.1718056017298, 121.65116608344 25.170506509355, 121.649810730887 25.169353315168, 121.648201736524 25.1689121077484, 121.647391368715 25.1684640896379, 121.644761068849 25.1675695839328, 121.641719446262 25.1669620406868, 121.639651353325 25.1660064144455, 121.638637480909 25.1667357408225, 121.63795798735 25.1679603271415, 121.63630492295 25.1678847970555, 121.634828694088 25.1683960608938, 121.631698875424 25.1681817715394, 121.627869915243 25.1703666027066, 121.627729945985 25.1705222858631, 121.627660087904 25.1707591803923, 121.627627929466 25.1709198283666, 121.627407053811 25.1711274504639, 121.626947842608 25.1713607685359, 121.626520572284 25.1715186485849, 121.626265322235 25.1715291530807, 121.626016420268 25.1714784395129, 121.625635684538 25.1714526705119, 121.625262315096 25.1714946286243, 121.62495205392 25.1715731924752, 121.624592855486 25.1717246555581, 121.623792058567 25.1723091396806, 121.623470112263 25.1724591813358, 121.623164325618 25.1724947412661, 121.622799362149 25.1725866260937, 121.622704647641 25.172679510331, 121.623042255456 25.1725452924321, 121.623610088479 25.1724381223259, 121.624128129475 25.1720695952485, 121.624464130876 25.171791024403, 121.624714802321 25.1716260609626, 121.625305545223 25.1714788858419, 121.625596004215 25.1714529260707, 121.625897716189 25.1714803457829, 121.626138180429 25.1715147951721, 121.626447554027 25.1715246519087, 121.626724188016 25.1714490518263, 121.627130431133 25.1712807549068, 121.627446894402 25.1711369783404, 121.6276160607 25.1709149157866, 121.627806473529 25.1704230354858, 121.628098553964 25.170149227034, 121.631809862307 25.1682962905469, 121.63442851273 25.1688714348349, 121.636417258526 25.1680452010141, 121.638000548365 25.1680277808586, 121.638775950462 25.1667339518373, 121.639755188504 25.1660548473134, 121.641796327576 25.1665174742968, 121.644506724697 25.1677297421064, 121.646705905406 25.1686120044391, 121.648585130834 25.1691809181687, 121.650264507535 25.1692657765712, 121.650917376093 25.1705683303221, 121.650939724024 25.1718101279115, 121.651161390372 25.1734670472509, 121.651333953776 25.1742372739009, 121.650569406104 25.1755780800711, 121.651055051753 25.1766065171642, 121.651107415287 25.1773597740269, 121.653110304617 25.1750362322293, 121.654220874512 25.1756911658711, 121.655042595472 25.1755992987801, 121.655841065798 25.1744127976838, 121.656542488213 25.172954230997, 121.657675000533 25.1716993010561, 121.659391264029 25.1708891488679, 121.659665862402 25.1698452853533, 121.659523092756 25.1689043598183, 121.659513649523 25.1684512041062, 121.660120640867 25.1672060243763, 121.660486005027 25.1670058514349, 121.661660173977 25.1670236768644, 121.662779545388 25.1666730294827, 121.663980704303 25.1661238911539, 121.664541905654 25.1656791327885, 121.663366504239 25.1659627515063, 121.664266369196 25.1647864189356, 121.665199718954 25.1647826816051, 121.666450010795 25.1642385036996, 121.667450763305 25.1648095804614, 121.6693467209 25.1655570718669, 121.670512029382 25.1653039957801, 121.673063625848 25.1653002687252, 121.6738568338 25.1656852234415, 121.674962990933 25.1664981422421, 121.676088404398 25.1672076403255, 121.677814129094 25.1710916245742, 121.679901133065 25.1721425606075, 121.680895524876 25.1724030801727, 121.681887558814 25.1725566542766, 121.682508862156 25.1734865505322, 121.683225460726 25.1742277996591, 121.687497263363 25.1755679360346, 121.688362131874 25.1767078341439, 121.690134181983 25.1784461425505)","wkt0":"LINESTRING (121.690134427099 25.1784172076227, 121.689656064655 25.1778841071871, 121.689120584306 25.1773468419044, 121.688644601775 25.1768619347001, 121.688362131874 25.1767078341439, 121.688234066841 25.1764865034782, 121.687652178196 25.1757662824097, 121.68722617383 25.1753640771704, 121.686628815752 25.1750963369963, 121.685921981693 25.1748526934378, 121.685213957677 25.1746724150539, 121.684752254621 25.1745855482418, 121.684037090867 25.1743538042467, 121.683098215323 25.1740006847059, 121.682712669472 25.1738665171297, 121.682640082136 25.1738272485709, 121.682548455499 25.1737406792479, 121.68227238563 25.1732117436594, 121.682004645456 25.1727669974813, 121.681792833229 25.1726456219357, 121.681333510086 25.1726482993374, 121.680989612707 25.1726280700798, 121.68061596642 25.1725471530494, 121.680405344149 25.1724284549056, 121.679603313583 25.1718944620027, 121.679483127994 25.1718495411513, 121.678865540659 25.171664205453, 121.678165846337 25.1714262141871, 121.677937374722 25.1712908566546, 121.677794579962 25.1711257502139, 121.677423313588 25.1704730591672, 121.676804536296 25.1692060531654, 121.676434459878 25.1684489434507, 121.67631070442 25.1681951852635, 121.675876370359 25.1674282584091, 121.675683597434 25.1672158512043, 121.674512680406 25.1662811405075, 121.67408667604 25.1657724341766, 121.673877243726 25.1656016754434, 121.67356785508 25.1653541645268, 121.673375082155 25.1652357638721, 121.673053793946 25.165159606667, 121.672799143291 25.1651405673657, 121.67259209089 25.165152466929, 121.672399317965 25.1651715062303, 121.671666304866 25.1653452398544, 121.670854754649 25.1654969592864, 121.670088422773 25.1656159549193, 121.669878990459 25.1656326143079, 121.6693467209 25.1655570718669, 121.668382025396 25.1653018064483, 121.667944121467 25.1651256929116, 121.667725169503 25.1651024887632, 121.666939798325 25.1647859603795, 121.666613750291 25.1645884276288, 121.666411457715 25.1643313970617, 121.666278182606 25.1642980782844, 121.666113968632 25.1642956983718, 121.665257200075 25.1647145629998, 121.664838335447 25.1647455018643, 121.664445649859 25.1648264188947, 121.663819732829 25.1654684003345, 121.663596021039 25.1656106001159, 121.663253313616 25.1656343992424, 121.662955824534 25.1657081765349, 121.662908226281 25.1658366918184, 121.662965344185 25.1659199887615, 121.66315811711 25.1659295084121, 121.664367112741 25.1655392027361, 121.664600344181 25.1655082638715, 121.664776457718 25.1655939407272, 121.664750278679 25.165755774788, 121.664621763395 25.1659104691109, 121.664317134575 25.165986626316, 121.663788793965 25.1660556437831, 121.66348892497 25.1662240226037, 121.662851108377 25.166694650332, 121.662239470824 25.1670944756587, 121.66177062803 25.1670706765321, 121.661280366022 25.1668279254409, 121.660690147683 25.1667327289345, 121.660361719736 25.1667493883232, 121.660237964278 25.1668445848295, 121.659966654234 25.1674294483654, 121.659562069082 25.1680303763118, 121.659593007947 25.1688960695415, 121.659735802707 25.1695428108066, 121.659616807074 25.1700509221593, 121.65960490751 25.1705054854771, 121.659409754672 25.170638760586, 121.659197942446 25.1706714843851, 121.659021828909 25.1710302562184, 121.658538706639 25.171277767135, 121.658198379129 25.1713604690999, 121.65787709092 25.1714913642961, 121.657467745943 25.1717240007585, 121.657158357297 25.1719953108016, 121.656896566904 25.1723969210628, 121.656746632407 25.1730008239, 121.656358706644 25.1735327343793, 121.655799427169 25.1744079472596, 121.655723269964 25.1747976579575, 121.655511457737 25.1752712605767, 121.655233007956 25.1753634821922, 121.654892680446 25.1756514516239, 121.65450237477 25.1757918664708, 121.654328641145 25.1757585476936, 121.654169186997 25.1756942900518, 121.653745562544 25.1752754254238, 121.65323150141 25.1750255345946, 121.65304348831 25.1750350542453, 121.65298161058 25.1751040717124, 121.652907833288 25.1753182638517, 121.652660322372 25.1755467354669, 121.652517527612 25.1758198304446, 121.65222955818 25.1761839570814, 121.651667898793 25.1766902834996, 121.651463226304 25.1770085968177, 121.651408488313 25.1770371557696, 121.65128949268 25.1770609548962, 121.650727833292 25.1764478298974, 121.650644536349 25.1762413724743, 121.650594558184 25.1755666672355, 121.650639776524 25.1754357720392, 121.651141938095 25.1748509085033, 121.651275213204 25.1746277916915, 121.651384689186 25.1740637523913, 121.651332331108 25.1739025133087, 121.65095868482 25.1729612578521, 121.650937265606 25.1727994237913, 121.650901566917 25.1719747840549, 121.650799230672 25.1715350951912, 121.6510300822 25.1711715635326, 121.651027702287 25.1710168692097, 121.650951545082 25.1707747130967, 121.65035894683 25.1696466344963, 121.650087636787 25.1694479117893, 121.649097593121 25.1690647458512, 121.647940955569 25.1686107775115, 121.647719623692 25.1685607993457, 121.647424514522 25.1685703189963, 121.647015169545 25.1686464762014, 121.646872374785 25.1686512360267, 121.64676051889 25.168616132315, 121.646681981772 25.1684733375555, 121.646372593127 25.168254980569, 121.645956108411 25.1681472895212, 121.645292112779 25.167843255679, 121.644797090946 25.1678004172512, 121.644461523261 25.1676796366837, 121.64421877217 25.1675606410508, 121.643857025446 25.1673012305709, 121.643640453394 25.1672500624488, 121.642878881343 25.1671405864665, 121.642341021082 25.1669287742398, 121.641700824577 25.1667437360306, 121.641129645539 25.1664373222757, 121.640087243794 25.165983353936, 121.639792134625 25.1658881574297, 121.639428007988 25.1658429390892, 121.639173357333 25.166066055901, 121.638664056024 25.1666390198736, 121.63845462371 25.1672072240209, 121.638395125894 25.1674588997846, 121.638335628077 25.167554096291, 121.637678772184 25.1679943801329, 121.637497898821 25.1680729172506, 121.636902920657 25.1681086159405, 121.636210366073 25.1682960340624, 121.635958095331 25.168298413975, 121.635734383541 25.1683834958526, 121.635494012363 25.1684905919223, 121.635344077865 25.1685405700881, 121.634865715421 25.1686476661577, 121.633544863895 25.1686191072058, 121.632276370448 25.1684429936691, 121.631550497087 25.1686905045856, 121.631086414118 25.1688190198692, 121.63057354294 25.1691117491262, 121.629865518924 25.1691950460693, 121.629544230715 25.1693307010909, 121.628217429408 25.1700821585129, 121.628081774386 25.1701624805652, 121.627924700151 25.1702945657177, 121.627736687051 25.1705322594945, 121.627648630282 25.1709079882056, 121.627462997095 25.1711278326374, 121.626589569149 25.1715297403877, 121.626287320242 25.171538070082, 121.625737560417 25.1714619128769, 121.625337735091 25.1714809521782, 121.62477369579 25.171628209274, 121.624772505834 25.1715913206278, 121.625331785309 25.1714488233573, 121.625733990548 25.1714321639687, 121.626289700154 25.1715107010864, 121.626582429411 25.1714904718288, 121.627440387925 25.1710909439912, 121.627603411942 25.1709008484676, 121.627695038579 25.1705274996692, 121.627889001461 25.1702671967221, 121.62805797526 25.1701327316569, 121.628236468709 25.1700274205217, 121.629529951239 25.1692973823136, 121.629859569143 25.1691629172484, 121.630566403202 25.1690558211788, 121.631076894468 25.168778561354, 121.631533837698 25.1686476661577, 121.632224012369 25.1684120548045, 121.633528204506 25.1685857884286, 121.634870475246 25.1686048277299, 121.635453553847 25.1684620329703, 121.635727243803 25.168326972927, 121.635960475244 25.1682627152852, 121.636210366073 25.1682603353725, 121.636886261268 25.1680752971633, 121.637505038559 25.1680276989101, 121.637640693581 25.1679848604822, 121.638318968689 25.1675207775137, 121.638359427204 25.1674184412694, 121.638414165195 25.1672000842829, 121.638625977422 25.1666390198736, 121.639144798381 25.1660493965123, 121.639423248163 25.1658120002246, 121.639815933751 25.1658714980411, 121.64010152327 25.1659571748968, 121.641136785277 25.1664040034985, 121.641724623704 25.166712797166, 121.642364820209 25.1668930755499, 121.642881261256 25.1671144074272, 121.643635693569 25.1672096039336, 121.643871304922 25.1672655318811, 121.644242571297 25.1675439816622, 121.644473422825 25.1676391781685, 121.644801850772 25.1677694783866, 121.645320671731 25.1678218364651, 121.645958488324 25.168106831006, 121.646377352952 25.1682335613551, 121.6467248202 25.1684471585162, 121.646798597493 25.1685875733631, 121.64690331365 25.1686250569875, 121.647453073474 25.1685274805685, 121.647719623692 25.1685155810052, 121.647957614957 25.168579838647, 121.649116632422 25.1690290471613, 121.650101916263 25.1694169729247, 121.650399405346 25.1696442545837, 121.651032462113 25.1708574150616, 121.651077680453 25.171021629035, 121.651058641152 25.1711858430085, 121.650849208838 25.1715350951912, 121.650932505781 25.1719486050157, 121.65098486386 25.172794663966, 121.651006283074 25.1729564980268, 121.651384689186 25.1738715744441, 121.65143228744 25.1740613724787, 121.651301392243 25.1746652753159, 121.651168117134 25.1748747076299, 121.650673095301 25.1754595711658, 121.650644536349 25.1755690471481, 121.650687374777 25.1762348277145, 121.650754012332 25.1764341453996, 121.651190631261 25.1769113964607, 121.651310911894 25.1770142491103, 121.651379929361 25.1770118691976, 121.651437047265 25.1769785504204, 121.651625060365 25.1766840362288, 121.65219385949 25.1761604554439, 121.652479449009 25.1758082283703, 121.652634143332 25.1755494128687, 121.652876894423 25.175312016581, 121.652955431541 25.1750787851404, 121.653031588746 25.1750121475859, 121.653219601846 25.1749954881973, 121.653769361671 25.1752477589392, 121.654195366037 25.1756684085016, 121.654333400971 25.1757350460561, 121.654497614944 25.175749325532, 121.654873641144 25.1756350897244, 121.65488792062 25.176424625749, 121.654716566909 25.1767262796785, 121.654557112761 25.1769327371017, 121.654528553809 25.1770612523852, 121.654509514507 25.1774247840439, 121.654557112761 25.1776246967073, 121.654740366035 25.1779620493267, 121.654759405337 25.1781286432128, 121.654676108394 25.1783880536926, 121.654597571276 25.1785516726879, 121.654485715381 25.1786944674474, 121.654143007958 25.1789913615516, 121.654066850753 25.1793596530356, 121.65360752761 25.1797374641702, 121.653324318003 25.1798136213753, 121.653193422807 25.1799159576197, 121.653193422807 25.1800349532526, 121.653448073462 25.1803871803261, 121.653481392239 25.1805394947363, 121.653407614946 25.1809666890586, 121.653326697916 25.1824690089245, 121.653288619313 25.1827421039022, 121.653091086563 25.1831324095782, 121.652991130231 25.1834650023723, 121.652479449009 25.1841635067377, 121.652360453376 25.1842706028074, 121.652200999228 25.1843562796631, 121.652017745954 25.1845103790078, 121.651791654251 25.1848786704917, 121.651503684819 25.1852213779146, 121.651272833291 25.185670586429, 121.651070540715 25.1858133811885, 121.650630256873 25.1860347130658, 121.650185213206 25.1862292709257, 121.650092396612 25.1863149477814, 121.649882964298 25.1867284576059, 121.649806807093 25.1869735886098, 121.649821086569 25.1873085613165, 121.649754449015 25.1873942381722, 121.649614034168 25.1874626606612, 121.6491499512 25.1879814816208, 121.649014296178 25.1880790580398, 121.648752505786 25.1881760394807, 121.648281283079 25.1882759958124, 121.647962374783 25.1883926115327, 121.647738662993 25.1885324314014, 121.647419754697 25.1888227807458, 121.647384056007 25.1889316617499, 121.647379296181 25.1891625132778, 121.647338837666 25.1892862687361, 121.647226981771 25.1894076442817, 121.646969951204 25.1895754281242, 121.64683191627 25.1896920438444, 121.646634383519 25.1900323713547, 121.64660820448 25.19019599035, 121.646503488323 25.1911211813961, 121.64627739662 25.1920243582502, 121.646122702297 25.1923759903456, 121.645994187014 25.1925259248431, 121.645637200115 25.1928043746242, 121.645258794002 25.1934053025706, 121.645051741601 25.1940258647964, 121.644873248151 25.1943066944901, 121.644635256886 25.1944750733108, 121.644330628065 25.1947624477643, 121.644175933742 25.1950432774581, 121.644204492694 25.1951670329163, 121.644285409725 25.1952646093354, 121.644711414091 25.195490701038, 121.644797090946 25.1956043418674, 121.645046981776 25.1957923549675, 121.645168357321 25.1957923549675, 121.645475366054 25.195732857151, 121.645706217582 25.1957614161029, 121.646117942472 25.1960017872815, 121.646260737232 25.1961933702505, 121.646539187013 25.196671732695, 121.646691501423 25.1981264543077, 121.646717680462 25.1985970820361, 121.646670082209 25.1987779553981, 121.646641523257 25.1993366398948, 121.646515387886 25.1996906519028, 121.646405911904 25.2000494237362, 121.646360693563 25.2003272785391, 121.646374973039 25.2005438505911, 121.646484449022 25.2009573604156, 121.646660562558 25.2014517872705, 121.646670082209 25.2016683593224, 121.646436850768 25.2022770219849, 121.646436850768 25.2024263615043, 121.646484449022 25.2025429772246, 121.646593925004 25.2026572130322, 121.647338837666 25.2031135612846, 121.647719623692 25.2034842326812, 121.647886217578 25.2036627261306, 121.648050431551 25.203909642069, 121.648224165175 25.2042404499286, 121.648274143341 25.2049038505823, 121.648228925001 25.2053358047299, 121.648064711027 25.2059159084405, 121.647869558189 25.2062728953393, 121.647702964303 25.2064323494875, 121.647443553823 25.206622147522, 121.647391195745 25.2067459029803, 121.647381676094 25.2068767981765, 121.647422134609 25.2070594564731, 121.647341217579 25.2074878407517, 121.647226981771 25.2077347566901, 121.647058007972 25.2079180099648, 121.647000890069 25.208026890969, 121.646943772165 25.2086236540682, 121.646848575658 25.208890204286, 121.646765278715 25.2091133210978, 121.646698641161 25.2094560285207, 121.646634383519 25.2096434466426, 121.646610584392 25.2100355372531, 121.646570125877 25.2103181518814, 121.646505868235 25.2105704226232, 121.646065584394 25.2112742817921, 121.646041785267 25.2114093418355, 121.646091763433 25.2115711758963, 121.646355933738 25.2118258265508, 121.646803815948 25.2121224774026, 121.646035835485 25.2129140416141, 121.645067211033 25.213867196634, 121.644588848589 25.2144324258905, 121.643953411909 25.2151101060202, 121.643463812382 25.2156104350107, 121.642377909729 25.2166814433532, 121.641706774359 25.2174204062338, 121.641753981497 25.2178469377903, 121.641781741608 25.2181912004462, 121.641679405363 25.2184815497906, 121.641769842044 25.2192395519725, 121.641874558201 25.2202218609225, 121.641953553949 25.2209416404138, 121.642107454967 25.2210225574442, 121.642589783933 25.2212661018397, 121.64299912891 25.2214914002381, 121.643478284659 25.2218555268749, 121.643938401107 25.2221252503097, 121.644541312314 25.2223981469613, 121.644680933856 25.2225187292027, 121.644719012459 25.2226448645736, 121.64468728029 25.2228035254176, 121.644744398194 25.2228892022733, 121.644779303579 25.2232410326948, 121.644692040115 25.2234421353145, 121.644733291935 25.2236023827669, 121.644847527742 25.2237892059106, 121.644985562677 25.2241124773802, 121.644955417116 25.2241093041633, 121.644838008092 25.2237987255613, 121.644714252633 25.2236178521992, 121.644671414206 25.2234310290554, 121.644755504453 25.2232299264357, 121.644723772284 25.2228907888817, 121.644646028471 25.2227860727247, 121.644673000814 25.2226242386639, 121.644641268645 25.2225195225069, 121.644531792663 25.2224342423033, 121.643909842155 25.2221458762194, 121.643303757731 25.2217785763656, 121.64289758597 25.2214787073706, 121.641940861081 25.2209860654501, 121.641845999249 25.2202117462937, 121.641743663005 25.2192657310118, 121.641660366062 25.218479169878, 121.641750802743 25.2182316589614, 121.641705584402 25.2179079908398, 121.641643706673 25.217760436255, 121.641477112787 25.2176462004473, 121.639947228815 25.2192102221229, 121.639781751432 25.2193206970809, 121.638920516865 25.2203271944642, 121.638510584255 25.2208758084046, 121.638138260141 25.2212180457214, 121.637181123909 25.222008764357, 121.636769310875 25.2224280990912, 121.631849052942 25.2214331289905, 121.629612913506 25.2209713893215, 121.629613248182 25.2209358347202)","wkt1":"LINESTRING (121.629613248182 25.2209358347202, 121.63171471106 25.2213606491298, 121.632885690064 25.2216090075886, 121.634481818154 25.2219358489272, 121.63610333198 25.2222690366995, 121.63676336109 25.2224054850253, 121.636871250464 25.2222523773109, 121.637935864727 25.2213694297142, 121.638427713344 25.2209224027864, 121.639748564869 25.2193016822653, 121.64146686181 25.2175012783385, 121.641735333311 25.217706293242, 121.641782931564 25.2181912004463, 121.641677025451 25.2184812523016, 121.641772221957 25.2192404444398, 121.641870988332 25.2202188860317, 121.641961090339 25.2209612746932, 121.642432313045 25.221169913703, 121.642924161661 25.2214396371377, 121.643371585241 25.2217918642113, 121.643730158749 25.2220227157393, 121.644605966607 25.2224384071504, 121.64469481668 25.2225423300032, 121.644707509548 25.222678778329, 121.64469481668 25.2227898409198, 121.644736068499 25.2228977302937, 121.644777320319 25.2232459908462, 121.64469481668 25.2234490767265, 121.644764627451 25.2236585090405, 121.644878863259 25.2238489020532, 121.644853477524 25.2238584217039, 121.644726548849 25.2236331233055, 121.644672604162 25.2234522499433, 121.644761454234 25.2232332979787, 121.644723375632 25.2228977302937, 121.644661497903 25.2227834944861, 121.644666257728 25.2226295934674, 121.644604379999 25.2224709326235, 121.643709532839 25.2220528612996, 121.643343026289 25.221808920252, 121.642908295577 25.2214789056966, 121.642352982623 25.2211766567889, 121.641937291212 25.2209862637761, 121.641850759075 25.2202153161627, 121.641743663005 25.2192618636537, 121.641662745975 25.2184785748998, 121.641754372612 25.2182352288304, 121.641709154271 25.2179062059054, 121.641642516717 25.2177586513205, 121.641478302744 25.2176467954255, 121.641341519743 25.2176313802306, 121.641823390079 25.2171595083086, 121.642517134619 25.2164357173712, 121.64387844466 25.2150970165005, 121.644578138982 25.2143628134453, 121.644987483959 25.2138826660663, 121.645984667363 25.2128432392125, 121.646689183489 25.2121133544038, 121.646346414087 25.2118555754591, 121.646153641162 25.2116794619223, 121.64605368483 25.211577125678, 121.646015606228 25.2114248112678, 121.646020366053 25.2113224750235, 121.646317855135 25.2108024641075, 121.646477309284 25.2105525732783, 121.646582025441 25.210020662799, 121.64660820448 25.2096327370356, 121.646670082209 25.2094381791758, 121.646741479589 25.2091121311415, 121.646810497056 25.2088884193515, 121.646910453388 25.2086242490464, 121.646972331117 25.2080138014494, 121.647046108409 25.2078763614933, 121.647210322383 25.2077050077819, 121.647312658627 25.2074580918435, 121.647391195745 25.2070701660801, 121.647341217579 25.2068702534168, 121.647355497055 25.2067441180458, 121.647405475221 25.2065947785265, 121.647693444652 25.2063954608413, 121.647857658626 25.2062431464311, 121.648033772163 25.2058980590956, 121.648193226311 25.2053346147736, 121.648233684826 25.2048979008007, 121.648186086573 25.2042362850815, 121.648017112774 25.2039108320254, 121.647850518888 25.2036728407595, 121.647686304914 25.203497917179, 121.647300759064 25.2031266508042, 121.646567745965 25.2026768473117, 121.646427331118 25.202544167181, 121.646396392253 25.2024085121594, 121.646410671729 25.2022657173999, 121.646634383519 25.2016671693661, 121.646627243781 25.2014553571395, 121.646448750332 25.2009418909833, 121.646346414087 25.2005242163117, 121.646334514524 25.2003147839977, 121.646374973039 25.20001253509, 121.646486828934 25.1996728025579, 121.646603444655 25.199344374611, 121.64664390317 25.1987595110751, 121.646677221947 25.1985762578003, 121.646570125877 25.1973547676281, 121.646513007974 25.1966889870618, 121.646239318018 25.1962040798575, 121.646103662996 25.1960279663208, 121.645684798368 25.195790570033, 121.645461086578 25.1957667709064, 121.645173117147 25.1958262687229, 121.645061261252 25.1958286486356, 121.644768531995 25.1956358757102, 121.644678095313 25.195504980514, 121.644230671734 25.1952509248376, 121.644178313655 25.1951771475452, 121.64413785514 25.1950367326983, 121.644302069113 25.1947350787688, 121.644625737235 25.1944494892497, 121.644873248152 25.1942573113025, 121.645030322387 25.194009800386, 121.6452207154 25.1934302916535, 121.645608641163 25.1927948549736, 121.645979907538 25.1924961759349, 121.646110802734 25.1923510012627, 121.646251217581 25.1920273331411, 121.646474929371 25.1911128517019, 121.646584405353 25.1901287578174, 121.646610584393 25.1900050023591, 121.646720060375 25.1897908102198, 121.646829536357 25.189636115897, 121.646998510156 25.1895058156789, 121.647212702295 25.189379680308, 121.647317418452 25.189260684675, 121.647345977404 25.1891583484307, 121.647343597491 25.1889221420993, 121.647393575657 25.1887983866411, 121.647722003604 25.1885014925369, 121.647943335482 25.1883521530175, 121.648293182642 25.1882331573846, 121.648750125873 25.1881403407909, 121.649009536353 25.1880380045465, 121.649135671724 25.1879380482148, 121.649423641155 25.1876173549841, 121.649618793993 25.187429341884, 121.649735409714 25.1873698440675, 121.649778248142 25.1872960667751, 121.649778248142 25.1869610940684, 121.649861545085 25.1867016835885, 121.650066217573 25.186288173764, 121.650175693556 25.186204876821, 121.650649296175 25.1859912796598, 121.651068160803 25.1857770875205, 121.651249034165 25.185641432499, 121.651467986129 25.1852094783514, 121.651777374775 25.1848572512778, 121.651993946827 25.1844955045537, 121.652191479578 25.1843223659077, 121.652365213202 25.1842271694014, 121.652462789621 25.1841438724583, 121.652962571279 25.1834501279182, 121.653067287436 25.1831145602333, 121.653260060362 25.1827343691861, 121.653298138964 25.1824422349072, 121.653376676082 25.1809637141678, 121.653452833287 25.1805210504132, 121.653409994859 25.180397294955, 121.653164863855 25.1800385231216, 121.653162483943 25.179924287314, 121.653274339838 25.1798005318557, 121.653602767784 25.1797172349127, 121.654047811452 25.1793328790183, 121.654119208831 25.1789758921194, 121.654473815818 25.1786629336048, 121.6545832918 25.1785201388452, 121.65465468918 25.178374964173, 121.654733226297 25.1781179336059, 121.654714186996 25.1779537196324, 121.654521414071 25.177609227275, 121.654490475206 25.1774354936509, 121.654504754682 25.1770410231277, 121.654542833285 25.176908342997, 121.654716566909 25.176691770945, 121.654854601843 25.1764228408145, 121.654864121494 25.1756603762964, 121.654504754682 25.1757912714927, 121.654328641145 25.1757627125408, 121.654169186997 25.175691315161, 121.653740802719 25.1752772103583, 121.65323150141 25.1750255345946, 121.653045868222 25.1750398140706, 121.652981610581 25.1751040717124, 121.652910213201 25.1753277835023, 121.652661512328 25.1755514952923, 121.652516337656 25.17582131789, 121.65222955818 25.1761836595923, 121.65166551888 25.1766911759668, 121.651462036348 25.1770074068614, 121.651410868226 25.1770371557696, 121.65128949268 25.1770585749835, 121.650727833293 25.1764448550066, 121.650646916262 25.1762392900507, 121.65059574814 25.1755666672355, 121.650639776524 25.1754345820829, 121.651141938095 25.1748476361234, 121.651278783073 25.1746266017352, 121.651384689186 25.1740631574132, 121.651333521064 25.173900133396, 121.650955114951 25.1729600678957, 121.650934885694 25.1727973413677, 121.650902756873 25.1719735940986, 121.650799230672 25.1715327152785, 121.651026512331 25.1711736459561, 121.651028892244 25.1710144892971, 121.650951545082 25.1707744156076, 121.650361326743 25.1696451470509, 121.650085256875 25.1694455318767, 121.649095213209 25.169064150873, 121.647939765613 25.1686098850443, 121.647719623692 25.1685599068784, 121.647420944653 25.1685670466164, 121.647016359501 25.1686455837342, 121.646874754698 25.1686527234721, 121.646761708846 25.1686146448696, 121.646683171729 25.168475419979, 121.646370213214 25.1682523031673, 121.64595967828 25.1681487769666, 121.645290922823 25.1678480155043, 121.64479590099 25.1678051770765, 121.644461523262 25.1676796366837, 121.644219962127 25.1675594510944, 121.643854645534 25.1673027180163, 121.643639263438 25.1672503599378, 121.6428800713 25.1671420739119, 121.642339831126 25.1669269893053, 121.641700824577 25.1667464134323, 121.641129645539 25.1664385122321, 121.640086053838 25.1659821639797, 121.639789754712 25.165889347386, 121.639428007988 25.1658476989145, 121.639173357333 25.1660651634337, 121.638667625893 25.1666419947644, 121.638458193579 25.1672090089554, 121.638397505807 25.1674574123392, 121.638333248165 25.1675537988019, 121.63767996214 25.1679946776219, 121.637497898822 25.168077974565, 121.636902920657 25.1681077234732, 121.636209176117 25.1682966290405, 121.635956905375 25.1682951415951, 121.635733193585 25.1683843883198, 121.635494012363 25.1684902944332, 121.635346457778 25.1685426525117, 121.634866905377 25.1686473686687, 121.633544863895 25.168619702184, 121.632276370448 25.1684423986909, 121.631549307131 25.1686922895201, 121.631084034206 25.1688193173583, 121.630577112809 25.1691105591699, 121.629865518924 25.1691926661566, 121.629545420672 25.1693280236891, 121.628219809321 25.1700827534911, 121.628082964343 25.1701636705215, 121.627925890107 25.170291888316, 121.627737877007 25.1705310695382, 121.627648630283 25.1709088806728, 121.627466566964 25.1711278326374, 121.626589569149 25.1715258730296, 121.626287320242 25.1715401525056, 121.625737560417 25.1714628053442, 121.625316313383 25.1714428973305, 121.624776436563 25.1715453421587, 121.624767528317 25.1714696220683, 121.625308147491 25.1713872207935, 121.625733990548 25.1714339489032, 121.626287320242 25.1715089161519, 121.626582429411 25.1714898768507, 121.627438008012 25.1710915389694, 121.627605791855 25.1709005509785, 121.627693848623 25.1705283921365, 121.627889001461 25.1702680891894, 121.628055595347 25.1701315417006, 121.628237658666 25.1700220657183, 121.629531141196 25.1692944074228, 121.629860759099 25.169157859934, 121.630562833333 25.169053143777, 121.63107927438 25.1687752889741, 121.63153978748 25.1686506410486, 121.632224012369 25.1684117573154, 121.633530584419 25.1685831110269, 121.634872855159 25.1686069101534, 121.635453553847 25.1684653053502, 121.63572843376 25.1683260804597, 121.6359616652 25.1682630127742, 121.636212745986 25.1682570629926, 121.636886261268 25.1680752971633, 121.637505038559 25.1680300788227, 121.637640693581 25.1679824805696, 121.638320158645 25.1675201825356, 121.638357047291 25.1674202262039, 121.638415355152 25.167200381772, 121.638625977422 25.1666393173627, 121.639145653663 25.1660485086933, 121.639424103444 25.1658114098946, 121.639816789033 25.1658715026892, 121.640102378552 25.1659565845668, 121.641137640558 25.1664023719568, 121.641726668942 25.1667132480479, 121.642366865447 25.1668926339646, 121.642882116538 25.1671112884402, 121.643635358894 25.1672088648592, 121.643874540117 25.1672636028504, 121.644245806491 25.1675417551424, 121.644805085966 25.1677663593996, 121.645319147101 25.1678187174781, 121.645959343606 25.1681051994645, 121.646375828322 25.1682310373464, 121.646725675482 25.168446121953, 121.646798262819 25.1685841568872, 121.646907738801 25.1686198555771, 121.647449168931 25.1685306088524, 121.647716909105 25.1685151394201, 121.647959660196 25.1685805870182, 121.649118677661 25.1690286055763, 121.650105151459 25.1694159363616, 121.650403830497 25.1696441104878, 121.651034507352 25.1708554860314, 121.65107734578 25.1710229723848, 121.651058306479 25.1711880788255, 121.650847684208 25.171536438541, 121.65093455102 25.1719511383219, 121.650985719143 25.1727936274033, 121.651007138357 25.1729578413768, 121.651385544469 25.1738705378816, 121.651431952766 25.1740606334053, 121.651305817395 25.1746648337317, 121.651166592505 25.1748739685566, 121.650672760628 25.1754588320926, 121.650640631807 25.1755692005422, 121.650684660191 25.1762334936632, 121.650753677658 25.1764369761956, 121.651192771544 25.1769099838366, 121.651311767177 25.1770170799063, 121.651387924382 25.1770146999936, 121.651440282461 25.1769790013037, 121.651622345779 25.1766829996667, 121.652193524817 25.1761585264144, 121.652479114336 25.1758057043627, 121.652631428746 25.1755415340575, 121.65287655975 25.1753097900623, 121.652953906912 25.1750801284907, 121.65303244403 25.1750114085127, 121.653221647086 25.174994749124, 121.653769026998 25.1752470198659, 121.65419622132 25.1756712392975, 121.654336636167 25.1757343069829, 121.654494900359 25.1757462065462, 121.654820948393 25.1756557698652, 121.65522077372 25.1753276394073, 121.655492083763 25.1752470198659, 121.655689616514 25.1747912665917, 121.655765773719 25.1744072081863, 121.656351232233 25.1734980815504, 121.656716548826 25.1729953250012, 121.656874813018 25.1723822000023, 121.657137793367 25.171973152514, 121.657454321751 25.1717080897416, 121.657866046641 25.1714739658337, 121.6581968545 25.1713421781702, 121.658532422185 25.1712493615765, 121.659011974586 25.1710083954197, 121.659174998603 25.1706561683462, 121.659403470219 25.1706145198746, 121.659581963668 25.1704919543727, 121.659595053188 25.1700359036093, 121.65970452917 25.1695379068854, 121.659566494236 25.1688899756639, 121.659528415633 25.1680296372376, 121.659957989868 25.1673867633305, 121.660224540086 25.1668239139866, 121.660355435282 25.1667290149693, 121.660685053186 25.166706405799, 121.661294310826 25.166807552087, 121.661778623052 25.1670464358202, 121.66223318637 25.1670678550341, 121.662851963662 25.1666567251222, 121.663473120866 25.1662051366951, 121.663780129599 25.1660317005601, 121.664309660166 25.1659674429183, 121.664609529161 25.1658900957569, 121.664724954925 25.1657342114777, 121.664723764968 25.1655997464124, 121.664597629597 25.1655247791637, 121.664377487676 25.1655580979409, 121.663173251871 25.1659543533987, 121.662932880692 25.1659472136607, 121.66286862305 25.165840117591, 121.662929310823 25.1656878031808, 121.663238699469 25.1656119434648, 121.663589736586 25.1655798146439, 121.663813448376 25.1654340449935, 121.664426275886 25.1648060455406, 121.664834430907 25.1647167988158, 121.665246155797 25.1646918097329, 121.666092214747 25.1642794898647, 121.666281417804 25.1642711601704, 121.666413502956 25.1642961492533, 121.666645544441 25.1645805488161, 121.666968022606 25.1647730242524, 121.667726024788 25.1650797354964, 121.667953306447 25.165103534623, 121.668393590289 25.165276970758, 121.669353885047 25.1655182344039, 121.669657323911 25.1655789221767, 121.66988460557 25.1656051012159, 121.670088088102 25.1655967715216, 121.670855609935 25.1654742060197, 121.671721898143 25.1653079096226, 121.672463240936 25.1651365559111, 121.672807138316 25.1651151366972, 121.673071308621 25.1651425056928, 121.673414016044 25.1652234227232, 121.673612738751 25.1653471781815, 121.674117280235 25.165757118137, 121.674575413421 25.1662967633325, 121.675267968005 25.166850688004, 121.675715391585 25.167204700012, 121.675909354467 25.1674093725007, 121.67623897237 25.1680073255564, 121.676626898134 25.1687572955331, 121.676998164509 25.1695346345055, 121.677501516036 25.1705588894162, 121.677844223459 25.1711440504413, 121.677956079354 25.1712684008778, 121.678179791144 25.171406435812, 121.678899714723 25.1716488894142, 121.679601788958 25.1718615941081, 121.680419288956 25.1724051066617, 121.680625151401 25.1725214248929, 121.680998797689 25.1725999620106, 121.681339125199 25.1726190013119, 121.681780598997 25.1726154314429, 121.682011450525 25.1727210400672, 121.682210173232 25.1730408408308, 121.682581439607 25.1737301230347, 121.682669496376 25.1738098501088, 121.682737323886 25.1738443588424, 121.683473906855 25.1740987120078, 121.684167651395 25.1743691295837, 121.684759059691 25.1745571426838, 121.685464703794 25.1746916077491, 121.685974005103 25.1748317251069, 121.686641570604 25.1750613866785, 121.687229409031 25.1753356716125, 121.687698251825 25.1754853086209, 121.687762509467 25.1757622709567, 121.687916013833 25.1760178140784, 121.688296799859 25.1764482807807, 121.688400326059 25.1765660864573, 121.688509802042 25.1767692715006, 121.688657356626 25.1768487010856, 121.689141668853 25.1773362856917, 121.689678339157 25.1778806907125, 121.69006983479 25.1783203795763)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0454092160'=='0100020200' || '0454092160'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
