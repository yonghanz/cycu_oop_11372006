
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231493186</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0162002000">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0162002000">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0162002000" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0162002000" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0162002000" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0162002000',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="aLNNZ6cLgQtvsT5r476w2kEi6EOOErTiAUFRjgWuYxlMxhnlDbL_R4QEBvLrRhQl7B17PFqNAPilwxlNvKBqjZLznmc1" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/taipei_city.svg" width="100%" class="vipstop-city" alt="臺北市">                
 <span class="stationlist-title">貓空右線 </span>                 

                        <a href="../EBus/VsSimpleMap?routeid=0162002000" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0162002000" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">臺北市公共運輸處公車申訴服務電話02-27291181</a>                </div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">貓空纜車站 - 杏花林</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 0900 - 2000 <br>
                        [假日] 0830 - 2000
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> 尖峰:10分至15分<br/>離峰:15分至20分<br/>班表:1900 1930 2000<br/>平日1900後固定班次<br>
[假日]<br /> 尖峰:7分至10分<br/>離峰:10分至15分<br/>班表:1900 1930 2000<br/>假日1900後固定班次<br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content">一段票</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">欣欣客運富德站:02-2239-1333</span>
                </li>

                    <li>
                        <span class="stationlist-move-route-bus-item">備註 :</span>
                        <span class="stationlist-move-route-bus-content">於道路平直、白線路段及安全無虞狀況下,配合隨招隨停。</span>
                    </li>
            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 杏花林</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 貓空纜車站</a>
                </p>


            <p> 
</p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">貓空纜車站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166603300" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="24.9685" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.5881" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">田寮橋</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166600440" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.97012" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.58686" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">樟樹步道北口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166602800" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.968542" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.583422" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">樟山寺</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166602640" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.97112" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.58003" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">望遠亭(老泉里)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166601860" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.970101" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.57883" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">杏花林(老泉里)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166600540" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.9691" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.57678" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">樟樹步道南口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166601440" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.969425" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.580321" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">瓦厝</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165101140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.967886" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.580639" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">樟湖步道</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166602940" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.96589" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.58306" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">貓空纜車站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166603300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.9685" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5881" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0162002000";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 9;
        var existBackNum = 1;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0162002000',
                        url: './StopStatusRecent3OfRoute?routeid=0162002000&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0162002000',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0162002000',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0162002000');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0162002000","Name":"貓空右線","BeginStop":"貓空纜車站","GoDirStops":[{"UniStopId":"1166603300","Name":"貓空纜車站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5881,"Latitude":24.9685,"PublicId":"1166603300"},{"UniStopId":"1166600440","Name":"田寮橋","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.58686,"Latitude":24.97012,"PublicId":"1166600440"},{"UniStopId":"1166602800","Name":"樟樹步道北口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.583422,"Latitude":24.968542,"PublicId":"1166602800"},{"UniStopId":"1166602640","Name":"樟山寺","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.58003,"Latitude":24.97112,"PublicId":"1166602640"},{"UniStopId":"1166601860","Name":"望遠亭(老泉里)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.57883,"Latitude":24.970101,"PublicId":"1166601860"},{"UniStopId":"1166600540","Name":"杏花林(老泉里)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.57678,"Latitude":24.9691,"PublicId":"1166600540"},{"UniStopId":"1166601440","Name":"樟樹步道南口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.580321,"Latitude":24.969425,"PublicId":"1166601440"},{"UniStopId":"1165101140","Name":"瓦厝","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.580639,"Latitude":24.967886,"PublicId":"1165101140"},{"UniStopId":"1166602940","Name":"樟湖步道","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.58306,"Latitude":24.96589,"PublicId":"1166602940"}],"LastStop":"杏花林","BackDirStops":[{"UniStopId":"1166603300","Name":"貓空纜車站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5881,"Latitude":24.9685,"PublicId":"1166603300"}],"RouteMapUrl":"../MapOverview?nid=0162002000","RouteTracks":null,"StopDirection":null,"TicketPrice":"一段票","BusTimeDesc":"0900 - 2000","HeadwayDesc":"尖峰:10分至15分;離峰:15分至20分;班表:1900 1930 2000;平日1900後固定班次","HolidayBusTimeDesc":"0830 - 2000","HolidayHeadwayDesc":"尖峰:7分至10分;離峰:10分至15分;班表:1900 1930 2000;假日1900後固定班次","RouteNote":"於道路平直、白線路段及安全無虞狀況下,配合隨招隨停。","SegmentBuffer":"","StopLng":0,"StopLat":0,"IsNtpcMainLine":false,"orgphone":"欣欣客運富德站:02-2239-1333","aliasName":null,"aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":"LINESTRING (121.587936744755 24.9684211331689, 121.58769616171 24.9688379889882, 121.587657560762 24.9688722644714, 121.587433347393 24.9690077323464, 121.587375870761 24.9690535248972, 121.587325845416 24.969158195742, 121.587271600696 24.9693307702813, 121.587242469593 24.969449, 121.587244651552 24.9696057487695, 121.587282958703 24.9698450805832, 121.587306610737 24.9699066261953, 121.587380047859 24.9699897077694, 121.587584835776 24.9701595963249, 121.587667012196 24.9701754190346, 121.587731923799 24.9701502268043, 121.587862767186 24.9700841653538, 121.588181989656 24.9699212104687, 121.588336472 24.9698223167853, 121.588510673733 24.9696788522645, 121.58856007631 24.9696766911436, 121.588594438154 24.9696878952756, 121.588637657991 24.9697063151574, 121.588659762975 24.9697417214588, 121.588660771965 24.9697751869207, 121.588631563528 24.9698547385292, 121.588551634406 24.9699684874456, 121.588495989462 24.9700117608416, 121.588287609848 24.9701528284118, 121.588258295328 24.9702217892935, 121.588168300107 24.9705994789891, 121.588107927446 24.9707411050261, 121.587986736579 24.9709324163756, 121.587899717145 24.9710227587456, 121.587829318558 24.9710694908665, 121.587727808196 24.9710939875374, 121.587577957196 24.9710979688149, 121.587290190203 24.9710439582434, 121.587218536931 24.9710193636573, 121.587170554706 24.970964552199, 121.587134413233 24.9709164937401, 121.586994720424 24.9704147125135, 121.586905969061 24.9701515563711, 121.586850181238 24.9700514641873, 121.586764651131 24.9699099087101, 121.586645386291 24.9696220342561, 121.586591103811 24.969528112947, 121.586506591625 24.9694649413201, 121.586352435221 24.9694177270639, 121.586254323229 24.9693907073765, 121.586172633583 24.9693263013386, 121.586077604317 24.9691993007885, 121.585821344969 24.9689169910315, 121.585481075098 24.9686797032687, 121.585398269561 24.9685954533522, 121.585307753362 24.9685529703247, 121.585160498784 24.9684996673805, 121.584857023564 24.9684151519736, 121.584738608959 24.9683838539661, 121.584661694322 24.9683918415402, 121.584544113459 24.9684242720167, 121.584415031943 24.9684390951353, 121.58429560079 24.9684376845985, 121.584165841036 24.9684056380546, 121.584009453887 24.9683129563366, 121.583895505418 24.9682844762187, 121.583781297924 24.9682676558984, 121.583671140207 24.9682791674747, 121.58359425881 24.96830742824, 121.583381654182 24.9684777693209, 121.583256490225 24.9685832240079, 121.583101171996 24.9686572225841, 121.583074940893 24.9685431542928, 121.583035938941 24.9684796569684, 121.582974216845 24.9684381237231, 121.582828597918 24.9684118140906, 121.582550504979 24.9684173411367, 121.582473288086 24.9684018825433, 121.582376750488 24.9683571982929, 121.582260278444 24.968312297233, 121.582133147541 24.9683220955674, 121.582056481334 24.968366272676, 121.582031789521 24.9683946937636, 121.581966162685 24.9685681365434, 121.581944583129 24.9686962841878, 121.581935615434 24.9688374061745, 121.581868584404 24.968962290536, 121.581820769185 24.9690665755317, 121.581673207886 24.9693035393548, 121.581580934415 24.9695490841731, 121.58147724567 24.9697430152918, 121.581459048223 24.9698350315014, 121.581464708367 24.9699066896462, 121.581484941925 24.9700028174697, 121.581480803771 24.9700993027018, 121.581442902192 24.9701906735687, 121.581378466161 24.9702778279903, 121.581309515658 24.9703300020833, 121.5812386379 24.9703406636183, 121.581120998256 24.9703163754037, 121.58092614267 24.9702353716993, 121.58079930594 24.970227923708, 121.580723811152 24.9702556764779, 121.580680358765 24.9703078965409, 121.580663376116 24.9704238030899, 121.580588984098 24.9706337714465, 121.580478338326 24.9707738151046, 121.580324682861 24.9710148895047, 121.580248422949 24.9710776473089, 121.580135579054 24.9711138625853, 121.57994965082 24.971128246771, 121.579946685054 24.9710272189676, 121.579928808483 24.9708593192838, 121.579873247914 24.9706387665281, 121.579781924329 24.970463189173, 121.57970399032 24.9703674180161, 121.579618866483 24.9703095309972, 121.579532181392 24.9702379553384, 121.57943454288 24.9700555740515, 121.579382641594 24.9700115412007, 121.579317581594 24.9699888030269, 121.579193680732 24.9699723232616, 121.579103674952 24.9699816752399, 121.579028700935 24.9700208778796, 121.578969784919 24.9700661303131, 121.578900612601 24.9701091933143, 121.578828288855 24.9701176831313, 121.578759496355 24.9701091208389, 121.57862311256 24.9700704268913, 121.578580492997 24.9700346749664, 121.578537234867 24.9698850351362, 121.578503351203 24.9697918265689, 121.578441059522 24.9696781487508, 121.578347734797 24.9695140622954, 121.578286654549 24.9694722874923, 121.578218694395 24.9694528552195, 121.57806594688 24.9694230291367, 121.577919256377 24.9693479502535, 121.577785455946 24.9692325942891, 121.577729477769 24.9691356199606, 121.577731681027 24.9689912250298, 121.577773310066 24.9688798299089, 121.577876920884 24.9686863089802, 121.577943611387 24.9685690906423, 121.57796375751 24.9684691882772, 121.577950173051 24.9683988986129, 121.577899496153 24.9683358924778, 121.577701764229 24.9682197071118, 121.577617131103 24.9681481216769, 121.577495067457 24.9680266464037, 121.577416363917 24.9679868363362, 121.577342274843 24.9679903653419, 121.577261984888 24.9680208410231, 121.577179131104 24.9680820470821, 121.576974334209 24.9682773250359, 121.576799843653 24.9684243483481, 121.576724275494 24.9684545841373, 121.576664053133 24.9684638510559, 121.576671212978 24.9685778702113, 121.576730315895 24.9687814030313, 121.576761471815 24.9689899945895, 121.576763485462 24.9690991084015, 121.576742564355 24.9691114320703, 121.576745335065 24.9689958321803, 121.576711697464 24.9687800283089, 121.576657298336 24.9685828303023, 121.576647057912 24.9684500526764, 121.576720449677 24.968443276123, 121.576796136282 24.9684115766266, 121.576957691688 24.9682778121888, 121.57717020439 24.9680731438704, 121.577247597782 24.9680165874583, 121.577341300107 24.9679775812683, 121.577409506843 24.9679717599661, 121.577504805168 24.9680200819037, 121.577629246338 24.9681434600416, 121.577713165333 24.9682098196627, 121.577904880638 24.9683239032461, 121.577961991092 24.9683895203331, 121.57797908098 24.9684730914428, 121.577953074727 24.96857683732, 121.577893626124 24.9686890619373, 121.577785894242 24.9688684429276, 121.577739214348 24.969000613551, 121.577742705723 24.9691335958407, 121.577797087397 24.969227345646, 121.577929350312 24.9693325195015, 121.578064047859 24.9694108309979, 121.578220903854 24.9694404211142, 121.578290223906 24.9694627083105, 121.578352112319 24.9694996629718, 121.578434786866 24.9696425145045, 121.578517262129 24.9697992502515, 121.578550230872 24.9698725948753, 121.578590536241 24.9700264466324, 121.578631130376 24.9700609726184, 121.578761407638 24.9700972400142, 121.57882799877 24.9701018327986, 121.57889418034 24.9700959396758, 121.578973304882 24.970055353682, 121.579018501138 24.9700143865347, 121.579096929792 24.969971682797, 121.579190946311 24.9699597567591, 121.579311872543 24.9699757266087, 121.579383569351 24.9700018951261, 121.579445186738 24.9700488805815, 121.579548724551 24.9702087041852, 121.579630467004 24.9702740967794, 121.579720198307 24.9703314967615, 121.579798711012 24.9704223453635, 121.579887868897 24.9705808876076, 121.579978888249 24.9705217584653, 121.580058267868 24.9704469277887, 121.580136563278 24.9703114787824, 121.580193246271 24.9701555715801, 121.580204264614 24.970027388797, 121.580181626964 24.9699093139727, 121.580183131668 24.9697959821907, 121.580270362135 24.969583763996, 121.580335290632 24.9695073727029, 121.580457812366 24.9694131676209, 121.580549286259 24.9693283057913, 121.58059454891 24.9692558955934, 121.58061710911 24.9691671938628, 121.580641201535 24.9690648354137, 121.580647542148 24.9689833649556, 121.580625339233 24.9688682262761, 121.580549882902 24.9686208224825, 121.580537628516 24.9685345925606, 121.580538704357 24.9684477142334, 121.580556931631 24.9683580858863, 121.580594603124 24.9681618573962, 121.580672047208 24.9679770359478, 121.580789225684 24.967796011064, 121.580840193824 24.9676986303323, 121.580913246819 24.9674407499971, 121.580968783301 24.9672632016945, 121.580999966392 24.9670991262962, 121.581047393638 24.9670145132787, 121.581138572964 24.9669598486176, 121.581245436803 24.9669444816276, 121.581488700925 24.9669603818691, 121.581630503842 24.9669338825505, 121.581792351445 24.9668881101203, 121.581871875858 24.9668385214744, 121.58195674289 24.9667594578748, 121.582027487093 24.9666186865262, 121.582115098593 24.966388762376, 121.582166377968 24.9663097691044, 121.582243367164 24.9662535472217, 121.582336118257 24.9662107087165, 121.58250206899 24.9661453078829, 121.582622977487 24.9660702897418, 121.582692867082 24.9659952335856, 121.582767752379 24.965890145113, 121.582923809542 24.9659262306798, 121.583207415048 24.9660057773849, 121.583359491426 24.9660453495008, 121.583482639597 24.9660601722515, 121.583650471621 24.9660475470987, 121.584003200266 24.9659473710102, 121.584086195804 24.965952588385, 121.584322925345 24.9659908212979, 121.584467460686 24.9660510426295, 121.584585351772 24.9660812960639, 121.585061882661 24.9661286726299, 121.585118537282 24.9661485324755, 121.585249721437 24.9662844513781, 121.585302163974 24.9663148099033, 121.585421498398 24.9663500374465, 121.585627242613 24.966395507109, 121.585773496647 24.9664058052942, 121.586150753667 24.9664134306568, 121.586240786057 24.9664281253627, 121.586543357201 24.9665870111511, 121.586631866645 24.9666588052142, 121.586699824034 24.9667401765212, 121.586788022513 24.9669439350814, 121.586837027217 24.9670409253951, 121.586877358273 24.9670748414625, 121.586940419979 24.9670822236191, 121.587081593335 24.9670960104492, 121.587448699353 24.9672291548428, 121.587715908112 24.9673108175207, 121.587807089238 24.9673743530365, 121.587847258052 24.967454681376, 121.587847124816 24.9675946527504, 121.587767635395 24.9679604405477, 121.587771710252 24.9680469307226, 121.587832248816 24.9681395163811, 121.58792397134 24.9682538899708, 121.587973390803 24.968309322431, 121.58797637292 24.9683550119006, 121.587944969793 24.9684055064254)","wkt0":"LINESTRING (121.587965033235 24.9686067141274, 121.5879121711 24.9687198193554, 121.58772463675 24.9688836281564, 121.587677753163 24.9689004517507, 121.58743942826 24.9690208732003, 121.587409149276 24.9690421240321, 121.587281684523 24.9693157281638, 121.587262149695 24.9695379757323, 121.587275335704 24.9697239196047, 121.587308056541 24.9698598355432, 121.587361288947 24.9699408537674, 121.587611334747 24.9701290106396, 121.587684101982 24.9701334378566, 121.587769078484 24.9701064318301, 121.588086519441 24.9699501509373, 121.588284797946 24.9698394702982, 121.58847526252 24.9697026688907, 121.588549983237 24.9696583965579, 121.588632029515 24.9696477711957, 121.58866328524 24.9696645946855, 121.588703820009 24.9697203778193, 121.588712122311 24.9697668637448, 121.58868379681 24.9698191050497, 121.588592959859 24.9699691879971, 121.588518239142 24.9700232001045, 121.58837807675 24.9701055463865, 121.588310193222 24.9701608865988, 121.588262332894 24.9702671397367, 121.588226193462 24.9704588378741, 121.588187123805 24.9706160035608, 121.588146100666 24.9707036620819, 121.588083589216 24.9708010603654, 121.587936589635 24.9709794761121, 121.587883845599 24.9710317169021, 121.587824264373 24.9710529673866, 121.587710474 24.9710724469942, 121.587621102161 24.9710759887407, 121.587413544612 24.9710529673866, 121.587281684523 24.9710326023391, 121.587179615046 24.9710011693242, 121.587152754657 24.9709551265838, 121.586984755136 24.9704043832373, 121.586920290203 24.9701847935628, 121.586880243805 24.9700896084007, 121.586821639321 24.9699984076647, 121.58675815113 24.9698841852883, 121.586682453671 24.9697433994227, 121.586593570203 24.9695871180688, 121.586513965778 24.9694981305802, 121.586467082191 24.9694689107938, 121.586379663835 24.9694445609665, 121.586288826885 24.9694237529285, 121.586233152624 24.9693985176436, 121.586134013372 24.9692873937835, 121.586072478663 24.9692183287044, 121.585968944074 24.9691218146186, 121.585872735046 24.9690319413423, 121.585814618932 24.9689699597341, 121.585766758603 24.9689000090245, 121.585568968469 24.9687702901984, 121.585355550472 24.9686188776072, 121.585274480935 24.9685719485206, 121.585056667602 24.9684772048385, 121.584902830831 24.968406368393, 121.584795389276 24.9683891020032, 121.584683552385 24.9683939720108, 121.584569762012 24.9684249629639, 121.584475994837 24.9684488702652, 121.584347553342 24.9684515266317, 121.584274786107 24.9684417866208, 121.58420690258 24.9684276193309, 121.584078461085 24.9683638665061, 121.583986647393 24.9683187082352, 121.583836229216 24.9682770917748, 121.583726345808 24.9682584971815, 121.58363697397 24.9682722217625, 121.583583253192 24.9683089682138, 121.583504625509 24.9683842319954, 121.583312207452 24.968564422156, 121.583225765838 24.9686383576001, 121.583179126436 24.968661379406, 121.583114173133 24.9686578375899, 121.583083894149 24.9686272894227, 121.583075103476 24.9685719485206, 121.583068754657 24.9685183785037, 121.583039452415 24.9684763193831, 121.582974987482 24.9684475420819, 121.582869499411 24.9684311611535, 121.58269515107 24.9684307184257, 121.582546686376 24.9684360311595, 121.582488081892 24.9684240775081, 121.582366477587 24.968357668313, 121.582304454508 24.9683350891785, 121.582240966316 24.9683297764403, 121.582094455106 24.9683700646988, 121.582056362191 24.9684134520393, 121.581983106585 24.9686476548684, 121.581973339171 24.9688150055771, 121.581945990412 24.96889248268, 121.581769200218 24.9691833534252, 121.581667130741 24.9693688551091, 121.581627572714 24.9694795361715, 121.581504014926 24.9697314458984, 121.581486921952 24.9698456684166, 121.581487410322 24.9699488227702, 121.581524526496 24.9700435653191, 121.581495224254 24.970118385318, 121.581436619769 24.9702432327886, 121.581373131578 24.970318052666, 121.581311108499 24.9703424023205, 121.58122857385 24.9703521421809, 121.581140667124 24.9703353187851, 121.581062527811 24.9702852913052, 121.580956062998 24.9702450036738, 121.580867667901 24.9702334929196, 121.580779272804 24.970249873608, 121.580725552026 24.9702844058629, 121.580706505569 24.970318052666, 121.580680133551 24.970404825958, 121.580642040636 24.9705708461164, 121.580571226884 24.9706744425818, 121.580513110771 24.9707519185138, 121.580436924941 24.970869239118, 121.580393948319 24.9709781479561, 121.580282599799 24.9710627071908, 121.580202995375 24.9711091926092, 121.580117530502 24.9711246877447, 121.58002620518 24.9711313285165, 121.579972972774 24.9710905984439, 121.57996369373 24.9710268469989, 121.579952949575 24.9709192663605, 121.579909972953 24.9707488194775, 121.579882624194 24.9706310560385, 121.57981767089 24.9705208187323, 121.579770298932 24.9704367018458, 121.579686299171 24.9703738355036, 121.579579345987 24.9703415168786, 121.57952562521 24.9703184953871, 121.579501206675 24.9702813068148, 121.5794841137 24.9701214843702, 121.579451392863 24.9700661441401, 121.579399137198 24.9700059339416, 121.579362509396 24.9699975222203, 121.57915006814 24.9699815842206, 121.579104649665 24.9699917668318, 121.579012347602 24.9700626023646, 121.578964975644 24.9700994866317, 121.578915487412 24.9701285586945, 121.578842394597 24.9701264926598, 121.578643139351 24.9700878375133, 121.578591372056 24.970058175145, 121.578547418693 24.9699793706093, 121.578537651279 24.9698797580623, 121.578536674538 24.9698248604463, 121.578460000337 24.9697203778193, 121.57840627956 24.9695977434362, 121.578367698274 24.9695224803969, 121.578275396212 24.9694728953106, 121.5781489082 24.9694405764489, 121.578082978155 24.9694290656194, 121.577911071668 24.9692966910027, 121.577798258035 24.9692032760538, 121.577760653491 24.9691457217845, 121.577740141922 24.9690571767023, 121.577740630292 24.9690000650905, 121.577809490561 24.968804380142, 121.577894467064 24.9686879430227, 121.577936466944 24.9685794748847, 121.577974071488 24.9684280620587, 121.577963815703 24.968391315643, 121.577908141443 24.9683306618967, 121.577714746645 24.9682155525149, 121.577598514418 24.9681274494923, 121.577504258872 24.9680375754897, 121.577452979949 24.9680096835445, 121.577389491757 24.9680087980858, 121.57727325953 24.9680371327604, 121.577221003865 24.9680623683245, 121.577092073999 24.9681996142844, 121.576895748977 24.9683660801464, 121.576806377138 24.9684165511345, 121.576763888887 24.9684342602482, 121.576715540188 24.9685356448753, 121.576709191369 24.9686091376095, 121.57677267956 24.9688663618336, 121.576780249306 24.9690330481564, 121.576778051638 24.9691652016941, 121.57676584237 24.9691861481274, 121.576737028499 24.9691874763028, 121.576726284343 24.9691631264198, 121.576724819231 24.9690303087914, 121.576727261085 24.9688700419956, 121.57671016811 24.9687903512459, 121.576654982221 24.9686628459391, 121.576611517228 24.9685999786906, 121.576596377736 24.9685557059611, 121.576595889366 24.9684950522958, 121.576596377736 24.9684622904496, 121.576687703058 24.9684366122397, 121.576864981623 24.968355150297, 121.577186817916 24.968064277594, 121.577236631727 24.9680231037768, 121.577327468678 24.9679779453809, 121.577416352146 24.967953152529, 121.577477398484 24.9679704189799, 121.57753746808 24.9680346147378, 121.577615119022 24.9681205041823, 121.577706932714 24.9681886844202, 121.577930606496 24.9683086638381, 121.577980420307 24.9683560357532, 121.577999466765 24.9684140331197, 121.577997513282 24.968480885012, 121.577960397108 24.9686199014137, 121.577928653013 24.9686867531942, 121.577851978813 24.9687952212376, 121.577799234777 24.9689231691333, 121.577772862759 24.9690068443288, 121.577781165061 24.9691055721317, 121.577798746406 24.96915294374, 121.577906676331 24.9692614113725, 121.578063931697 24.969383160642, 121.578130350113 24.9694061823085, 121.578193349934 24.969409724103, 121.578272954358 24.9694044114112, 121.578313000756 24.9694203494857, 121.578382349396 24.9694756900062, 121.578432651578 24.9695677765772, 121.578471232863 24.9696625194196, 121.578523000158 24.9697169743848, 121.578588441832 24.9698090607751, 121.578592348798 24.9699383357838, 121.578610906884 24.9699941187935, 121.578756929724 24.9700525581099, 121.578848743416 24.9700742514854, 121.578915650203 24.9700596416615, 121.579035301025 24.969971097237, 121.579104161294 24.9699241686662, 121.579134928648 24.9699223977763, 121.57922674234 24.9699343512821, 121.579376672146 24.969962242791, 121.579419648768 24.9699728681261, 121.579487695086 24.970027618102, 121.579515043845 24.9701185236685, 121.579535229834 24.9702843966395, 121.57958146226 24.9703127307902, 121.579718857218 24.9703564125929, 121.579804159301 24.9704461373283, 121.579875787004 24.9705588834492, 121.579937647293 24.9705512096327, 121.579989089007 24.9705140211307, 121.580136902539 24.9703558222984, 121.580184437288 24.9702383536308, 121.580209832564 24.9701149818944, 121.580215693013 24.9699986935894, 121.580202018633 24.9698469873614, 121.580215041852 24.9697608039734, 121.580235227841 24.9696870167782, 121.580294483486 24.9695536094169, 121.580313367153 24.9694987116554, 121.580523692136 24.9693357891224, 121.580610296541 24.969217138881, 121.580649366197 24.9690306039418, 121.580622017437 24.9688045184941, 121.580567319919 24.9686681586629, 121.580548436252 24.9686049962656, 121.580555599022 24.9684143282716, 121.580646761553 24.9680571939275, 121.580689087014 24.9679473970448, 121.580784156511 24.967800410742, 121.580852528409 24.967645750266, 121.580968435056 24.9673269837861, 121.580986667562 24.9672319439906, 121.580987969884 24.9671121111004, 121.58101987677 24.9670518994564, 121.581077830093 24.9669899168509, 121.581182667004 24.966930295458, 121.581297271329 24.9669391501221, 121.581435968608 24.9669373791893, 121.581740711927 24.966899599284, 121.581837734906 24.9668535550088, 121.581934106725 24.9667827176286, 121.581997920497 24.966694170846, 121.582143129386 24.9663482474714, 121.582178292076 24.9662697357169, 121.582283128987 24.9662260524633, 121.582444616899 24.9661575759806, 121.582573546765 24.9660896897748, 121.582654941882 24.9660223938469, 121.582737639321 24.9658948856719, 121.582923220188 24.9657951222393, 121.582964894488 24.9658010254032, 121.583114010342 24.9658889825125, 121.583218196092 24.9659444722001, 121.583423962948 24.9660070456476, 121.583590660148 24.9660206229009, 121.583776241015 24.965997600601, 121.583967031169 24.9659297143069, 121.584116798185 24.9659391593588, 121.584332332455 24.9659556881978, 121.584487308758 24.966030658261, 121.584545913242 24.9660460064574, 121.585053818773 24.9660955929246, 121.585095493073 24.9661162539468, 121.585187957926 24.9661953561137, 121.585284329744 24.9662774098003, 121.585654189156 24.9663694987648, 121.585711491319 24.9663777631556, 121.585958281314 24.9663877984867, 121.586190094607 24.9663866178595, 121.586256513023 24.9664137722808, 121.586388047532 24.966482248621, 121.586580140008 24.9665843727471, 121.586703209426 24.9667106995836, 121.586744232565 24.9667596954713, 121.5867969766 24.9668883833724, 121.586851022958 24.967011758344, 121.58690116235 24.9670459963524, 121.587009906227 24.9670601638014, 121.587202649864 24.9670961727269, 121.587404509754 24.9671699614758, 121.58751976524 24.9672142347039, 121.587704694946 24.9672785784336, 121.58779748538 24.9673157679134, 121.587859671249 24.9673992966248, 121.587879857238 24.967476627042, 121.587880182819 24.9675412657885, 121.587793903994 24.9678780360603, 121.587783811 24.96798133964, 121.587795531897 24.9680397799123, 121.587857066605 24.9681212420638, 121.587998042948 24.9683057123163, 121.588051438145 24.9683960288511, 121.588050135823 24.9684220022213, 121.587965033235 24.9686067141272)","wkt1":"LINESTRING (121.587965033235 24.9686067141274, 121.5879121711 24.9687198193554, 121.58772463675 24.9688836281564, 121.587677753163 24.9689004517507, 121.58743942826 24.9690208732003, 121.587409149276 24.9690421240321, 121.587281684523 24.9693157281638, 121.587262149695 24.9695379757323, 121.587275335704 24.9697239196047, 121.587308056541 24.9698598355432, 121.587361288947 24.9699408537674, 121.587611334747 24.9701290106396, 121.587684101982 24.9701334378566, 121.587769078484 24.9701064318301, 121.588086519441 24.9699501509373, 121.588284797946 24.9698394702982, 121.58847526252 24.9697026688907, 121.588549983237 24.9696583965579, 121.588632029515 24.9696477711957, 121.58866328524 24.9696645946855, 121.588703820009 24.9697203778193, 121.588712122311 24.9697668637448, 121.58868379681 24.9698191050497, 121.588592959859 24.9699691879971, 121.588518239142 24.9700232001045, 121.58837807675 24.9701055463865, 121.588310193222 24.9701608865988, 121.588262332894 24.9702671397367, 121.588226193462 24.9704588378741, 121.588187123805 24.9706160035608, 121.588146100666 24.9707036620819, 121.588083589216 24.9708010603654, 121.587936589635 24.9709794761121, 121.587883845599 24.9710317169021, 121.587824264373 24.9710529673866, 121.587710474 24.9710724469942, 121.587621102161 24.9710759887407, 121.587413544612 24.9710529673866, 121.587281684523 24.9710326023391, 121.587179615046 24.9710011693242, 121.587152754657 24.9709551265838, 121.586984755136 24.9704043832373, 121.586920290203 24.9701847935628, 121.586880243805 24.9700896084007, 121.586821639321 24.9699984076647, 121.58675815113 24.9698841852883, 121.586682453671 24.9697433994227, 121.586593570203 24.9695871180688, 121.586513965778 24.9694981305802, 121.586467082191 24.9694689107938, 121.586379663835 24.9694445609665, 121.586288826885 24.9694237529285, 121.586233152624 24.9693985176436, 121.586134013372 24.9692873937835, 121.586072478663 24.9692183287044, 121.585968944074 24.9691218146186, 121.585872735046 24.9690319413423, 121.585814618932 24.9689699597341, 121.585766758603 24.9689000090245, 121.585568968469 24.9687702901984, 121.585355550472 24.9686188776072, 121.585274480935 24.9685719485206, 121.585056667602 24.9684772048385, 121.584902830831 24.968406368393, 121.584795389276 24.9683891020032, 121.584683552385 24.9683939720108, 121.584569762012 24.9684249629639, 121.584475994837 24.9684488702652, 121.584347553342 24.9684515266317, 121.584274786107 24.9684417866208, 121.58420690258 24.9684276193309, 121.584078461085 24.9683638665061, 121.583986647393 24.9683187082352, 121.583836229216 24.9682770917748, 121.583726345808 24.9682584971815, 121.58363697397 24.9682722217625, 121.583583253192 24.9683089682138, 121.583504625509 24.9683842319954, 121.583312207452 24.968564422156, 121.583225765838 24.9686383576001, 121.583179126436 24.968661379406, 121.583114173133 24.9686578375899, 121.583083894149 24.9686272894227, 121.583075103476 24.9685719485206, 121.583068754657 24.9685183785037, 121.583039452415 24.9684763193831, 121.582974987482 24.9684475420819, 121.582869499411 24.9684311611535, 121.58269515107 24.9684307184257, 121.582546686376 24.9684360311595, 121.582488081892 24.9684240775081, 121.582366477587 24.968357668313, 121.582304454508 24.9683350891785, 121.582240966316 24.9683297764403, 121.582094455106 24.9683700646988, 121.582056362191 24.9684134520393, 121.581983106585 24.9686476548684, 121.581973339171 24.9688150055771, 121.581945990412 24.96889248268, 121.581769200218 24.9691833534252, 121.581667130741 24.9693688551091, 121.581627572714 24.9694795361715, 121.581504014926 24.9697314458984, 121.581486921952 24.9698456684166, 121.581487410322 24.9699488227702, 121.581524526496 24.9700435653191, 121.581495224254 24.970118385318, 121.581436619769 24.9702432327886, 121.581373131578 24.970318052666, 121.581311108499 24.9703424023205, 121.58122857385 24.9703521421809, 121.581140667124 24.9703353187851, 121.581062527811 24.9702852913052, 121.580956062998 24.9702450036738, 121.580867667901 24.9702334929196, 121.580779272804 24.970249873608, 121.580725552026 24.9702844058629, 121.580706505569 24.970318052666, 121.580680133551 24.970404825958, 121.580642040636 24.9705708461164, 121.580571226884 24.9706744425818, 121.580513110771 24.9707519185138, 121.580436924941 24.970869239118, 121.580393948319 24.9709781479561, 121.580282599799 24.9710627071908, 121.580202995375 24.9711091926092, 121.580117530502 24.9711246877447, 121.58002620518 24.9711313285165, 121.579972972774 24.9710905984439, 121.57996369373 24.9710268469989, 121.579952949575 24.9709192663605, 121.579909972953 24.9707488194775, 121.579882624194 24.9706310560385, 121.57981767089 24.9705208187323, 121.579770298932 24.9704367018458, 121.579686299171 24.9703738355036, 121.579579345987 24.9703415168786, 121.57952562521 24.9703184953871, 121.579501206675 24.9702813068148, 121.5794841137 24.9701214843702, 121.579451392863 24.9700661441401, 121.579399137198 24.9700059339416, 121.579362509396 24.9699975222203, 121.57915006814 24.9699815842206, 121.579104649665 24.9699917668318, 121.579012347602 24.9700626023646, 121.578964975644 24.9700994866317, 121.578915487412 24.9701285586945, 121.578842394597 24.9701264926598, 121.578643139351 24.9700878375133, 121.578591372056 24.970058175145, 121.578547418693 24.9699793706093, 121.578537651279 24.9698797580623, 121.578536674538 24.9698248604463, 121.578460000337 24.9697203778193, 121.57840627956 24.9695977434362, 121.578367698274 24.9695224803969, 121.578275396212 24.9694728953106, 121.5781489082 24.9694405764489, 121.578082978155 24.9694290656194, 121.577911071668 24.9692966910027, 121.577798258035 24.9692032760538, 121.577760653491 24.9691457217845, 121.577740141922 24.9690571767023, 121.577740630292 24.9690000650905, 121.577809490561 24.968804380142, 121.577894467064 24.9686879430227, 121.577936466944 24.9685794748847, 121.577974071488 24.9684280620587, 121.577963815703 24.968391315643, 121.577908141443 24.9683306618967, 121.577714746645 24.9682155525149, 121.577598514418 24.9681274494923, 121.577504258872 24.9680375754897, 121.577452979949 24.9680096835445, 121.577389491757 24.9680087980858, 121.57727325953 24.9680371327604, 121.577221003865 24.9680623683245, 121.577092073999 24.9681996142844, 121.576895748977 24.9683660801464, 121.576806377138 24.9684165511345, 121.576763888887 24.9684342602482, 121.576715540188 24.9685356448753, 121.576709191369 24.9686091376095, 121.57677267956 24.9688663618336, 121.576780249306 24.9690330481564, 121.576778051638 24.9691652016941, 121.57676584237 24.9691861481274, 121.576737028499 24.9691874763028, 121.576726284343 24.9691631264198, 121.576724819231 24.9690303087914, 121.576727261085 24.9688700419956, 121.57671016811 24.9687903512459, 121.576654982221 24.9686628459391, 121.576611517228 24.9685999786906, 121.576596377736 24.9685557059611, 121.576595889366 24.9684950522958, 121.576596377736 24.9684622904496, 121.576687703058 24.9684366122397, 121.576864981623 24.968355150297, 121.577186817916 24.968064277594, 121.577236631727 24.9680231037768, 121.577327468678 24.9679779453809, 121.577416352146 24.967953152529, 121.577477398484 24.9679704189799, 121.57753746808 24.9680346147378, 121.577615119022 24.9681205041823, 121.577706932714 24.9681886844202, 121.577930606496 24.9683086638381, 121.577980420307 24.9683560357532, 121.577999466765 24.9684140331197, 121.577997513282 24.968480885012, 121.577960397108 24.9686199014137, 121.577928653013 24.9686867531942, 121.577851978813 24.9687952212376, 121.577799234777 24.9689231691333, 121.577772862759 24.9690068443288, 121.577781165061 24.9691055721317, 121.577798746406 24.96915294374, 121.577906676331 24.9692614113725, 121.578063931697 24.969383160642, 121.578130350113 24.9694061823085, 121.578193349934 24.969409724103, 121.578272954358 24.9694044114112, 121.578313000756 24.9694203494857, 121.578382349396 24.9694756900062, 121.578432651578 24.9695677765772, 121.578471232863 24.9696625194196, 121.578523000158 24.9697169743848, 121.578588441832 24.9698090607751, 121.578592348798 24.9699383357838, 121.578610906884 24.9699941187935, 121.578756929724 24.9700525581099, 121.578848743416 24.9700742514854, 121.578915650203 24.9700596416615, 121.579035301025 24.969971097237, 121.579104161294 24.9699241686662, 121.579134928648 24.9699223977763, 121.57922674234 24.9699343512821, 121.579376672146 24.969962242791, 121.579419648768 24.9699728681261, 121.579487695086 24.970027618102, 121.579515043845 24.9701185236685, 121.579535229834 24.9702843966395, 121.57958146226 24.9703127307902, 121.579718857218 24.9703564125929, 121.579804159301 24.9704461373283, 121.579875787004 24.9705588834492, 121.579937647293 24.9705512096327, 121.579989089007 24.9705140211307, 121.580136902539 24.9703558222984, 121.580184437288 24.9702383536308, 121.580209832564 24.9701149818944, 121.580215693013 24.9699986935894, 121.580202018633 24.9698469873614, 121.580215041852 24.9697608039734, 121.580235227841 24.9696870167782, 121.580294483486 24.9695536094169, 121.580313367153 24.9694987116554, 121.580523692136 24.9693357891224, 121.580610296541 24.969217138881, 121.580649366197 24.9690306039418, 121.580622017437 24.9688045184941, 121.580567319919 24.9686681586629, 121.580548436252 24.9686049962656, 121.580555599022 24.9684143282716, 121.580646761553 24.9680571939275, 121.580689087014 24.9679473970448, 121.580784156511 24.967800410742, 121.580852528409 24.967645750266, 121.580968435056 24.9673269837861, 121.580986667562 24.9672319439906, 121.580987969884 24.9671121111004, 121.58101987677 24.9670518994564, 121.581077830093 24.9669899168509, 121.581182667004 24.966930295458, 121.581297271329 24.9669391501221, 121.581435968608 24.9669373791893, 121.581740711927 24.966899599284, 121.581837734906 24.9668535550088, 121.581934106725 24.9667827176286, 121.581997920497 24.966694170846, 121.582143129386 24.9663482474714, 121.582178292076 24.9662697357169, 121.582283128987 24.9662260524633, 121.582444616899 24.9661575759806, 121.582573546765 24.9660896897748, 121.582654941882 24.9660223938469, 121.582737639321 24.9658948856719, 121.582923220188 24.9657951222393, 121.582964894488 24.9658010254032, 121.583114010342 24.9658889825125, 121.583218196092 24.9659444722001, 121.583423962948 24.9660070456476, 121.583590660148 24.9660206229009, 121.583776241015 24.965997600601, 121.583967031169 24.9659297143069, 121.584116798185 24.9659391593588, 121.584332332455 24.9659556881978, 121.584487308758 24.966030658261, 121.584545913242 24.9660460064574, 121.585053818773 24.9660955929246, 121.585095493073 24.9661162539468, 121.585187957926 24.9661953561137, 121.585284329744 24.9662774098003, 121.585654189156 24.9663694987648, 121.585711491319 24.9663777631556, 121.585958281314 24.9663877984867, 121.586190094607 24.9663866178595, 121.586256513023 24.9664137722808, 121.586388047532 24.966482248621, 121.586580140008 24.9665843727471, 121.586703209426 24.9667106995836, 121.586744232565 24.9667596954713, 121.5867969766 24.9668883833724, 121.586851022958 24.967011758344, 121.58690116235 24.9670459963524, 121.587009906227 24.9670601638014, 121.587202649864 24.9670961727269, 121.587404509754 24.9671699614758, 121.58751976524 24.9672142347039, 121.587704694946 24.9672785784336, 121.58779748538 24.9673157679134, 121.587859671249 24.9673992966248, 121.587879857238 24.967476627042, 121.587880182819 24.9675412657885, 121.587793903994 24.9678780360603, 121.587783811 24.96798133964, 121.587795531897 24.9680397799123, 121.587857066605 24.9681212420638, 121.587998042948 24.9683057123163, 121.588051438145 24.9683960288511, 121.588050135823 24.9684220022213, 121.587965033235 24.9686067141272)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0162002000'=='0100020200' || '0162002000'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
