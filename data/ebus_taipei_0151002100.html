
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231492753</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0151002100">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0151002100">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0151002100" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0151002100" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0151002100" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0151002100',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="Gs7Qpt8bDwrH_lsbAj7PRSnhLyZLA5R_XKVXuKg62JCo4S9QowUtb8EQT-qHg4dU5azul8PgX4U9PyjBM9B5vXAtK981" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/taipei_city.svg" width="100%" class="vipstop-city" alt="臺北市">                
 <span class="stationlist-title">小21 </span>                 

                        <a href="../EBus/VsSimpleMap?routeid=0151002100" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0151002100" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">臺北市公共運輸處公車申訴服務電話02-27291181</a>                </div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">北投 - 八仙里</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 0600 - 1900 <br>
                        [假日] 0640 - 1720
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> 小21班表:0600 0830 1020 1140 1530 1700 1900<br/>小21經立農國小一班表:0700<br/>平常日0700車次返程停靠「立農國小」，不行經「八仙里」<br>
[假日]<br /> 小21班表:0640 0820 1020 1140 1540 1720<br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content">一段票</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">大南汽車秀山站:02-2893-7723</span>
                </li>

            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 八仙里</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 北投</a>
                </p>


            <p> 
<a style="color:#4CAF50; word-spacing:20px;margin-top:5px;box-shadow: 0 1px;padding-bottom:3px;" href="./StopsOfRoute?routeid=0151002102" >①經立農國小一</a> </p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">致遠新村</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125200440" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="25.143015" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.4907887" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">集應廟</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.142542" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.48985" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">大華柏園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.143659" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.488841" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">大華柏園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.14363" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.48868" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">集應廟</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.142326" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.4898605" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">稻香圖書館</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600240" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.13974" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.48958" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">復興崗</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125800140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.13807" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.4923517" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">文化國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125800040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.13669" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.4957248" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">大業中央北路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126300020" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.135605" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.498029" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">北投國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126300340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.133845" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5007209" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">北投市場(磺港)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126600040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.13244" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50318" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">福安宮</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400540" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.130648" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5046188" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">石門</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12933" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50566" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">清江國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12728" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50766" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 15</span>
                                    <span class="auto-list-stationlist-place">奇岩新村</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400240" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.125899" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5081597" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 16</span>
                                    <span class="auto-list-stationlist-place">公館華廈</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.124601" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.506468" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 17</span>
                                    <span class="auto-list-stationlist-place">奇岩一站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.1231" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50461" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 18</span>
                                    <span class="auto-list-stationlist-place">崇仁路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12247" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50284" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 19</span>
                                    <span class="auto-list-stationlist-place">捷運唭哩岸站二(西安)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1127400020" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12098" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50419" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 20</span>
                                    <span class="auto-list-stationlist-place">捷運唭哩岸站一(西安)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1127200140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.120365" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5072042" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 21</span>
                                    <span class="auto-list-stationlist-place">捷運唭哩岸站一(東華)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126500260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.120913" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50736" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 22</span>
                                    <span class="auto-list-stationlist-place">捷運唭哩岸站二(東華)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1127200260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.121347" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5052296" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 23</span>
                                    <span class="auto-list-stationlist-place">立農國小一</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500570" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.120242" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.503642" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 24</span>
                                    <span class="auto-list-stationlist-place">八仙里</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500450" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.120282" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.502062" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 25</span>
                                    <span class="auto-list-stationlist-place">下八仙土地公廟</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126200040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.115812" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.482799" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">八仙里</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500410" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.120327" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.502215" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">立農國小一</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500530" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.119973" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.503783" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">捷運唭哩岸站一(西安)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1127200140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.120365" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5072042" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">捷運唭哩岸站一(東華)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126500260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.120913" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50736" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">捷運唭哩岸站二(東華)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1127200260" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.121347" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5052296" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">崇仁路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.122376" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5029481" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">奇岩一站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12314" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50476" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">公館華廈</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.124355" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5063462" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">奇岩新村</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124500200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12566" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50829" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">清江國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12764" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5076" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">石門</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.129397" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5056715" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">福安宮</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400500" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.13111" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.504679" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">北投市場(公館路)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1124400000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.13267" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50369" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">北投國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126300300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.133615" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.50136" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 15</span>
                                    <span class="auto-list-stationlist-place">大業中央北路口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1126300060" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.135807" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.4978915" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 16</span>
                                    <span class="auto-list-stationlist-place">文化國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125800000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.1369" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.4955289" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 17</span>
                                    <span class="auto-list-stationlist-place">復興崗</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125800100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.13812" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.4926" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 18</span>
                                    <span class="auto-list-stationlist-place">稻香圖書館</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.14056" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.48966" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 19</span>
                                    <span class="auto-list-stationlist-place">集應廟</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.142542" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.48985" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 20</span>
                                    <span class="auto-list-stationlist-place">大華柏園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.143659" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.488841" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 21</span>
                                    <span class="auto-list-stationlist-place">大華柏園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.14363" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.48868" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 22</span>
                                    <span class="auto-list-stationlist-place">集應廟</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125600140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.142326" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.4898605" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 23</span>
                                    <span class="auto-list-stationlist-place">致遠新村</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1125200400" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.143004" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.490879" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0151002100";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 25;
        var existBackNum = 23;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0151002100',
                        url: './StopStatusRecent3OfRoute?routeid=0151002100&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0151002100',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0151002100',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0151002100');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0151002100","Name":"小21","BeginStop":"北投","GoDirStops":[{"UniStopId":"1125200440","Name":"致遠新村","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4907887,"Latitude":25.143015,"PublicId":"1125200440"},{"UniStopId":"1125600100","Name":"集應廟","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.48985,"Latitude":25.142542,"PublicId":"1125600100"},{"UniStopId":"1125600000","Name":"大華柏園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.488841,"Latitude":25.143659,"PublicId":"1125600000"},{"UniStopId":"1125600040","Name":"大華柏園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.48868,"Latitude":25.14363,"PublicId":"1125600040"},{"UniStopId":"1125600140","Name":"集應廟","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4898605,"Latitude":25.142326,"PublicId":"1125600140"},{"UniStopId":"1125600240","Name":"稻香圖書館","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.48958,"Latitude":25.13974,"PublicId":"1125600240"},{"UniStopId":"1125800140","Name":"復興崗","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4923517,"Latitude":25.13807,"PublicId":"1125800140"},{"UniStopId":"1125800040","Name":"文化國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4957248,"Latitude":25.13669,"PublicId":"1125800040"},{"UniStopId":"1126300020","Name":"大業中央北路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.498029,"Latitude":25.135605,"PublicId":"1126300020"},{"UniStopId":"1126300340","Name":"北投國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5007209,"Latitude":25.133845,"PublicId":"1126300340"},{"UniStopId":"1126600040","Name":"北投市場(磺港)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50318,"Latitude":25.13244,"PublicId":"1126600040"},{"UniStopId":"1124400540","Name":"福安宮","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5046188,"Latitude":25.130648,"PublicId":"1124400540"},{"UniStopId":"1124400140","Name":"石門","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50566,"Latitude":25.12933,"PublicId":"1124400140"},{"UniStopId":"1124400340","Name":"清江國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50766,"Latitude":25.12728,"PublicId":"1124400340"},{"UniStopId":"1124400240","Name":"奇岩新村","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5081597,"Latitude":25.125899,"PublicId":"1124400240"},{"UniStopId":"1124500040","Name":"公館華廈","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.506468,"Latitude":25.124601,"PublicId":"1124500040"},{"UniStopId":"1124500140","Name":"奇岩一站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50461,"Latitude":25.1231,"PublicId":"1124500140"},{"UniStopId":"1124500340","Name":"崇仁路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50284,"Latitude":25.12247,"PublicId":"1124500340"},{"UniStopId":"1127400020","Name":"捷運唭哩岸站二(西安)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50419,"Latitude":25.12098,"PublicId":"1127400020"},{"UniStopId":"1127200140","Name":"捷運唭哩岸站一(西安)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5072042,"Latitude":25.120365,"PublicId":"1127200140"},{"UniStopId":"1126500260","Name":"捷運唭哩岸站一(東華)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50736,"Latitude":25.120913,"PublicId":"1126500260"},{"UniStopId":"1127200260","Name":"捷運唭哩岸站二(東華)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5052296,"Latitude":25.121347,"PublicId":"1127200260"},{"UniStopId":"1124500570","Name":"立農國小一","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.503642,"Latitude":25.120242,"PublicId":"1124500570"},{"UniStopId":"1124500450","Name":"八仙里","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.502062,"Latitude":25.120282,"PublicId":"1124500450"},{"UniStopId":"1126200040","Name":"下八仙土地公廟","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.482799,"Latitude":25.115812,"PublicId":"1126200040"}],"LastStop":"八仙里","BackDirStops":[{"UniStopId":"1124500410","Name":"八仙里","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.502215,"Latitude":25.120327,"PublicId":"1124500410"},{"UniStopId":"1124500530","Name":"立農國小一","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.503783,"Latitude":25.119973,"PublicId":"1124500530"},{"UniStopId":"1127200140","Name":"捷運唭哩岸站一(西安)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5072042,"Latitude":25.120365,"PublicId":"1127200140"},{"UniStopId":"1126500260","Name":"捷運唭哩岸站一(東華)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50736,"Latitude":25.120913,"PublicId":"1126500260"},{"UniStopId":"1127200260","Name":"捷運唭哩岸站二(東華)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5052296,"Latitude":25.121347,"PublicId":"1127200260"},{"UniStopId":"1124500300","Name":"崇仁路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5029481,"Latitude":25.122376,"PublicId":"1124500300"},{"UniStopId":"1124500100","Name":"奇岩一站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50476,"Latitude":25.12314,"PublicId":"1124500100"},{"UniStopId":"1124500000","Name":"公館華廈","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5063462,"Latitude":25.124355,"PublicId":"1124500000"},{"UniStopId":"1124500200","Name":"奇岩新村","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50829,"Latitude":25.12566,"PublicId":"1124500200"},{"UniStopId":"1124400300","Name":"清江國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5076,"Latitude":25.12764,"PublicId":"1124400300"},{"UniStopId":"1124400100","Name":"石門","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5056715,"Latitude":25.129397,"PublicId":"1124400100"},{"UniStopId":"1124400500","Name":"福安宮","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.504679,"Latitude":25.13111,"PublicId":"1124400500"},{"UniStopId":"1124400000","Name":"北投市場(公館路)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50369,"Latitude":25.13267,"PublicId":"1124400000"},{"UniStopId":"1126300300","Name":"北投國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.50136,"Latitude":25.133615,"PublicId":"1126300300"},{"UniStopId":"1126300060","Name":"大業中央北路口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4978915,"Latitude":25.135807,"PublicId":"1126300060"},{"UniStopId":"1125800000","Name":"文化國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4955289,"Latitude":25.1369,"PublicId":"1125800000"},{"UniStopId":"1125800100","Name":"復興崗","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4926,"Latitude":25.13812,"PublicId":"1125800100"},{"UniStopId":"1125600200","Name":"稻香圖書館","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.48966,"Latitude":25.14056,"PublicId":"1125600200"},{"UniStopId":"1125600100","Name":"集應廟","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.48985,"Latitude":25.142542,"PublicId":"1125600100"},{"UniStopId":"1125600000","Name":"大華柏園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.488841,"Latitude":25.143659,"PublicId":"1125600000"},{"UniStopId":"1125600040","Name":"大華柏園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.48868,"Latitude":25.14363,"PublicId":"1125600040"},{"UniStopId":"1125600140","Name":"集應廟","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.4898605,"Latitude":25.142326,"PublicId":"1125600140"},{"UniStopId":"1125200400","Name":"致遠新村","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.490879,"Latitude":25.143004,"PublicId":"1125200400"}],"RouteMapUrl":"../MapOverview?nid=0151002100","RouteTracks":null,"StopDirection":null,"TicketPrice":"一段票","BusTimeDesc":"0600 - 1900","HeadwayDesc":"小21班表:0600 0830 1020 1140 1530 1700 1900;小21經立農國小一班表:0700;平常日0700車次返程停靠「立農國小」，不行經「八仙里」","HolidayBusTimeDesc":"0640 - 1720","HolidayHeadwayDesc":"小21班表:0640 0820 1020 1140 1540 1720","RouteNote":"","SegmentBuffer":"","StopLng":0,"StopLat":0,"IsNtpcMainLine":false,"orgphone":"大南汽車秀山站:02-2893-7723","aliasName":null,"aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":"LINESTRING (121.492860505538 25.1453163343038, 121.492805488578 25.1453438525463, 121.492600874203 25.1451561893969, 121.49225768249 25.1447963469177, 121.492033921414 25.1445910050302, 121.491814908985 25.1444169054305, 121.491658096751 25.1443070280418, 121.491352293883 25.1441646550864, 121.491242577056 25.1440835054601, 121.49102092486 25.1437001582833, 121.490837774188 25.1432913104713, 121.490775365584 25.1426777023317, 121.490697538749 25.1424692993523, 121.490576360831 25.1423011503432, 121.490465563799 25.1421904515142, 121.490290125431 25.1420907702914, 121.490256406057 25.1422248772077, 121.490200336903 25.1423500135352, 121.490066534035 25.1424586215291, 121.489868513517 25.1424727419138, 121.489690774188 25.1424806553712, 121.489294213324 25.1426258116725, 121.488967605736 25.142800787237, 121.488936810847 25.1429512570758, 121.488966468882 25.1433123505114, 121.489079865716 25.1434599019343, 121.489112638047 25.1435813448187, 121.489110308331 25.1436747734979, 121.489044135531 25.1438251226455, 121.488738792159 25.1441895509898, 121.488698219553 25.1440352550626, 121.488645569977 25.143916937005, 121.488439215103 25.1440550803146, 121.488260129062 25.1441406030522, 121.488121197132 25.1441165227833, 121.488141562715 25.1440611149706, 121.488281831548 25.1440712125855, 121.488440311854 25.1439771496305, 121.488640820839 25.1438518739701, 121.488846071701 25.1435800344666, 121.488906648757 25.1433128850768, 121.488879767826 25.1429925676493, 121.488889562715 25.1428021148932, 121.489191603005 25.1425932315193, 121.489613534035 25.1424333446229, 121.489854404973 25.1423993277037, 121.490044308223 25.1423830979538, 121.490166086041 25.1422426952424, 121.490222625685 25.1420931317789, 121.490267154597 25.1419354276651, 121.490120691777 25.1416703089252, 121.49001397495 25.1415288333499, 121.489892523326 25.141380440909, 121.489759057361 25.1412531465305, 121.48960897132 25.1411007538185, 121.489574850266 25.1408573932111, 121.489562802049 25.1406040558185, 121.489520956979 25.140285229725, 121.489536351243 25.1401198362608, 121.489584365584 25.1399564426329, 121.489641182792 25.1398466883757, 121.48971343347 25.1397080070059, 121.489875139588 25.139540088135, 121.490118508802 25.1393839397297, 121.490351863676 25.1392395617381, 121.490748939008 25.138993789102, 121.491081759847 25.1387950986626, 121.491224831548 25.1386886879843, 121.491280096751 25.1385844107791, 121.49138307878 25.1384954618483, 121.491579559085 25.1384270351631, 121.491982591396 25.1382548853619, 121.492781644943 25.1379378786109, 121.494155802868 25.1373966875425, 121.494458982029 25.1372907240043, 121.494762193501 25.1371459532683, 121.495303182792 25.1368840155283, 121.497045197132 25.1361071145179, 121.49724898566 25.1360036717679, 121.497613989107 25.135839832619, 121.49825102505 25.1355415117244, 121.498545394264 25.1354025572387, 121.498829419313 25.1352270239786, 121.499116 25.1350370994031, 121.499499 25.1347907561331, 121.49957297132 25.1347422984071, 121.50064602868 25.1340237712016, 121.501473634417 25.133453686214, 121.501493168452 25.1333512140952, 121.501517774188 25.1331671727433, 121.501697480305 25.1332834282194, 121.50191102868 25.1334735425133, 121.502578250862 25.1330795987974, 121.50276597132 25.1329768566129, 121.502882817208 25.1328653284998, 121.50307008241 25.1326651844108, 121.503250408604 25.1323800855574, 121.503373534035 25.1320459149231, 121.503504422944 25.1316027572986, 121.503682605736 25.1308977995761, 121.504149021419 25.1309744428782, 121.504384996369 25.1310440581273, 121.504615168452 25.1311086733154, 121.50461997132 25.1309602726647, 121.504623774188 25.130746456856, 121.504670928299 25.1304395154665, 121.50475797132 25.1302915571369, 121.504904928299 25.1300424015841, 121.50505901434 25.1298171416457, 121.505220874569 25.1295820821771, 121.505440806499 25.1294207942532, 121.505763612998 25.1292655061435, 121.50625074569 25.1290314731815, 121.506830752952 25.1287188089716, 121.506960308223 25.1286499731509, 121.507078334574 25.1285252970327, 121.507279929347 25.1281792216901, 121.507514281612 25.1275572154447, 121.507762421739 25.1269016200979, 121.508275139771 25.1256979746828, 121.507328164821 25.1250354932161, 121.506411291721 25.124536992488, 121.505603193779 25.1240710880226, 121.505033336903 25.1235882397798, 121.504832799255 25.1232548494066, 121.504625154111 25.1230494191022, 121.50445251245 25.1229828439182, 121.504222778002 25.1229414493526, 121.503829111274 25.1228759044714, 121.503293132693 25.1228363476795, 121.503086595027 25.1227682459493, 121.502904268833 25.1227129166861, 121.502878254493 25.1226541442954, 121.502759 25.121927, 121.502709096751 25.1215007493947, 121.502782085858 25.1214352023243, 121.503045820656 25.12133056659, 121.503604982029 25.121106976974, 121.503937774188 25.121022670501, 121.504552942639 25.1209286704937, 121.506231494462 25.1206211590277, 121.50801378508 25.1202948294084, 121.508092587948 25.1207107838935, 121.50639258983 25.1210235952505, 121.504905060943 25.1212973108064, 121.504825953774 25.1209073909365, 121.504738012815 25.1208454491027, 121.503836367245 25.1200456259957, 121.503724234509 25.1200990975805, 121.503143879552 25.1205148235015, 121.502478617756 25.1208578767475, 121.502163077216 25.1203506190143, 121.501571225833 25.1195792901547, 121.501414020886 25.1194536038676, 121.500649516247 25.1201556361302, 121.500622802868 25.1200232890903, 121.500653240153 25.1196799470461, 121.500643254493 25.1194281276023, 121.500592240153 25.1192054101366, 121.50045194627 25.1188913123013, 121.500298845889 25.1185632971283, 121.500203032219 25.1183345512884, 121.50018276233 25.1181723611467, 121.500332425053 25.1176702696773, 121.500410063724 25.1173084647807, 121.500318303123 25.1161375627688, 121.500300052054 25.1158141199149, 121.500300422944 25.1154306397483, 121.500137447489 25.1152889622552, 121.499864989227 25.1151308766029, 121.499392139771 25.1148801233222, 121.499205109701 25.1148771863597, 121.498653858172 25.115025552398, 121.498143548375 25.1150954333458, 121.497782281908 25.1151081947024, 121.497328577056 25.1150943300002, 121.496948457724 25.115053560707, 121.496450365583 25.1148712465512, 121.496297218734 25.1149279265612, 121.495808593395 25.1150221113435, 121.494361835363 25.1154192552897, 121.493023480305 25.1158036904335, 121.492344774371 25.1159365458034, 121.491735233074 25.1160612986885, 121.490957365584 25.1162813505264, 121.490196408604 25.116462134122, 121.490028075714 25.1165384288882, 121.489975066631 25.1167623471116, 121.486563939553 25.1165148207937, 121.48506396061 25.1164257731859, 121.484274591445 25.1164529003458, 121.483852376277 25.1164063244069, 121.483323777619 25.1163546749485, 121.482748154111 25.1163413505418, 121.482749225812 25.1158787002349, 121.482892139771 25.1151933833415, 121.482989910328 25.1150083300085, 121.483444939008 25.1150450634982, 121.483655265202 25.1149586500762, 121.48392533968 25.1150198129798, 121.483901683313 25.1149691967756, 121.483658292005 25.1149187524611, 121.4834417015 25.1150118755336, 121.482955704934 25.1149546345923, 121.482865020012 25.1151720618728, 121.482705981018 25.115874496841, 121.482693793191 25.1163505147043, 121.483344143054 25.1163931944023, 121.483863784881 25.1164407573691, 121.484267508689 25.1164793308332, 121.485065491182 25.1164614171471, 121.486557821966 25.1165580860002, 121.490019754392 25.1167953204561, 121.490062459787 25.1165716025319, 121.490158203198 25.1165213871175, 121.490966715784 25.116312296317, 121.491728115988 25.1161067572493, 121.492350244591 25.1159620164101, 121.493050106618 25.1158340259987, 121.494370335807 25.1154504277981, 121.495818490773 25.1150569780891, 121.496299534088 25.1149565366599, 121.496458192986 25.1148955962557, 121.496958436998 25.1150889831447, 121.497338466048 25.1151356679679, 121.497789377671 25.1151513224228, 121.49813951793 25.1151332566822, 121.498645532953 25.1150634313657, 121.49920441438 25.1149168754338, 121.499405349416 25.1149214134259, 121.499858647858 25.1151736180165, 121.500101341925 25.1153112157133, 121.500267092777 25.1154454046052, 121.500255616573 25.116151696326, 121.500365962577 25.117305100658, 121.500286332746 25.1176600875062, 121.500132454357 25.1181692795402, 121.500151468697 25.118334555279, 121.50024632059 25.1185931435077, 121.500413263217 25.118913613546, 121.500552428464 25.1192154250152, 121.500607022464 25.1194270132153, 121.500623024334 25.1196739691773, 121.500599058218 25.120032310975, 121.500626163084 25.1201681221982, 121.499820619178 25.1209341755322, 121.499923649241 25.1210639279609, 121.500637941758 25.120415381337, 121.501530820656 25.1196113605784, 121.502133856598 25.1203837614523, 121.50245898566 25.1209156360955, 121.503168487567 25.1205567732573, 121.503749802868 25.120141988725, 121.503838422944 25.1201, 121.50468897132 25.1208805568293, 121.504788702487 25.1209250477634, 121.504876408604 25.1213024663167, 121.50411798566 25.1214405800755, 121.50348316119 25.1216198513793, 121.50311093193 25.1217613879763, 121.502808928299 25.121923, 121.502891 25.122493921899, 121.502925225812 25.1226633055457, 121.503097354874 25.1227135092157, 121.503298104012 25.1227707128751, 121.503840165004 25.1228160779364, 121.504230205446 25.1228784989208, 121.504503066347 25.1229415127318, 121.504653591396 25.1230230000069, 121.504889424455 25.1232327423101, 121.505059605736 25.1235393779019, 121.505641197728 25.1240353188354, 121.506443625783 25.1245003968395, 121.507326927024 25.1249917714542, 121.508342422944 25.1256697721824, 121.507818050666 25.1269251427308, 121.507563798298 25.1275810712465, 121.507321101158 25.1281893264681, 121.50713775085 25.1285485911894, 121.507013548375 25.1286871878832, 121.50685972792 25.1287705768885, 121.506272978355 25.1290686218983, 121.505804712911 25.1292930763164, 121.505478473447 25.1294580689884, 121.505280058507 25.1295991560782, 121.505100924478 25.1298391700166, 121.504951204198 25.1300781530205, 121.504807788528 25.1303070726279, 121.504730154111 25.1304574738742, 121.504694225812 25.1306093147878, 121.504689634416 25.1307549441916, 121.504676451625 25.1309656132704, 121.504659043021 25.1311565571191, 121.504546272464 25.1313424412455, 121.504235071701 25.1317240711572, 121.504023437285 25.1319926143455, 121.50394 25.1321195857927, 121.503877874569 25.1324671719948, 121.503683351243 25.1326629855522, 121.503474806499 25.1328116442585, 121.503217437285 25.13296835756, 121.503061365584 25.1330556715184, 121.502025577056 25.133626214059, 121.501874774188 25.1334950440238, 121.501782125431 25.1334545014896, 121.501629240153 25.133468472141, 121.501503379924 25.1334880293419, 121.500677168452 25.1340552436186, 121.499607745507 25.1347905572213, 121.499539817208 25.1348377017009, 121.499144351243 25.1350855723015, 121.498856326194 25.1352793046405, 121.498565548375 25.1354445724013, 121.498274820839 25.1355935493192, 121.497650774188 25.1358882442861, 121.497269379924 25.1360593588688, 121.497085591396 25.1361440306889, 121.495336365584 25.1369294582586, 121.494825250862 25.1371844115254, 121.494417809947 25.1373710052423, 121.494116451625 25.1374621616478, 121.492831136324 25.1379767316436, 121.492008168452 25.1383008024976, 121.491621788528 25.138479245241, 121.491465860229 25.1385346052009, 121.49135301434 25.1385641625524, 121.491308016843 25.1386906080264, 121.491249211472 25.1387607706661, 121.491126 25.138836, 121.490773279542 25.1390401811747, 121.490397247231 25.1392828551189, 121.490165723905 25.1394198065474, 121.489926791976 25.1395764137408, 121.489791311854 25.1397166712669, 121.489715480305 25.1398470814898, 121.489647648757 25.1399819342304, 121.489590422944 25.140134, 121.489588634416 25.1402939508664, 121.489627465965 25.1405906062452, 121.489644774188 25.1408530343393, 121.48967197132 25.1411063610011, 121.489806845889 25.1412200981828, 121.489960168452 25.1413686074407, 121.490075620076 25.141496787054, 121.490160620076 25.1416115574138, 121.490274480305 25.1418007033179, 121.490327197132 25.141930918796, 121.490302655835 25.1420440066824, 121.490498573425 25.1421392198127, 121.490630265202 25.14227207144, 121.490737731167 25.1424323484841, 121.490827788528 25.1426590339953, 121.490901225812 25.1432709828573, 121.491074404921 25.1436549085199, 121.491277164142 25.1440298374379, 121.491379327107 25.1441071815019, 121.491692060369 25.1442608755547, 121.491866218081 25.144368525659, 121.492064781427 25.144528096243, 121.492300447628 25.1447396478563, 121.492600874203 25.1450770121844, 121.492848308406 25.1453048116294)","wkt0":"LINESTRING (121.490796861299 25.1430155764504, 121.490778401392 25.1426329386141, 121.49072893943 25.1424629430535, 121.490599835325 25.1422679032125, 121.490449772761 25.1421457185619, 121.490399472461 25.1421161210195, 121.490317963077 25.1421130881398, 121.490295518506 25.1421259868677, 121.490244983408 25.142294278591, 121.490145238987 25.1424062433202, 121.489981658137 25.142458613884, 121.489838691133 25.1424544001613, 121.489714343088 25.142467041329, 121.489509534543 25.1425284412675, 121.489236234829 25.1426626782806, 121.48903275621 25.1427818661774, 121.488980224148 25.1428300228704, 121.488939661417 25.1429642595518, 121.488976234371 25.143223703123, 121.488960940227 25.1433176083169, 121.488900428611 25.1435066223982, 121.488738842649 25.1437588413695, 121.488599200459 25.1438834457763, 121.488484161893 25.1439779524155, 121.488329225559 25.1440556043127, 121.488250094985 25.1440911195051, 121.488173624262 25.1441001487896, 121.488145695824 25.1440820902199, 121.48815168049 25.1440429633096, 121.488192908184 25.1440279144946, 121.488276693497 25.1440176812993, 121.488407691171 25.1439580879688, 121.488616489492 25.1437961625095, 121.488731528058 25.1436793834205, 121.488893778983 25.1433308513512, 121.488899763648 25.1432399559502, 121.488883804541 25.1429516184356, 121.488893778983 25.1428089543195, 121.488966259929 25.1427373212195, 121.489234904903 25.1426054921271, 121.489380531758 25.1425266353874, 121.489629892811 25.1424393511505, 121.489828051728 25.142403233517, 121.490036185087 25.1423869805784, 121.490135264545 25.1423484550857, 121.490182476905 25.1422840452505, 121.490209075417 25.1421955569167, 121.490243653483 25.1420221918321, 121.490237668818 25.1418199322555, 121.490193781272 25.1416868982442, 121.490050149306 25.1415195520874, 121.489940430442 25.141399159027, 121.489676440208 25.1411397115781, 121.489617258518 25.1410566401207, 121.489592654894 25.1410229299479, 121.489578025712 25.1407791328856, 121.489567386307 25.1405305195775, 121.489545442535 25.1402307382082, 121.489564061493 25.1400856630242, 121.489635877477 25.1398827982663, 121.489714343088 25.1397371206951, 121.489793473662 25.1396377949787, 121.489931785926 25.139499340815, 121.490067438339 25.1393970050279, 121.490514958308 25.1391267177423, 121.491174601414 25.1387191787663, 121.491203859777 25.1386656026402, 121.49122580355 25.1385873453352, 121.491271021021 25.1384982523422, 121.491360791 25.1384549097816, 121.491860843031 25.1382556542007, 121.492496547476 25.1380154635064, 121.494142995388 25.1373936142255, 121.494780029757 25.1371227205185, 121.495847960027 25.136615846679, 121.49702095442 25.1360824830987, 121.497467809426 25.1359271691126, 121.498229856804 25.1355804208957, 121.498894819612 25.1352083878599, 121.499409500825 25.1348664535846, 121.499741982229 25.1346280622207, 121.500470781466 25.1341235860322, 121.501423008207 25.1334987069096, 121.501470885529 25.1334228543129, 121.501501473818 25.1332940251915, 121.501563980322 25.1332097443844, 121.50166771452 25.1332482727606, 121.501814006338 25.1333746939096, 121.501908431057 25.1333987741136, 121.502006845552 25.1333722858889, 121.502570734013 25.1330628548387, 121.502850018393 25.1328581723902, 121.503033548127 25.132667937807, 121.503195799053 25.1324042577365, 121.503278254441 25.132260979286, 121.503360709829 25.1320827840037, 121.503415236779 25.1318178986442, 121.503518970977 25.1313988969934, 121.50361206577 25.1310412996201, 121.503653293464 25.1309365486761, 121.503746388257 25.1308980195707, 121.503916618736 25.1309184881595, 121.504436619652 25.1310304633197, 121.50461150487 25.1310208310519, 121.504636773457 25.1309925362608, 121.504636108494 25.1306698547753, 121.504679331077 25.1304585461018, 121.504715239068 25.130383293637, 121.504922042502 25.1300383357446, 121.505082298538 25.12977525202, 121.505239229761 25.1295862166828, 121.505293091748 25.1295115657047, 121.505491915628 25.1293833344826, 121.506189461613 25.1290498122698, 121.506567825451 25.1288818467673, 121.506767314293 25.1287861243884, 121.50700337609 25.1286320051805, 121.507162967164 25.1284574167803, 121.507221483891 25.1283532656504, 121.507386394667 25.12791498709, 121.507478824497 25.1276705618252, 121.507558620034 25.1274893496753, 121.507636420683 25.1272900762034, 121.507761433691 25.1269475177232, 121.507911715285 25.1265935195499, 121.508055347252 25.1262611938007, 121.508227572619 25.1258584282298, 121.50827279009 25.1257223666158, 121.50826813535 25.1256591520976, 121.507923019653 25.1254309775168, 121.507613146985 25.1252124352365, 121.507119744581 25.1249204428745, 121.506683528979 25.1246748075223, 121.506316469509 25.1244695089691, 121.506014576395 25.1243039453685, 121.505693399359 25.124107676955, 121.505360917955 25.1238536112399, 121.505212631248 25.1237163432877, 121.50509227298 25.123595330623, 121.504954625679 25.1234062857228, 121.504858871035 25.1232750378176, 121.504759791576 25.1231534226603, 121.50461615961 25.1230414402797, 121.504477182383 25.1229752140923, 121.504182603859 25.1229107940392, 121.503711810191 25.1228337307536, 121.50336802442 25.1228180772677, 121.503278919403 25.1228042299517, 121.503086080189 25.1227470344991, 121.502927154078 25.1226946554822, 121.502857997946 25.1226224085256, 121.502812115512 25.1223605129495, 121.502774877595 25.1221064436013, 121.50274295938 25.1219468974136, 121.502715030942 25.1217331654018, 121.502701066724 25.1215856599924, 121.502694417095 25.1215188309524, 121.502732319975 25.1214580225149, 121.502852678244 25.1214074491379, 121.503306847841 25.1212021450948, 121.503651298576 25.1210889567946, 121.503866081563 25.1210389853307, 121.504203217706 25.1209811869857, 121.504678666114 25.1209029183498, 121.505245214426 25.1207933421754, 121.505991302696 25.12066028526, 121.506629002029 25.1205380654319, 121.507216164188 25.1204296930682, 121.507742814732 25.1203273413031, 121.508389823544 25.1202105397724, 121.50971043968 25.1199673032366, 121.510327525166 25.1198450827154, 121.510695249598 25.1197589864127, 121.511078268176 25.1196132848393, 121.511362872257 25.11944952088, 121.511485890377 25.1194453063634, 121.511551721695 25.1195139427578, 121.51167606974 25.1197023916073, 121.511694023736 25.1197650071351, 121.51165013619 25.1198216019116, 121.511061644105 25.1200925339888, 121.510681285379 25.1202237853124, 121.510028291902 25.1203586489109, 121.509086704566 25.1205248199259, 121.508480258486 25.1206392128846, 121.507345831936 25.120847528208, 121.505776519709 25.1211353158451, 121.504985213968 25.1212786073447, 121.504908078282 25.1212719846321, 121.504868180514 25.1211925120521, 121.504816978378 25.1209486754045, 121.504653397527 25.1208210372617, 121.504259739545 25.1204501634109, 121.503959176356 25.120180436267, 121.50383948305 25.120114208529, 121.503776976546 25.1201256478681, 121.503334776279 25.1204381220332, 121.502844033727 25.1207313292419, 121.502583368306 25.1208493344086, 121.502488943588 25.1208734170817, 121.50238520939 25.1208300682667, 121.502085976126 25.1203688840887, 121.501946333937 25.1201653845115, 121.501625821863 25.1197330973028, 121.501584594169 25.1196692776132, 121.501519427814 25.1196668693224, 121.501007406452 25.1201087898943, 121.500588479883 25.1204832771933, 121.500482085834 25.1205784040093, 121.500270960142 25.1207698615537, 121.499909885338 25.1210407915285, 121.499683465502 25.1211663222132, 121.499572749194 25.1211753531928, 121.499444078891 25.1211301982884, 121.499447569946 25.121041243078, 121.499487966436 25.1210001520706, 121.499822110247 25.1209175184645, 121.499887941565 25.1208570107612, 121.500248018925 25.1205337004357, 121.500481420871 25.1203025059354, 121.500591139734 25.1201941333628, 121.500607098842 25.1201074352355, 121.500637022168 25.1199096549025, 121.500652981275 25.1197489017019, 121.500663953162 25.1195131901659, 121.500652981275 25.1193492755539, 121.500619566894 25.1192174212161, 121.500534784136 25.1190747293751, 121.500458978376 25.1189148781909, 121.500385666227 25.118786184289, 121.500322328519 25.1185956267537, 121.500229566208 25.1183608161119, 121.500194156938 25.1182321216265, 121.500200141603 25.118141809626, 121.500255001035 25.11793815582, 121.500325320852 25.1176636064711, 121.500389157281 25.1174107315252, 121.500408108721 25.1173375783183, 121.50037220073 25.1168941425095, 121.500297392414 25.1162312436159, 121.5003083643 25.1157137464765, 121.500323325963 25.1154337732889, 121.500295397526 25.1153822942781, 121.500178696553 25.1153028178681, 121.49986549907 25.1151221894712, 121.499811637083 25.1150463254649, 121.499385728405 25.1148837595786, 121.499226137331 25.1148747281341, 121.499097467027 25.114897306744, 121.498860075305 25.1149858148547, 121.498307491212 25.1150707103292, 121.498054140382 25.1151077391879, 121.497137489151 25.115082451188, 121.496901094873 25.1150409066055, 121.496543012401 25.1148955004554, 121.496474687473 25.114884662723, 121.49638392005 25.1149036287541, 121.495898164718 25.1149966525781, 121.495712640095 25.115027359456, 121.495233866874 25.1151682497377, 121.494859825294 25.1152847550404, 121.494410975399 25.1154157104805, 121.49396362167 25.1155322155473, 121.493661396074 25.1156225294761, 121.493120781311 25.1157878037931, 121.492896855086 25.1158406373391, 121.492699361132 25.115877214396, 121.492309859167 25.1159499169088, 121.491980203855 25.1160167489941, 121.491586213391 25.1161151907831, 121.491339844671 25.116196021367, 121.491010189359 25.1163003333823, 121.490822669847 25.116338716569, 121.490661582607 25.1163847763771, 121.490149893727 25.1165048930499, 121.490080072632 25.116519343168, 121.490028205533 25.116559984116, 121.49000626176 25.1166457816286, 121.490008256649 25.1167252571654, 121.489966363992 25.1167478354334, 121.489863627238 25.1167595761312, 121.48917738562 25.116706291417, 121.48842431524 25.1166584254674, 121.487559531109 25.1165988187871, 121.487210425635 25.1165825624146, 121.485933697044 25.1164922491952, 121.485593568568 25.1164714771453, 121.485200575548 25.1164371580986, 121.484998094373 25.1164371580986, 121.484731776769 25.1164308361678, 121.484416584398 25.1164561238887, 121.484235049552 25.1164488988261, 121.483683961625 25.1163856795104, 121.48353135266 25.1163703262431, 121.48319272035 25.1163563276741, 121.482819177493 25.1163351040343, 121.482773295059 25.1163265242639, 121.482747860232 25.1162678205559, 121.482744867899 25.116197376069, 121.482751850009 25.116030296034, 121.482763819339 25.1156798787863, 121.482785763112 25.1156189169203, 121.482862067594 25.1154473203934, 121.482883013923 25.1153249448283, 121.4828966041 25.1151736685915, 121.482925529982 25.1150336814593, 121.482961437974 25.114984911711, 121.482995226396 25.1149749771303, 121.48302215739 25.114884662723, 121.483043602441 25.1147631897399, 121.483040610108 25.1146778424788, 121.483018666335 25.1146399103437, 121.483020162502 25.1146164285398, 121.483055571771 25.1145852699855, 121.483140354529 25.1145581755839, 121.483178631451 25.1145586271573)","wkt1":"LINESTRING (121.483178631451 25.1145586271573, 121.483228628342 25.114587527852, 121.483259549112 25.1146665531541, 121.483341464218 25.1148476337967, 121.483398817261 25.1149379482314, 121.483383855597 25.1149523985347, 121.483341464218 25.1149596236858, 121.483165914037 25.1149654941207, 121.483094596776 25.1149587205419, 121.4830387399 25.1149429155233, 121.482971911138 25.1149474312431, 121.482924033816 25.1149808475645, 121.482909570875 25.1150223921674, 121.482861693553 25.1151682497377, 121.482851220388 25.1153113977103, 121.482833765115 25.115431515438, 121.482748982357 25.1156378828374, 121.482732524527 25.1157738051575, 121.482723048807 25.1161833774803, 121.482717562864 25.1163260726971, 121.482748483634 25.1163468447717, 121.482835261281 25.1163698746764, 121.483251694239 25.116376648177, 121.483541950505 25.1163929045768, 121.483932948636 25.1164362549657, 121.484379304921 25.116475089676, 121.484599241369 25.1164651552164, 121.484795737879 25.1164488988262, 121.485161301183 25.1164579301544, 121.485638578238 25.1164886366651, 121.486177696834 25.1165333417184, 121.486936751879 25.116580756151, 121.48768284015 25.1166277189994, 121.488432918197 25.1166778427889, 121.489274761112 25.1167297728194, 121.489842306868 25.1167744777845, 121.490012869828 25.1167839606537, 121.490057256096 25.1167446744762, 121.490051770152 25.1166263643021, 121.49005127143 25.1165757889256, 121.490090670477 25.1165432761724, 121.490153509462 25.1165202463004, 121.490498126437 25.1164493503926, 121.490750978545 25.1163807122771, 121.491034252701 25.1163107194223, 121.491240224931 25.1162497578709, 121.491485596207 25.1161729914295, 121.491771862696 25.1160894514239, 121.49204516241 25.1160235225143, 121.492431173319 25.1159467559309, 121.492946353255 25.1158501202809, 121.493107440495 25.115811285372, 121.49339270954 25.1157245841355, 121.493719372519 25.1156220779067, 121.493965741239 25.1155529877569, 121.494168721136 25.1155006056565, 121.494567698821 25.1153990023805, 121.495056945207 25.1152499840896, 121.49549831427 25.1151172221865, 121.495688826115 25.1150576147545, 121.496028455869 25.114998910437, 121.496369083067 25.1149225947822, 121.496464338989 25.1149027256098, 121.496522689476 25.1149104023359, 121.496728162983 25.1149930400037, 121.496917677384 25.1150598726123, 121.497088739066 25.1151014171884, 121.49737400811 25.1151244473278, 121.497837320947 25.1151271567557, 121.498057756118 25.1151258020417, 121.498471196743 25.1150774839017, 121.498783895504 25.1150232953108, 121.498956952074 25.1149745255584, 121.499079637713 25.1149280136468, 121.499210801626 25.1148991130326, 121.499370891422 25.114903628754, 121.499502055336 25.1149483343871, 121.499631723084 25.1150083934441, 121.499919485739 25.1151953440041, 121.500173335291 25.1153267511106, 121.50026559888 25.1154170651913, 121.500286046487 25.1154644800569, 121.500270087379 25.1158465077317, 121.500264102714 25.1162389202585, 121.500320957034 25.1167144195953, 121.500376315188 25.1173493189594, 121.500272082268 25.117795010924, 121.500207747116 25.1180275648499, 121.500155880017 25.1181833531547, 121.500154383851 25.1182483777796, 121.500202261173 25.1183721050955, 121.500334422531 25.1187134834635, 121.500419205289 25.1189022345856, 121.500586277194 25.1192056807546, 121.500617197965 25.1193303102128, 121.500625177519 25.1195172541619, 121.500610215855 25.1197665123158, 121.500582287417 25.1199823550166, 121.500645126403 25.1200437662593, 121.500735893826 25.1200555066404, 121.500803720032 25.1200067388961, 121.501239603153 25.1196147900218, 121.501417148223 25.1194594550971, 121.501997660754 25.1189202968787, 121.50254625507 25.1184380327382, 121.50338211332 25.1176812173854, 121.503530753287 25.1175520518069, 121.503654436369 25.1175424184764, 121.503718272799 25.1175857684576, 121.503661085998 25.1176953475081, 121.502718168736 25.1185629452035, 121.502692900151 25.1186773399981, 121.502767588516 25.1188699443264, 121.502998450559 25.119397121635, 121.503160369003 25.1196081484043, 121.503316635263 25.1197406043929, 121.503723592501 25.1199970869445, 121.503855255129 25.1200831830749, 121.503722470376 25.1199984792339, 121.503313310449 25.1197448188993, 121.503148399672 25.1196135670612, 121.502984818822 25.1193992288941, 121.502766711021 25.1188706067515, 121.502692900149 25.1186773399987, 121.502714178959 25.1185623431254, 121.503652441481 25.1176899287662, 121.503710958208 25.1175887788724, 121.503653771406 25.1175508476406, 121.503532748175 25.117557470555, 121.503385126432 25.1176851121065, 121.502546255073 25.1184380327398, 121.501999233657 25.1189225521811, 121.501418192407 25.1194594330154, 121.501498938648 25.1194897092985, 121.501593197126 25.1195285430386, 121.501668504164 25.119652720613, 121.501986688867 25.1200880184592, 121.50247743142 25.1208105010884, 121.502548249959 25.120825853798, 121.502683902371 25.1207653460493, 121.503079887723 25.1205522140391, 121.503412036646 25.1203481126978, 121.503748175345 25.1200961464125, 121.503855255137 25.1200831830795, 121.503926406158 25.1201187052433, 121.504113260707 25.1202716310512, 121.50439644496 25.1205382422241, 121.504736256186 25.1208531377167, 121.504798765492 25.1208693942497, 121.505246305522 25.1207875094687, 121.505993757222 25.1206520382032, 121.506630820148 25.1205286086972, 121.507219338613 25.1204214356592, 121.50773736786 25.1203232939745, 121.508387065646 25.1202016704277, 121.509696436106 25.1199602292657, 121.51032817909 25.1198277675777, 121.510691265059 25.1197470862973, 121.51107297082 25.1195965613781, 121.511345617792 25.1194376068622, 121.511488591205 25.1194388110639, 121.511560410407 25.1195122673424, 121.511681106567 25.1197013267415, 121.511698728871 25.1197639450767, 121.511652179388 25.1198244560336, 121.511068980864 25.1200963033957, 121.510691930051 25.1202299689865, 121.510030262399 25.1203672470087, 121.509085972885 25.1205298128881, 121.508475509664 25.1206490277289, 121.507347017195 25.1208567502797, 121.505786279526 25.1211445507956, 121.504994938314 25.1212878487076, 121.504560033143 25.12136371224, 121.503899030483 25.1214949680818, 121.503469445254 25.121621407062, 121.503059809803 25.12178637963, 121.502890236686 25.1218634470307, 121.502852997099 25.1218815096958, 121.50283038735 25.1219254621695, 121.502836372284 25.1219922939827, 121.502913511427 25.1225143033746, 121.502954740969 25.1226220766621, 121.503089069478 25.1227087768915, 121.503269947469 25.1227641686725, 121.503391641118 25.122775006192, 121.503677587942 25.1227924666379, 121.503942919996 25.1228279896065, 121.504293371104 25.1228924125909, 121.504516143631 25.1229490084558, 121.504687711725 25.1230381167856, 121.504849304931 25.1231976687002, 121.504994938314 25.1233993661055, 121.505096682184 25.1235553050652, 121.505180471253 25.1236365859112, 121.505265590308 25.1236703023945, 121.505339404489 25.1237859016949, 121.505472403012 25.1238966842552, 121.505722440235 25.1240748994676, 121.50602102192 25.1242567268825, 121.506358173176 25.1244499934739, 121.506557005968 25.1245625816588, 121.506991911138 25.1247967888341, 121.507294482778 25.1249774110276, 121.507448096073 25.1250906007995, 121.507798547181 25.1253109593098, 121.508207185143 25.1255719571952, 121.508289976724 25.1256390880491, 121.508305271554 25.1256920702216, 121.508306601539 25.125768834124, 121.508259387063 25.1259052028198, 121.508099123843 25.1262661426289, 121.508015002277 25.12643532339, 121.507919908333 25.1266653125187, 121.507795554714 25.1269657426917, 121.507606696811 25.1274413721162, 121.507505617934 25.1276900232174, 121.507327399913 25.1281644457063, 121.507198391345 25.1284883523877, 121.507074702719 25.1286238149645, 121.506899144668 25.1287634917752, 121.506719596662 25.1288531979186, 121.506369810546 25.129007323756, 121.505932910398 25.1292216546754, 121.505386286468 25.1294955883087, 121.505273902716 25.1295949267272, 121.505098344665 25.129810460715, 121.504902171844 25.1301379753205, 121.504747893557 25.1303914373075, 121.504710653971 25.1305473673423, 121.504686049244 25.1307737364594, 121.504678069332 25.1309790336204, 121.504678069332 25.1310705442671, 121.504641494739 25.1312156366652, 121.504526451016 25.1313872187393, 121.504144080262 25.1318839023318, 121.503984482034 25.1321235138155, 121.503933277603 25.1322969007265, 121.503895373024 25.1324805220133, 121.503821558844 25.1325672152462, 121.503464457809 25.1328218762619, 121.502901874056 25.133156005158, 121.502272791042 25.1334750823496, 121.502120507733 25.1335587647203, 121.501991499166 25.1335768256561, 121.501911035059 25.1335563565953, 121.501869140524 25.1335033778339, 121.501785351455 25.1334588274939, 121.501682277599 25.1334570213987, 121.501430910391 25.1335461220637, 121.50111038395 25.1337646592302, 121.500695428558 25.1340500212225, 121.499959281732 25.1345593365391, 121.499508416739 25.1348555331222, 121.498802194581 25.1353245095763, 121.498229635939 25.1356538154581, 121.497776775968 25.1358464619973, 121.497288671388 25.1360523526501, 121.496922260457 25.1362245299471, 121.495898836822 25.1366874809856, 121.494953217323 25.1371100953557, 121.494289554692 25.1374243461186, 121.493980998119 25.1375411364259, 121.492548604025 25.1380961898644, 121.491758592798 25.1384224782353, 121.491355607272 25.1385814080485, 121.491278468129 25.1386885651543, 121.491217288808 25.1387475617229, 121.490699924554 25.1390678283125, 121.490049561776 25.1394747823911, 121.489819474331 25.1396782589217, 121.489722385409 25.1398046790806, 121.489611996635 25.1400828029693, 121.489596036812 25.1403549062474, 121.489627956457 25.1409051309345, 121.489694455719 25.1410688734698, 121.489892623518 25.1412843872073, 121.490209160003 25.1416022391761, 121.490290289102 25.141790060405, 121.490318218792 25.1419345380768, 121.490324868718 25.1420814235344, 121.490312233859 25.1421006871879, 121.490290954095 25.1421175428822, 121.490241079649 25.14228850765, 121.490141995749 25.1423944575267, 121.489990377433 25.1424516463425, 121.48984208408 25.1424504423677, 121.489709750549 25.1424594721783, 121.489504932823 25.1425238848082, 121.489234945821 25.1426575258572, 121.489025473148 25.1427767191018, 121.488969613768 25.1428321017819, 121.488929049218 25.1429615285995, 121.488970943753 25.1432239937243, 121.488954318938 25.1433130872623, 121.488894469602 25.1435039157701, 121.488738196338 25.1437567480339, 121.488602537844 25.1438759402052, 121.488478184225 25.1439764708855, 121.488330555864 25.1440481064694, 121.488250091758 25.1440848272146, 121.4881742826 25.1440926529458, 121.488153667829 25.1440757975242, 121.488156327799 25.1440541262645, 121.488190907415 25.1440372708376, 121.488280016426 25.144027639164, 121.488416339912 25.1439668392071, 121.488625812586 25.1438024985781, 121.488740191316 25.1436857142603, 121.488907769455 25.1433245249415, 121.488913089396 25.1432342274448, 121.488892474624 25.1429524988259, 121.488901119529 25.1428098283158, 121.488970943753 25.1427363860472, 121.489385899145 25.1425311086525, 121.489633941391 25.1424432185187, 121.489830114212 25.1424095072177, 121.490035596931 25.1423938555391, 121.490138670786 25.1423589402488, 121.490191205203 25.1422842937325, 121.490217804907 25.1421958014324, 121.490245069605 25.1420910553616, 121.490280979206 25.1420392842819, 121.49033284863 25.1420284484717, 121.49037873312 25.1420362743347, 121.490463852175 25.1420862394481, 121.490640075218 25.1422541943179, 121.490760438882 25.1424077012549, 121.49079302352 25.1424931834655, 121.490822283195 25.1426316404403, 121.490879000007 25.1430050000044)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0151002100'=='0100020200' || '0151002100'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
