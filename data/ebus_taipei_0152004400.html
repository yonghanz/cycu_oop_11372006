
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231492532</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0152004400">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0152004400">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0152004400" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0152004400" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0152004400" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0152004400',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="uaNDnalzkqzin0QKONFj3HqGVpbM6a6BU-ZD2ygxn-Iq3YjyHVeh0xr8reN-t62GsEXEXlkSBL2oMGYz2gx95hKfGW01" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/taipei_city.svg" width="100%" class="vipstop-city" alt="臺北市">                
 <span class="stationlist-title">通勤21 </span>                 

                        <a href="../EBus/VsSimpleMap?routeid=0152004400" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0152004400" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">臺北市公共運輸處公車申訴服務電話02-27291181</a>                </div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">富德站 - 草湳大榕樹</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 0710 - 1830 <br>
                        [假日] 0800 - 1830
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> 通勤21班表:0710 1215 1830<br>
[假日]<br /> 通勤21班表:0800 0930 1130 1700 1830<br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content">一段票</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">欣欣客運富德站:02-2239-1333</span>
                </li>

                    <li>
                        <span class="stationlist-move-route-bus-item">備註 :</span>
                        <span class="stationlist-move-route-bus-content">接獲貓空山區落雷時：如應貓纜通報須至貓纜指南宮站協助疏運人潮，疏運時段本線暫停營運</span>
                    </li>
            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 草湳大榕樹</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 富德站</a>
                </p>


            <p> 
</p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">富德</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165601960" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="25.000078" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.5904156" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">象頭埔</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165602460" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.001848" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5884857" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">萬福橋</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165602960" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.003147" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5850662" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">捷運動物園站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165601740" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.99882" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.580221" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">貓纜動物園站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165603340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.9968" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.576778" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">萬壽橋頭(新光)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165200440" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.993482" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.57363" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">萬壽橋頭(秀明)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165200320" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.99161" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.574153" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">萬興國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165200640" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.989679" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.576757" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">政大(聯合醫院)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100920" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.987374" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.576765" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">小坑口(北政國中)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100120" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.986195" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.579379" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">北政國中(政大實小)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.98505" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5799551" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">三角公園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.983627" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.579664" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">政大威秀</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100740" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.983063" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5799961" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">水鋼琴社區</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166600340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.981554" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5809582" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 15</span>
                                    <span class="auto-list-stationlist-place">草湳大榕樹</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166603560" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.970128" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.608444" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">草湳大榕樹</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166603560" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.970128" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.608444" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">岐山</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166603760" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.972478" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.598729" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">貓纜指南宮站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166603160" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.978889" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5899016" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">水鋼琴社區</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.981916" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5809927" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">三角公園</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.983199" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5800742" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">北政國中(政大實小)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.985034" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5801321" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">小坑口(北政國中)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100160" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.986063" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.579711" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">政大</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165100661" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.987567" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.576536" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">萬興圖書館</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1166602400" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.98897" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.57697" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">大誠高中</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165200000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.990413" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.576905" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">萬壽橋頭(秀明)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165200360" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.991863" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.574627" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">萬壽橋頭(新光)</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165200400" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.992819" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.573853" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">貓纜動物園站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165603300" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.996309" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.576197" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">捷運動物園站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165601700" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.998553" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.579926" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 15</span>
                                    <span class="auto-list-stationlist-place">萬福橋</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165602920" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.002997" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5846124" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 16</span>
                                    <span class="auto-list-stationlist-place">象頭埔</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165602420" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.001716" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5884514" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 17</span>
                                    <span class="auto-list-stationlist-place">富德</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1165601920" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.999814" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5905524" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0152004400";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 15;
        var existBackNum = 17;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0152004400',
                        url: './StopStatusRecent3OfRoute?routeid=0152004400&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0152004400',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0152004400',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0152004400');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0152004400","Name":"通勤21","BeginStop":"富德站","GoDirStops":[{"UniStopId":"1165601960","Name":"富德","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5904156,"Latitude":25.000078,"PublicId":"1165601960"},{"UniStopId":"1165602460","Name":"象頭埔","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5884857,"Latitude":25.001848,"PublicId":"1165602460"},{"UniStopId":"1165602960","Name":"萬福橋","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5850662,"Latitude":25.003147,"PublicId":"1165602960"},{"UniStopId":"1165601740","Name":"捷運動物園站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.580221,"Latitude":24.99882,"PublicId":"1165601740"},{"UniStopId":"1165603340","Name":"貓纜動物園站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.576778,"Latitude":24.9968,"PublicId":"1165603340"},{"UniStopId":"1165200440","Name":"萬壽橋頭(新光)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.57363,"Latitude":24.993482,"PublicId":"1165200440"},{"UniStopId":"1165200320","Name":"萬壽橋頭(秀明)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.574153,"Latitude":24.99161,"PublicId":"1165200320"},{"UniStopId":"1165200640","Name":"萬興國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.576757,"Latitude":24.989679,"PublicId":"1165200640"},{"UniStopId":"1165100920","Name":"政大(聯合醫院)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.576765,"Latitude":24.987374,"PublicId":"1165100920"},{"UniStopId":"1165100120","Name":"小坑口(北政國中)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.579379,"Latitude":24.986195,"PublicId":"1165100120"},{"UniStopId":"1165100340","Name":"北政國中(政大實小)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5799551,"Latitude":24.98505,"PublicId":"1165100340"},{"UniStopId":"1165100040","Name":"三角公園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.579664,"Latitude":24.983627,"PublicId":"1165100040"},{"UniStopId":"1165100740","Name":"政大威秀","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5799961,"Latitude":24.983063,"PublicId":"1165100740"},{"UniStopId":"1166600340","Name":"水鋼琴社區","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5809582,"Latitude":24.981554,"PublicId":"1166600340"},{"UniStopId":"1166603560","Name":"草湳大榕樹","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.608444,"Latitude":24.970128,"PublicId":"1166603560"}],"LastStop":"草湳大榕樹","BackDirStops":[{"UniStopId":"1166603560","Name":"草湳大榕樹","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.608444,"Latitude":24.970128,"PublicId":"1166603560"},{"UniStopId":"1166603760","Name":"岐山","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.598729,"Latitude":24.972478,"PublicId":"1166603760"},{"UniStopId":"1166603160","Name":"貓纜指南宮站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5899016,"Latitude":24.978889,"PublicId":"1166603160"},{"UniStopId":"1165100200","Name":"水鋼琴社區","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5809927,"Latitude":24.981916,"PublicId":"1165100200"},{"UniStopId":"1165100000","Name":"三角公園","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5800742,"Latitude":24.983199,"PublicId":"1165100000"},{"UniStopId":"1165100300","Name":"北政國中(政大實小)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5801321,"Latitude":24.985034,"PublicId":"1165100300"},{"UniStopId":"1165100160","Name":"小坑口(北政國中)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.579711,"Latitude":24.986063,"PublicId":"1165100160"},{"UniStopId":"1165100661","Name":"政大","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.576536,"Latitude":24.987567,"PublicId":"1165100661"},{"UniStopId":"1166602400","Name":"萬興圖書館","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.57697,"Latitude":24.98897,"PublicId":"1166602400"},{"UniStopId":"1165200000","Name":"大誠高中","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.576905,"Latitude":24.990413,"PublicId":"1165200000"},{"UniStopId":"1165200360","Name":"萬壽橋頭(秀明)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.574627,"Latitude":24.991863,"PublicId":"1165200360"},{"UniStopId":"1165200400","Name":"萬壽橋頭(新光)","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.573853,"Latitude":24.992819,"PublicId":"1165200400"},{"UniStopId":"1165603300","Name":"貓纜動物園站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.576197,"Latitude":24.996309,"PublicId":"1165603300"},{"UniStopId":"1165601700","Name":"捷運動物園站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.579926,"Latitude":24.998553,"PublicId":"1165601700"},{"UniStopId":"1165602920","Name":"萬福橋","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5846124,"Latitude":25.002997,"PublicId":"1165602920"},{"UniStopId":"1165602420","Name":"象頭埔","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5884514,"Latitude":25.001716,"PublicId":"1165602420"},{"UniStopId":"1165601920","Name":"富德","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5905524,"Latitude":24.999814,"PublicId":"1165601920"}],"RouteMapUrl":"../MapOverview?nid=0152004400","RouteTracks":null,"StopDirection":null,"TicketPrice":"一段票","BusTimeDesc":"0710 - 1830","HeadwayDesc":"通勤21班表:0710 1215 1830","HolidayBusTimeDesc":"0800 - 1830","HolidayHeadwayDesc":"通勤21班表:0800 0930 1130 1700 1830","RouteNote":"接獲貓空山區落雷時：如應貓纜通報須至貓纜指南宮站協助疏運人潮，疏運時段本線暫停營運","SegmentBuffer":"","StopLng":0,"StopLat":0,"IsNtpcMainLine":false,"orgphone":"欣欣客運富德站:02-2239-1333","aliasName":"通勤21","aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":"LINESTRING (121.580387811837 24.9990144505762, 121.576883258227 24.9968746561459, 121.574276362208 24.995280930876, 121.573932055187 24.9949911604246, 121.573845978432 24.9945174957156, 121.573603119015 24.9921184952419, 121.573587748166 24.9916002381182, 121.574144172906 24.9916503921289, 121.574460812398 24.9917061187835, 121.574845083628 24.9918092130278, 121.575318505782 24.99189558922, 121.575582884388 24.991878871252, 121.575859559673 24.9918147856872, 121.576210015034 24.9916420331286, 121.576542025376 24.9913940491926, 121.576723401396 24.9911516374458, 121.576791033132 24.9908117029267, 121.576797181472 24.9903979289033, 121.576806403981 24.9897152683791, 121.576850979444 24.989176103204, 121.576961649558 24.9886801248824, 121.57655278497 24.9884822902745, 121.576325296402 24.9882928145769, 121.576154679977 24.9881562804373, 121.575979452296 24.9879807363208, 121.576131623703 24.9875655595556, 121.576983168747 24.9873955874553, 121.577591854374 24.9872757709155, 121.578011478556 24.9871768525213, 121.578135290771 24.9871349108152, 121.578323035719 24.9870748660619, 121.579147758075 24.9864256636244, 121.579504025719 24.986149639383, 121.579652296749 24.9859768087713, 121.57975184805 24.9857586638667, 121.58002130264 24.9849514769308, 121.580010971547 24.9848252176948, 121.579960204393 24.9846817456642, 121.579478344854 24.9838449316476, 121.579696947243 24.9837075607543, 121.579850258386 24.9835065311899, 121.58005505249 24.9830241104757, 121.58078368724 24.9819582437591, 121.580982888447 24.9817255754505, 121.581417362886 24.9813461549046, 121.581994006095 24.9810530097997, 121.582172593395 24.9809463337895, 121.582260846673 24.9808624527035, 121.582376365865 24.9807282250487, 121.582432614724 24.9805647814021, 121.582464328195 24.9803076760884, 121.582511523187 24.9801422288239, 121.582440703408 24.9799162210899, 121.582427668591 24.9798144644806, 121.582470522474 24.9795856942465, 121.582487891552 24.9793723861686, 121.582310348954 24.9788359987979, 121.582360604379 24.9785518269324, 121.582428456586 24.9781564324223, 121.58253265819 24.9779828977637, 121.582714405173 24.9778247393807, 121.582961581071 24.9777434634658, 121.583145751347 24.9777127104029, 121.583589213987 24.9775194052602, 121.58373218828 24.977233840289, 121.584127185057 24.9769460779934, 121.584478562558 24.9767945082694, 121.58525886294 24.9765748416711, 121.58584287658 24.9765836283426, 121.586145788219 24.9766714950227, 121.586434160099 24.9766187750222, 121.586904278962 24.9764298615014, 121.587061793015 24.9764364515128, 121.58802384038 24.9762233742979, 121.588440646795 24.976396911439, 121.58856181145 24.9765836283426, 121.588692669278 24.9766495283585, 121.588806564055 24.9766275616905, 121.588842913451 24.976616578355, 121.588976194572 24.9763441913207, 121.589077972883 24.9762453410382, 121.58936392147 24.9761948175298, 121.589526282109 24.9761355072977, 121.590182994542 24.9756083039784, 121.590393821042 24.9755050597304, 121.590655536698 24.9754611259816, 121.590803357578 24.9753754551263, 121.591057803355 24.9749536900455, 121.591401910977 24.9748394617539, 121.591668473219 24.9746373652859, 121.592894659533 24.9742221878046, 121.59488660647 24.97358953371, 121.595623287576 24.9731721559636, 121.595763838577 24.9730403521705, 121.595870463473 24.9727459898561, 121.595957702025 24.9726625138477, 121.596985178304 24.9726229725608, 121.597537689134 24.9724252659357, 121.597925416032 24.9724208724515, 121.598507006378 24.972390118058, 121.599219454553 24.9723769376012, 121.599500556554 24.9723110352964, 121.600620117971 24.9723154287844, 121.601637901078 24.9720957541878, 121.601914156492 24.9719859167423, 121.602403661701 24.9718936532124, 121.602830161288 24.9715992881543, 121.603339052842 24.9715026308175, 121.60382855805 24.9712873482943, 121.604308370086 24.9709490464253, 121.604817261639 24.9708436014968, 121.60527768733 24.9705404468239, 121.605442597256 24.9705123733762, 121.605542486848 24.9705373838733, 121.605649391667 24.9705396417171, 121.605724609778 24.9705383834768, 121.605809124318 24.9705334664135, 121.605918993196 24.9705103145382, 121.606032565712 24.9704472274361, 121.606129296209 24.9704062192401, 121.606217693012 24.9703798782879, 121.606310352998 24.9703614862591, 121.606390941936 24.9703487060473, 121.606516411726 24.9703466921435, 121.606650974967 24.9703447750766, 121.606802215451 24.9703079735607, 121.606869078601 24.970286117753, 121.607243446176 24.9702727407336, 121.60746476039 24.9702626972593, 121.607599325941 24.9702482317064, 121.607738983351 24.9702803474316, 121.607843939579 24.9703106813622, 121.607938541011 24.9703109408507, 121.608419099948 24.97006215029, 121.608434561759 24.9700931973814, 121.607938746443 24.970326709329, 121.607832840875 24.9703221968079, 121.607684663702 24.9702893505247, 121.607583237971 24.9702644107067, 121.607416039942 24.9702827263687, 121.607198535029 24.9702938198936, 121.606984477298 24.9703072301894, 121.606798530713 24.9703277186871, 121.606649396156 24.9703631189589, 121.60652185685 24.9703650184535, 121.606386873639 24.9703656155545, 121.606249022067 24.9703900456717, 121.606137834588 24.9704196014659, 121.606052650911 24.9704631427952, 121.605972741938 24.9705071204532, 121.60584132528 24.9705505023036, 121.605741154513 24.9705633196805, 121.605644175026 24.9705595576568, 121.605250573772 24.9705628776512, 121.604794 24.97085, 121.604331146117 24.9709442302738, 121.603809804743 24.971302443295, 121.603513416957 24.9714088569983, 121.603308420408 24.9715098684311, 121.602796287242 24.9716128629934, 121.602394965933 24.9719195585016, 121.60189743336 24.9719998336934, 121.601562627047 24.9721128705726, 121.600560431221 24.9723258774952, 121.599894785572 24.97230767446, 121.59947776573 24.9723083696023, 121.599187929337 24.9723901193603, 121.598537645906 24.9724222895744, 121.598430429064 24.9726656000558, 121.598356196867 24.9727265954771, 121.598192158374 24.9727104358345, 121.597955249689 24.9726214067813, 121.59783533943 24.9726018410921, 121.597725249464 24.9726116366998, 121.597506108996 24.9727269879859, 121.597337061488 24.9728363802631, 121.597162678513 24.9730278094572, 121.596869788728 24.9731488638962, 121.596812877874 24.9732065747707, 121.59679528517 24.9733193874539, 121.596792254099 24.9735408930149, 121.596676628697 24.9737225414264, 121.596483835326 24.9739137312136, 121.596263964067 24.9741012957801, 121.595969218073 24.9742770074426, 121.595751522005 24.9743925460413, 121.595444026189 24.9747443479407, 121.595365446038 24.9749085025279, 121.595328198852 24.9749995778289, 121.595227641842 24.9751197572475, 121.594978745806 24.9752656025264, 121.5948176335 24.9753240875292, 121.594677084977 24.9753242708181, 121.594436885151 24.9752962715997, 121.594324472189 24.9753165369487, 121.593933572891 24.975493122916, 121.593704335716 24.9756190042497, 121.5934156512 24.9756798350782, 121.593279850212 24.975723679398, 121.593041736895 24.9758692394747, 121.592882812331 24.9759452863262, 121.592556054965 24.9760183670445, 121.592441815701 24.9760925910993, 121.592377434881 24.9761831982202, 121.592283385792 24.9764583066671, 121.592271067171 24.9768158853847, 121.592281708191 24.977289338325, 121.592243533359 24.9774562330816, 121.592052212972 24.9777221998162, 121.591695925999 24.9780621795359, 121.591664322246 24.9781857251734, 121.591689126885 24.9782590095145, 121.59181865236 24.9783820163766, 121.591805196959 24.9785322462089, 121.591731872734 24.9786526226792, 121.591452705173 24.9788624275032, 121.591299906403 24.978927251089, 121.591115895017 24.9789762052863, 121.590888174958 24.9789834736431, 121.590736671249 24.9789219975031, 121.590611708111 24.97884541641, 121.590519216194 24.9787970396661, 121.590090871114 24.9787663390478, 121.589593110518 24.9788704952982, 121.589604814995 24.9788266890539, 121.590107164789 24.9787445852157, 121.590514506651 24.9787737321487, 121.590624531494 24.9788197350492, 121.590751385061 24.9789031708759, 121.590896479486 24.9789528977215, 121.591113978287 24.9789516542222, 121.591286625943 24.9789023898222, 121.591432134967 24.9788391198195, 121.591722907549 24.9786310159873, 121.591780727088 24.978529149903, 121.591795086796 24.9783960177585, 121.591676780165 24.9782800040819, 121.591626610202 24.9781756336131, 121.591675959418 24.9780454812051, 121.592037280408 24.9776951891136, 121.592213526214 24.9774321562893, 121.592249472301 24.9772909543068, 121.592239515556 24.9768222116727, 121.592252582353 24.9764631637007, 121.592345349952 24.9761814846249, 121.59244173188 24.9760668225018, 121.592549613383 24.9759911662246, 121.592875089576 24.9759126547104, 121.593029608538 24.9758387220031, 121.593254060925 24.9757053470379, 121.593409642628 24.9756573117808, 121.593681805563 24.9755909848233, 121.593918350071 24.975474346674, 121.594319329638 24.9752881744028, 121.594427881222 24.9752764634876, 121.594690612608 24.9753069384917, 121.594803309224 24.9752988670387, 121.594948323506 24.9752469558234, 121.595216450472 24.9750970898963, 121.595298770903 24.9749981256761, 121.595344442822 24.9748933560835, 121.595428165524 24.9747155927588, 121.595746003918 24.9743806709907, 121.59593484077 24.9742722252583, 121.596231949494 24.9740888101863, 121.596454086413 24.9739039895716, 121.596659778444 24.9736965348259, 121.596766108331 24.9735241925349, 121.596763996851 24.9733162796594, 121.596794102019 24.9731829917466, 121.596852737112 24.973126163618, 121.597151545246 24.9730068234904, 121.597314821515 24.9728097690253, 121.597476967871 24.9727079485165, 121.597715346561 24.9725796932046, 121.597839768769 24.9725712079264, 121.597958747173 24.9725930493698, 121.598214352619 24.9726873711501, 121.598341835815 24.9727020668955, 121.598409858858 24.9726477376052, 121.598505300456 24.9724114453154, 121.598134429094 24.9723842751918, 121.597904411966 24.9724159413705, 121.597746434273 24.9724029537514, 121.597490604361 24.9724227168403, 121.597075918084 24.9725982277599, 121.596959573059 24.9726359706365, 121.595948710619 24.9726708283803, 121.595948008853 24.9726713007987, 121.5958600268 24.9727503390697, 121.595753424802 24.9730666865697, 121.595649030004 24.9731773083363, 121.59483710896 24.9735831755062, 121.59373699073 24.9739491484212, 121.593606422175 24.9740216865655, 121.593004052733 24.9741937135454, 121.592847698814 24.974229033943, 121.591939156814 24.9745656503331, 121.591655990729 24.9746519336372, 121.591346981459 24.9748439039453, 121.591059237478 24.97496178998, 121.590789951706 24.9753789634838, 121.590644789608 24.9754659149953, 121.590389845683 24.9755082111353, 121.590184702774 24.9756188746347, 121.589501863154 24.9761406013195, 121.589345415531 24.9761995064883, 121.589069989636 24.976253493536, 121.58896871561 24.9763315065488, 121.588850482738 24.9766139899518, 121.588776864199 24.9766528396106, 121.588677373786 24.9766548721218, 121.588535713471 24.9765761701101, 121.588434857449 24.9763984310126, 121.588012283677 24.9762283383641, 121.587047634073 24.9764422696876, 121.586901999287 24.9764348771327, 121.586402729159 24.9766323401892, 121.586132646024 24.9766698049028, 121.585993120753 24.9766341516913, 121.585821066942 24.9765858250103, 121.585234630009 24.9765836283426, 121.584451282251 24.9768052458038, 121.584120283677 24.9769586919606, 121.583742716323 24.9772400773165, 121.583589429794 24.977518015239, 121.583133994295 24.9777176615787, 121.582927840333 24.9777463839274, 121.582701698495 24.9778345054188, 121.582525846038 24.9779884128008, 121.582422282964 24.9781575830698, 121.582345290808 24.9785774003099, 121.582402861014 24.9788347085955, 121.582553244151 24.9793571190108, 121.582546532106 24.9796019475558, 121.582501838399 24.9798124926964, 121.582516136146 24.9799145006449, 121.582590782392 24.9801372939504, 121.582539962613 24.9803292781956, 121.582507900188 24.9805953738191, 121.582438492297 24.9807662665775, 121.582326730472 24.9809140521279, 121.582196433183 24.9810109769929, 121.582025331015 24.9811123936217, 121.581473930649 24.9813947256646, 121.581040869769 24.9817772662131, 121.580848903011 24.9819984307034, 121.58012812615 24.983054881258, 121.579926940173 24.9835409982355, 121.579755489707 24.9837328424368, 121.579685286886 24.9837910023853, 121.579571841512 24.98385912309, 121.580038872377 24.9846438586026, 121.580079595671 24.9848051208645, 121.580096535511 24.9849540476526, 121.579816725883 24.9858027771393, 121.579707978691 24.9860235923261, 121.579542157106 24.9862056367039, 121.579165424973 24.9865054733785, 121.578339591531 24.9871289808278, 121.578149461042 24.9871821378775, 121.577299229582 24.9873934540594, 121.576199842267 24.9876227164322, 121.576053232372 24.9879612314035, 121.576074751561 24.9880225325617, 121.576495912828 24.9883847660549, 121.576741846415 24.9885463775767, 121.577067708417 24.9886508676717, 121.576961649558 24.9890172789031, 121.576892480737 24.989390655004, 121.576889406567 24.989973008002, 121.576874035718 24.990574862747, 121.576843294019 24.9908869344176, 121.576781810623 24.9911906462649, 121.576581989583 24.9914330579348, 121.576351426846 24.9916141697899, 121.576019416504 24.9917924950481, 121.575798076276 24.9918844439083, 121.57553984601 24.9919457431102, 121.575287764084 24.9919513157634, 121.574602224211 24.9917924950481, 121.574319400586 24.9917284094382, 121.57370149245 24.991639246795, 121.573747604997 24.9925475881961, 121.573925906847 24.9940103938273, 121.57406424449 24.9949382215184, 121.576520506187 24.9965681721222, 121.580587632876 24.9990144505762)","wkt0":"LINESTRING (121.590530400885 25.0000046801109, 121.590298706788 25.0001752245122, 121.589266383922 25.0010559161161, 121.588636327714 25.0016554855912, 121.588241330937 25.0021101022539, 121.587696089987 25.0026920969756, 121.587417411279 25.0029819952044, 121.587090266709 25.0031203554816, 121.586721926156 25.0031532983818, 121.585675063532 25.0031576907678, 121.585277643462 25.0031335326427, 121.584477956735 25.003061058239, 121.583910906147 25.002951248455, 121.583973911768 25.0027821411956, 121.584233204131 25.0020156651146, 121.584247743889 25.0017740814045, 121.584182314975 25.0014819841025, 121.584000567992 25.0012228295239, 121.583564375232 25.0009285346785, 121.582895546333 25.0004739136438, 121.580387811837 24.9990144505762, 121.576883258227 24.9968746561459, 121.574276362208 24.995280930876, 121.573932055187 24.9949911604246, 121.573845978432 24.9945174957156, 121.573603119015 24.9921184952419, 121.573587748166 24.9916002381182, 121.574144172906 24.9916503921289, 121.574460812398 24.9917061187835, 121.574845083628 24.9918092130278, 121.575318505782 24.99189558922, 121.575582884388 24.991878871252, 121.575859559673 24.9918147856872, 121.576210015034 24.9916420331286, 121.576542025376 24.9913940491926, 121.576723401396 24.9911516374458, 121.576791033132 24.9908117029267, 121.576797181472 24.9903979289033, 121.576806403981 24.9897152683791, 121.576850979444 24.989176103204, 121.576961649558 24.9886801248824, 121.57655278497 24.9884822902745, 121.576325296402 24.9882928145769, 121.576154679977 24.9881562804373, 121.575979452296 24.9879807363208, 121.576131623703 24.9875655595556, 121.576983168747 24.9873955874553, 121.577591854374 24.9872757709155, 121.578011478556 24.9871768525213, 121.578135290771 24.9871349108152, 121.578323035719 24.9870748660619, 121.579147758075 24.9864256636244, 121.579504025719 24.986149639383, 121.579652296749 24.9859768087713, 121.57975184805 24.9857586638667, 121.58002130264 24.9849514769308, 121.580010971547 24.9848252176948, 121.579960204393 24.9846817456642, 121.579478344854 24.9838449316476, 121.579696947243 24.9837075607543, 121.579850258386 24.9835065311899, 121.58005505249 24.9830241104757, 121.58078368724 24.9819582437591, 121.580982888447 24.9817255754505, 121.581417362886 24.9813461549046, 121.581994006095 24.9810530097997, 121.582172593395 24.9809463337895, 121.582260846673 24.9808624527035, 121.582376365865 24.9807282250487, 121.582432614724 24.9805647814021, 121.582464328195 24.9803076760884, 121.582511523187 24.9801422288239, 121.582440703408 24.9799162210899, 121.582427668591 24.9798144644806, 121.582470522474 24.9795856942465, 121.582528971126 24.9793634412118, 121.582396781823 24.9787838245878, 121.582347595105 24.9785553211295, 121.582418301012 24.978142899179, 121.582682679617 24.9778419417478, 121.582925539034 24.9777555556824, 121.583131508413 24.9777221158989, 121.583592633888 24.9775186903532, 121.583749416549 24.9772428113359, 121.584127539439 24.9769446383689, 121.584459549781 24.9767997316193, 121.585268056447 24.9765879445242, 121.585936688386 24.9766116312569, 121.58614112068 24.9766771180824, 121.586399350946 24.9766283513008, 121.586894292289 24.9764374639983, 121.58705414912 24.9764388573373, 121.588007141769 24.9762284629624, 121.588459044734 24.9764012371775, 121.588548195659 24.9765795844999, 121.588698829981 24.9766520380257, 121.588797203416 24.9766436780057, 121.588864835152 24.9766046645713, 121.588972431096 24.9763399302257, 121.58908310121 24.9762563297877, 121.589384369854 24.9761810893449, 121.59019287652 24.9756098178149, 121.590417290918 24.9754983498899, 121.590654001995 24.9754537626916, 121.590786191298 24.9753757350558, 121.591062866583 24.9749577290209, 121.591357986887 24.9748323269335, 121.59167462638 24.9746456169219, 121.592839736746 24.974227608406, 121.594828724629 24.9736033797113, 121.595677195503 24.9731742206462, 121.595877016542 24.9727339130365, 121.596003057505 24.972661457006, 121.596971421002 24.9726391630917, 121.597555513271 24.9723883540619, 121.598244127313 24.9723716334418, 121.598760587845 24.9723911408317, 121.599089524018 24.9724078614982, 121.599467646907 24.9722936038509, 121.600568199707 24.9723131112533, 121.60126603626 24.9721570519479, 121.601874721887 24.9719870585508, 121.602394256588 24.9719118154967, 121.602778527818 24.971616416395, 121.603304210859 24.9714965844818, 121.605467190615 24.9704594247665, 121.605542486848 24.9705373838733, 121.605649391667 24.9705396417171, 121.605724609778 24.9705383834768, 121.605809124318 24.9705334664135, 121.605918993196 24.9705103145382, 121.606032565712 24.9704472274361, 121.606129296209 24.9704062192401, 121.606217693012 24.9703798782879, 121.606310352998 24.9703614862591, 121.606390941936 24.9703487060473, 121.606516411726 24.9703466921435, 121.606650974967 24.9703447750766, 121.606802215451 24.9703079735607, 121.606869078601 24.970286117753, 121.607243446176 24.9702727407336, 121.60746476039 24.9702626972593, 121.607599325941 24.9702482317064, 121.607738983351 24.9702803474316, 121.607843939579 24.9703106813622, 121.607938541011 24.9703109408507, 121.608419099948 24.97006215029)","wkt1":"LINESTRING (121.608434561759 24.9700931973814, 121.607938746443 24.970326709329, 121.607832840875 24.9703221968079, 121.607684663702 24.9702893505247, 121.607583237971 24.9702644107067, 121.607416039942 24.9702827263687, 121.607198535029 24.9702938198936, 121.606984477298 24.9703072301894, 121.606798530713 24.9703277186871, 121.606649396156 24.9703631189589, 121.60652185685 24.9703650184535, 121.606386873639 24.9703656155545, 121.606249022067 24.9703900456717, 121.606137834588 24.9704196014659, 121.606052650911 24.9704631427952, 121.605972741938 24.9705071204532, 121.60584132528 24.9705505023036, 121.605741154513 24.9705633196805, 121.605644175026 24.9705595576568, 121.605250573772 24.9705628776512, 121.604794 24.97085, 121.604330983583 24.970975453641, 121.603809804743 24.971302443295, 121.603513416957 24.9714088569983, 121.603308420408 24.9715098684311, 121.602796287242 24.9716128629934, 121.602394965933 24.9719195585016, 121.60189743336 24.9719998336934, 121.601562627047 24.9721128705726, 121.600560431221 24.9723258774952, 121.599894785572 24.97230767446, 121.59947776573 24.9723083696023, 121.599187929337 24.9723901193603, 121.598537645906 24.9724222895744, 121.598430429064 24.9726656000558, 121.598356196867 24.9727265954771, 121.598192158374 24.9727104358345, 121.597955249689 24.9726214067813, 121.59783533943 24.9726018410921, 121.597725249464 24.9726116366998, 121.597506108996 24.9727269879859, 121.597337061488 24.9728363802631, 121.597162678513 24.9730278094572, 121.596869788728 24.9731488638962, 121.596812877874 24.9732065747707, 121.59679528517 24.9733193874539, 121.596792254099 24.9735408930149, 121.596676628697 24.9737225414264, 121.596483835326 24.9739137312136, 121.596263964067 24.9741012957801, 121.595969218073 24.9742770074426, 121.595751522005 24.9743925460413, 121.595444026189 24.9747443479407, 121.595365446038 24.9749085025279, 121.595328198852 24.9749995778289, 121.595227641842 24.9751197572475, 121.594978745806 24.9752656025264, 121.5948176335 24.9753240875292, 121.594677084977 24.9753242708181, 121.594436885151 24.9752962715997, 121.594324472189 24.9753165369487, 121.593933572891 24.975493122916, 121.593704335716 24.9756190042497, 121.5934156512 24.9756798350782, 121.593279850212 24.975723679398, 121.593041736895 24.9758692394747, 121.592882812331 24.9759452863262, 121.592556054965 24.9760183670445, 121.592441815701 24.9760925910993, 121.592377434881 24.9761831982202, 121.592283385792 24.9764583066671, 121.592271067171 24.9768158853847, 121.592281708191 24.977289338325, 121.592243533359 24.9774562330816, 121.592052212972 24.9777221998162, 121.591695925999 24.9780621795359, 121.591664322246 24.9781857251734, 121.591689126885 24.9782590095145, 121.59181865236 24.9783820163766, 121.591805196959 24.9785322462089, 121.591731872734 24.9786526226792, 121.591452705173 24.9788624275032, 121.591299906403 24.978927251089, 121.591115895017 24.9789762052863, 121.590888174958 24.9789834736431, 121.590736671249 24.9789219975031, 121.590611708111 24.97884541641, 121.590519216194 24.9787970396661, 121.590090871114 24.9787663390478, 121.589593110518 24.9788704952982, 121.589604814995 24.9788266890539, 121.590107164789 24.9787445852157, 121.590514506651 24.9787737321487, 121.590624531494 24.9788197350492, 121.590751385061 24.9789031708759, 121.590896479486 24.9789528977215, 121.591113978287 24.9789516542222, 121.591286625943 24.9789023898222, 121.591432134967 24.9788391198195, 121.591722907549 24.9786310159873, 121.591780727088 24.978529149903, 121.591795086796 24.9783960177585, 121.591676780165 24.9782800040819, 121.591626610202 24.9781756336131, 121.591675959418 24.9780454812051, 121.592037280408 24.9776951891136, 121.592213526214 24.9774321562893, 121.592249472301 24.9772909543068, 121.592239515556 24.9768222116727, 121.592252582353 24.9764631637007, 121.592345349952 24.9761814846249, 121.59244173188 24.9760668225018, 121.592549613383 24.9759911662246, 121.592875089576 24.9759126547104, 121.593029608538 24.9758387220031, 121.593254060925 24.9757053470379, 121.593409642628 24.9756573117808, 121.593681805563 24.9755909848233, 121.593918350071 24.975474346674, 121.594319329638 24.9752881744028, 121.594427881222 24.9752764634876, 121.594690612608 24.9753069384917, 121.594803309224 24.9752988670387, 121.594948323506 24.9752469558234, 121.595216450472 24.9750970898963, 121.595298770903 24.9749981256761, 121.595344442822 24.9748933560835, 121.595428165524 24.9747155927588, 121.595746003918 24.9743806709907, 121.59593484077 24.9742722252583, 121.596231949494 24.9740888101863, 121.596454086413 24.9739039895716, 121.596659778444 24.9736965348259, 121.596766108331 24.9735241925349, 121.596763996851 24.9733162796594, 121.596794102019 24.9731829917466, 121.596852737112 24.973126163618, 121.597151545246 24.9730068234904, 121.597314821515 24.9728097690253, 121.597476967871 24.9727079485165, 121.597715346561 24.9725796932046, 121.597839768769 24.9725712079264, 121.597958747173 24.9725930493698, 121.598214352619 24.9726873711501, 121.598341835815 24.9727020668955, 121.598409858858 24.9726477376052, 121.598505300456 24.9724114453154, 121.598134429094 24.9723842751918, 121.597904411966 24.9724159413705, 121.597746434273 24.9724029537514, 121.597490604361 24.9724227168403, 121.597075918084 24.9725982277599, 121.596959573059 24.9726359706365, 121.595948710619 24.9726708283803, 121.5958600268 24.9727503390697, 121.595753424802 24.9730666865697, 121.595649030004 24.9731773083363, 121.59483710896 24.9735831755062, 121.59373699073 24.9739491484212, 121.593606422175 24.9740216865655, 121.593004052733 24.9741937135454, 121.592847698814 24.974229033943, 121.591939156814 24.9745656503331, 121.591655990729 24.9746519336372, 121.591346981459 24.9748439039453, 121.591059237478 24.97496178998, 121.590789951706 24.9753789634838, 121.590644789608 24.9754659149953, 121.590389845683 24.9755082111353, 121.590184702774 24.9756188746347, 121.589501863154 24.9761406013195, 121.589345415531 24.9761995064883, 121.589069989636 24.976253493536, 121.58896871561 24.9763315065488, 121.588850482738 24.9766139899518, 121.588776864199 24.9766528396106, 121.588677373786 24.9766548721218, 121.588535713471 24.9765761701101, 121.588434857449 24.9763984310126, 121.588012283677 24.9762283383641, 121.587047634073 24.9764422696876, 121.586901999287 24.9764348771327, 121.586402729159 24.9766323401892, 121.586132646024 24.9766698049028, 121.585928856022 24.9766130472157, 121.585270855309 24.9765833384009, 121.584451282251 24.9768052458038, 121.584120283677 24.9769586919606, 121.583742716323 24.9772400773165, 121.583589429794 24.977518015239, 121.583133994295 24.9777176615787, 121.582927840333 24.9777463839274, 121.582701698495 24.9778345054188, 121.582525846038 24.9779884128008, 121.582422282964 24.9781575830698, 121.582345290808 24.9785774003099, 121.582402861014 24.9788347085955, 121.582553244151 24.9793571190108, 121.582546532106 24.9796019475558, 121.582501838399 24.9798124926964, 121.582516136146 24.9799145006449, 121.582590782392 24.9801372939504, 121.582539962613 24.9803292781956, 121.582507900188 24.9805953738191, 121.582438492297 24.9807662665775, 121.582326730472 24.9809140521279, 121.582196433183 24.9810109769929, 121.582025331015 24.9811123936217, 121.581473930649 24.9813947256646, 121.581040869769 24.9817772662131, 121.580848903011 24.9819984307034, 121.58012812615 24.983054881258, 121.579926940173 24.9835409982355, 121.579755489707 24.9837328424368, 121.579685286886 24.9837910023853, 121.579571841512 24.98385912309, 121.580038872377 24.9846438586026, 121.580079595671 24.9848051208645, 121.580096535511 24.9849540476526, 121.579816725883 24.9858027771393, 121.579707978691 24.9860235923261, 121.579542157106 24.9862056367039, 121.579165424973 24.9865054733785, 121.578339591531 24.9871289808278, 121.578149461042 24.9871821378775, 121.577299229582 24.9873934540594, 121.576199842267 24.9876227164322, 121.576053232372 24.9879612314035, 121.576074751561 24.9880225325617, 121.576495912828 24.9883847660549, 121.576741846415 24.9885463775767, 121.577067708417 24.9886508676717, 121.576961649558 24.9890172789031, 121.576892480737 24.989390655004, 121.576889406567 24.989973008002, 121.576874035718 24.990574862747, 121.576843294019 24.9908869344176, 121.576781810623 24.9911906462649, 121.576581989583 24.9914330579348, 121.576351426846 24.9916141697899, 121.576019416504 24.9917924950481, 121.575798076276 24.9918844439083, 121.57553984601 24.9919457431102, 121.575287764084 24.9919513157634, 121.574602224211 24.9917924950481, 121.574319400586 24.9917284094382, 121.57370149245 24.991639246795, 121.573747604997 24.9925475881961, 121.573925906847 24.9940103938273, 121.57406424449 24.9949382215184, 121.576520506187 24.9965681721222, 121.580587632876 24.9990144505762, 121.582025584107 24.9998721421511, 121.582430274056 25.0000061134318, 121.582851927057 25.0000346646695, 121.583091833075 25.0000939633727, 121.583346278852 25.0002147569389, 121.583501369611 25.0003838677321, 121.583511062784 25.0005881181199, 121.583569221818 25.000774798285, 121.583816397716 25.0009614781664, 121.584095076423 25.0011832974215, 121.584259860355 25.0014468445307, 121.584337405735 25.0016708591291, 121.58431801939 25.0019102468268, 121.584267130234 25.0021650075341, 121.584102346303 25.0026723311623, 121.584044187268 25.0028831663396, 121.584553078821 25.0029841914005, 121.584986848288 25.0030347038998, 121.585452120566 25.003067646823, 121.586053097257 25.0030808239897, 121.586399628172 25.003076431601, 121.586959408881 25.003061058239, 121.587158118916 25.0029907799886, 121.587398024934 25.0028699891516, 121.587926302832 25.0022901914812, 121.588335839368 25.0018597338652, 121.588796265059 25.0013677804573, 121.589167028905 25.0010317575777, 121.590541036099 24.9998413946234)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0152004400'=='0100020200' || '0152004400'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
