
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231492985</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454072380">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454072380">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454072380" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0454072380" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454072380" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454072380',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="BFcqtxa149yZ20E3NmdUlmnawaXfaKOVEiTUMzVIdc2ynPi6PMnd5efKdDusenN_2LBbFuBnBE6ueNSk8lE0NY2IVec1" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/new_taipei_city.svg" width="100%" class="vipstop-city" alt="新北市">                
 <span class="stationlist-title">F723上石嘈 </span>                 

                        <a href="../EBus/VsSimpleMap?routeid=0454072380" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0454072380" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">新北市政府交通局公車申訴服務電話02-89682460</a></div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">坪林國中 - 關聖宮</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 0800 - 1630 <br>
                        [假日] 0800 - 1630
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> F723上石嘈班表:0800 1200 1630<br>
[假日]<br /> F723上石嘈班表:0800 1240 1630<br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">坪林區公所坪林區公所站:(02)2665-7251</span>
                </li>

            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 關聖宮</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 坪林國中</a>
                </p>


            <p> 
</p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">坪林國中</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324100600" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="24.93705" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.712961" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">坪林區公所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324101250" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.935418" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.711785" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">協德宮牌樓</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324200730" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.930815" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.707489" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">保安宮牌樓</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324200830" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.919521" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.706879" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">清潔隊</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324101430" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.910019" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.717663" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">乾溝子</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324200930" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.905658" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.719096" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">石嘈派出所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201030" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.901867" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.720082" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">五份子</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201120" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.894058" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.728781" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">三份子</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.895045" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.73162" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">青山農場</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201310" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.89542" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.734092" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">碧湖橋</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201440" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.893119" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.743163" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">碧湖</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201540" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.89096" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.744722" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">山林</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201610" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.87612" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.758012" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">關聖宮</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201730" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.875278" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.761891" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">關聖宮</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201730" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.875278" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.761891" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">山林</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201650" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.876149" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.757795" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">碧湖</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201570" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.89092" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.744893" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">碧湖橋</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201400" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.893512" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.743256" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">青山農場</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201360" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.895567" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.73404" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">三份子</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201250" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.894971" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.731447" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">石嘈派出所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.902347" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.720087" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">乾溝子</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324200910" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.905751" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.71924" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">清潔隊</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324101470" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.910622" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.718039" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">保安宮牌樓</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324200870" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.919635" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.707003" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">金華茶莊</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324101570" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.921625" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.70666" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">九芎林</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324201800" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.924467" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.707743" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">協德宮牌樓</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324200770" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.930919" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.707586" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 14</span>
                                    <span class="auto-list-stationlist-place">坪林國中</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2324100600" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="24.93705" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.712961" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0454072380";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 14;
        var existBackNum = 14;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0454072380',
                        url: './StopStatusRecent3OfRoute?routeid=0454072380&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0454072380',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0454072380',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0454072380');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0454072380","Name":"F723上石嘈","BeginStop":"坪林國中","GoDirStops":[{"UniStopId":"2324100600","Name":"坪林國中","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.712961,"Latitude":24.93705,"PublicId":"2324100600"},{"UniStopId":"2324101250","Name":"坪林區公所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.711785,"Latitude":24.935418,"PublicId":"2324101250"},{"UniStopId":"2324200730","Name":"協德宮牌樓","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.707489,"Latitude":24.930815,"PublicId":"2324200730"},{"UniStopId":"2324200830","Name":"保安宮牌樓","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.706879,"Latitude":24.919521,"PublicId":"2324200830"},{"UniStopId":"2324101430","Name":"清潔隊","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.717663,"Latitude":24.910019,"PublicId":"2324101430"},{"UniStopId":"2324200930","Name":"乾溝子","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.719096,"Latitude":24.905658,"PublicId":"2324200930"},{"UniStopId":"2324201030","Name":"石嘈派出所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.720082,"Latitude":24.901867,"PublicId":"2324201030"},{"UniStopId":"2324201120","Name":"五份子","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.728781,"Latitude":24.894058,"PublicId":"2324201120"},{"UniStopId":"2324201200","Name":"三份子","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.73162,"Latitude":24.895045,"PublicId":"2324201200"},{"UniStopId":"2324201310","Name":"青山農場","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.734092,"Latitude":24.89542,"PublicId":"2324201310"},{"UniStopId":"2324201440","Name":"碧湖橋","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.743163,"Latitude":24.893119,"PublicId":"2324201440"},{"UniStopId":"2324201540","Name":"碧湖","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.744722,"Latitude":24.89096,"PublicId":"2324201540"},{"UniStopId":"2324201610","Name":"山林","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.758012,"Latitude":24.87612,"PublicId":"2324201610"},{"UniStopId":"2324201730","Name":"關聖宮","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.761891,"Latitude":24.875278,"PublicId":"2324201730"}],"LastStop":"關聖宮","BackDirStops":[{"UniStopId":"2324201730","Name":"關聖宮","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.761891,"Latitude":24.875278,"PublicId":"2324201730"},{"UniStopId":"2324201650","Name":"山林","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.757795,"Latitude":24.876149,"PublicId":"2324201650"},{"UniStopId":"2324201570","Name":"碧湖","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.744893,"Latitude":24.89092,"PublicId":"2324201570"},{"UniStopId":"2324201400","Name":"碧湖橋","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.743256,"Latitude":24.893512,"PublicId":"2324201400"},{"UniStopId":"2324201360","Name":"青山農場","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.73404,"Latitude":24.895567,"PublicId":"2324201360"},{"UniStopId":"2324201250","Name":"三份子","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.731447,"Latitude":24.894971,"PublicId":"2324201250"},{"UniStopId":"2324201000","Name":"石嘈派出所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.720087,"Latitude":24.902347,"PublicId":"2324201000"},{"UniStopId":"2324200910","Name":"乾溝子","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.71924,"Latitude":24.905751,"PublicId":"2324200910"},{"UniStopId":"2324101470","Name":"清潔隊","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.718039,"Latitude":24.910622,"PublicId":"2324101470"},{"UniStopId":"2324200870","Name":"保安宮牌樓","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.707003,"Latitude":24.919635,"PublicId":"2324200870"},{"UniStopId":"2324101570","Name":"金華茶莊","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.70666,"Latitude":24.921625,"PublicId":"2324101570"},{"UniStopId":"2324201800","Name":"九芎林","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.707743,"Latitude":24.924467,"PublicId":"2324201800"},{"UniStopId":"2324200770","Name":"協德宮牌樓","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.707586,"Latitude":24.930919,"PublicId":"2324200770"},{"UniStopId":"2324100600","Name":"坪林國中","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.712961,"Latitude":24.93705,"PublicId":"2324100600"}],"RouteMapUrl":"../MapOverview?nid=0454072380","RouteTracks":null,"StopDirection":null,"TicketPrice":"","BusTimeDesc":"0800 - 1630","HeadwayDesc":"F723上石嘈班表:0800 1200 1630","HolidayBusTimeDesc":"0800 - 1630","HolidayHeadwayDesc":"F723上石嘈班表:0800 1240 1630","RouteNote":"","SegmentBuffer":"","StopLng":0,"StopLat":0,"IsNtpcMainLine":false,"orgphone":"坪林區公所坪林區公所站:(02)2665-7251","aliasName":null,"aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":null,"wkt0":"LINESTRING (121.712894166376 24.9370387447425, 121.712985522413 24.9372885464059, 121.71295840109 24.9373013933486, 121.712836281103 24.9369787481571, 121.712647493755 24.9366183359473, 121.712504224305 24.9363870154814, 121.713024063241 24.9354153907899, 121.712845633481 24.9351787929287, 121.712658078887 24.9349976668957, 121.712358877097 24.9347141618348, 121.712123076915 24.9345314846712, 121.711447612112 24.9341693237892, 121.711376799701 24.9339554784971, 121.711294008292 24.9338569852698, 121.711179813246 24.9337956054325, 121.710832945793 24.9337599194806, 121.710250551058 24.9334919179817, 121.710089250556 24.9333866444236, 121.709887981787 24.933189657969, 121.709401556769 24.9323915608921, 121.70930701449 24.9322910856998, 121.709217085891 24.9322425528052, 121.709060067702 24.9322311333006, 121.708326364531 24.9324481038882, 121.707148728118 24.9324338295075, 121.706991709929 24.9324124179363, 121.70691729587 24.9323157112015, 121.706884699422 24.9321998127205, 121.706891943077 24.9319969903786, 121.707011556003 24.9316836032477, 121.707199798418 24.9312508939069, 121.707373646139 24.930924929429, 121.707612686756 24.9307510817074, 121.707898811132 24.9307293507422, 121.708072658853 24.9306786451567, 121.708206666472 24.9305084192627, 121.708418060204 24.9298951185356, 121.708417720568 24.9296970738552, 121.708195040228 24.9291310946578, 121.70820074998 24.9289169789463, 121.708263557256 24.9287228473679, 121.708397736435 24.9284295088432, 121.708433422387 24.9282682083405, 121.708414865692 24.9280854962667, 121.708242806023 24.9274797983311, 121.708164353887 24.9270506230003, 121.708241958172 24.9267819927818, 121.708675650266 24.9263643527811, 121.70865087306 24.926128325917, 121.708005131396 24.9253465992371, 121.707752454219 24.9247045857592, 121.707543519604 24.9243822294971, 121.707234604411 24.9243463329447, 121.706952533124 24.924119568839, 121.706854035377 24.9236002170834, 121.706737628949 24.923477841095, 121.706495861752 24.923522612798, 121.706104855546 24.9238748168622, 121.705713849339 24.9238807864226, 121.70549461113 24.9233365995889, 121.705370599615 24.922779402527, 121.705407681255 24.9223889381184, 121.705570579889 24.9221108117611, 121.705879735668 24.921919677495, 121.706163795845 24.9218015569942, 121.706469267593 24.9216902168242, 121.706580607763 24.921564959133, 121.706577752887 24.9214107958207, 121.706359354861 24.9210596460539, 121.706340798166 24.9209058396011, 121.706445001146 24.920278837426, 121.706566333382 24.9200333180768, 121.706856103312 24.9195972357444, 121.707031678195 24.9194202334229, 121.707251503659 24.9192760621772, 121.707591002326 24.9191615987754, 121.707821765171 24.9191243968816, 121.708068711958 24.9191479496098, 121.708189330476 24.9191379575433, 121.70828996486 24.9190887109296, 121.708340638912 24.9190280448114, 121.708356340731 24.9189431122458, 121.70834920354 24.9188526483577, 121.708318513622 24.91865798149, 121.708332074283 24.9185466413201, 121.708404159906 24.91842049148, 121.708518354952 24.9183062964339, 121.708808124882 24.9182220775874, 121.709346269037 24.9181549879978, 121.709718830375 24.9180911101439, 121.709921526581 24.9180268754304, 121.710040003942 24.9179340919555, 121.710062842951 24.9177717208742, 121.71003429419 24.9176946392181, 121.709981478981 24.9176193418596, 121.70973738707 24.9174252102812, 121.709691709051 24.9173409914346, 121.709678862108 24.9172382158931, 121.70971454806 24.9171686282869, 121.709795912031 24.9170530058027, 121.710291233043 24.9166932914074, 121.71041970247 24.9165309203262, 121.710519623136 24.9162839735389, 121.710589567601 24.915771880129, 121.710652374877 24.9155727525173, 121.710740876037 24.9154214440812, 121.71086506315 24.9152216027504, 121.710990677701 24.9150931333235, 121.711193373908 24.9149949969558, 121.711346109782 24.9149721579466, 121.711865697242 24.9149593110039, 121.712084095267 24.9149678756323, 121.712295356103 24.9149025703403, 121.712667917441 24.9146773919837, 121.713023349522 24.9145189463572, 121.71320320672 24.9143822691614, 121.713538654668 24.9139758061691, 121.714069661632 24.9133070514302, 121.71459067653 24.9126083204918, 121.714938971421 24.9122760842794, 121.714978939687 24.9121947203091, 121.714986076877 24.9120862350153, 121.714871881831 24.9118553469064, 121.7147319929 24.9116515801209, 121.714679177691 24.9115074088752, 121.714682032567 24.9113536024225, 121.714773388604 24.9112251329956, 121.714893293402 24.9111080830733, 121.715044601838 24.911018511334, 121.715204474903 24.9109785430678, 121.715517083842 24.910999954639, 121.71600098535 24.9110970204282, 121.716206536433 24.911094165552, 121.717299953999 24.9107847683489, 121.717515497149 24.9107533647113, 121.717691072032 24.9107776311586, 121.717923744439 24.9106862751217, 121.717965140143 24.9106006288371, 121.717936591381 24.9104197010609, 121.717753879308 24.9101813189021, 121.717739604927 24.9100792570796, 121.717810976831 24.9098836980631, 121.717992261466 24.9096356806973, 121.718159271721 24.9094829448231, 121.718406218509 24.9093377029988, 121.718660302486 24.9092520567142, 121.719011452253 24.9092277902669, 121.71950391839 24.9090283057957, 121.720308993465 24.9086732305742, 121.720421761073 24.9086561013173, 121.7205502305 24.9086817952026, 121.721288215985 24.9091196618326, 121.721470928059 24.9091339362134, 121.721627946247 24.9090782661284, 121.72185633634 24.9089326674446, 121.721912006425 24.9087999157035, 121.721896304606 24.9085847294134, 121.72179638394 24.9083938095707, 121.721673624266 24.9082539206392, 121.721065535645 24.907813199133, 121.720358953797 24.9071758480319, 121.720239048999 24.907141589518, 121.719833656585 24.9071059035661, 121.719730881044 24.9070759273665, 121.719649517073 24.9070220415791, 121.719562443351 24.9069206934757, 121.719402570286 24.9063789807256, 121.719302649621 24.9062922638625, 121.719167043003 24.9061695041879, 121.719067122338 24.9060296152564, 121.719037146138 24.9059182750864, 121.719052847957 24.9057930173952, 121.719112800357 24.9056602656541, 121.71924412466 24.9055250158963, 121.719512483018 24.9053308843179, 121.719665218892 24.9052809239852, 121.719812245014 24.9052737867948, 121.720032070478 24.9053308843179, 121.720199080733 24.9053337391941, 121.720672990174 24.9051931365435, 121.721275369042 24.905183144477, 121.721466645745 24.9051517408393, 121.721776399807 24.9049818757082, 121.722003362461 24.9049618915751, 121.722460142646 24.9050375457932, 121.722610023644 24.9050289811647, 121.723003996553 24.9048152223128, 121.723155304989 24.9046653413147, 121.723171006808 24.9045183151928, 121.723101062342 24.9044012652705, 121.72283555886 24.9042745801413, 121.722253164125 24.9040765231081, 121.721449516488 24.9038442075612, 121.721308200118 24.90374856921, 121.721005583246 24.9034420268831, 121.720289009332 24.9030341364527, 121.72007489362 24.9028874671904, 121.719984965021 24.9027261666877, 121.719930722374 24.902581995442, 121.719939287003 24.9024496005604, 121.720166249657 24.9017751360692, 121.720274734951 24.9016680782134, 121.720360381235 24.9016152630046, 121.720553085376 24.9015810044908, 121.720842855305 24.9015810044908, 121.721235400776 24.9016366745757, 121.721416685412 24.901622400195, 121.721570848724 24.9015567380435, 121.72170788278 24.9014125667977, 121.721894877168 24.9011178008349, 121.722344520162 24.9004276345249, 121.722882664317 24.8996047164738, 121.72320669276 24.8989359617349, 121.723238096398 24.898779300406, 121.723249515902 24.8984688326243, 121.723255225655 24.8983746217113, 121.723356573758 24.8982490071605, 121.723574971784 24.8982033291421, 121.724173068338 24.8983817589017, 121.724297255451 24.8983674845209, 121.724410023059 24.8982904028648, 121.724462838267 24.8981490864952, 121.724488532153 24.8978796575582, 121.724581315628 24.8975288646509, 121.724666961912 24.897297976542, 121.724749753321 24.8972066205051, 121.724878222748 24.8971309662871, 121.725008119613 24.897129538849, 121.725323583428 24.8971652248009, 121.725443488226 24.897148095544, 121.725529134511 24.8970885000043, 121.725687580137 24.8967262875924, 121.725810339812 24.8966135199843, 121.726314225453 24.8962684368293, 121.726409863804 24.8961471045928, 121.726751021504 24.8951678820723, 121.726916604321 24.8948609828858, 121.727193527308 24.8947485721373, 121.727350545496 24.89476141908, 121.727623186169 24.894837073298, 121.727765929977 24.8948513476788, 121.727871560394 24.8948070970984, 121.727932940232 24.8947300154423, 121.728095668172 24.894389571461, 121.728152765695 24.8943067800526, 121.728326913141 24.8942197063299, 121.728756572002 24.8940969466553, 121.729093447388 24.8940812448365, 121.729253320452 24.8940369942561, 121.72950026724 24.8939570577238, 121.729695826256 24.8939484930954, 121.729849989568 24.8939898887996, 121.730312479505 24.8941940124445, 121.730616523815 24.8944720060099, 121.730873462669 24.8946004754368, 121.731067594248 24.8946529337861, 121.731320250787 24.8947000392427, 121.731445865338 24.89476141908, 121.731540076251 24.8948442104884, 121.73156291526 24.8949027354495, 121.73155577807 24.8950754554568, 121.731464422033 24.8953149081941, 121.731415889138 24.8954844164657, 121.731381630625 24.8956328700257, 121.731424453767 24.8960807287222, 121.731530084184 24.8963858436111, 121.731564342698 24.8967209346996, 121.731644279231 24.8968094358603, 121.731765611467 24.8968351297457, 121.73188979858 24.8968251376792, 121.731999711312 24.8967280718899, 121.732108196606 24.896421529563, 121.732158156938 24.8961860022804, 121.732208117271 24.8960047176447, 121.73226806967 24.8959390554931, 121.73238654703 24.8958623306965, 121.732767672997 24.8957695472215, 121.733068862431 24.8956610619277, 121.73338860856 24.8953973427431, 121.733534207244 24.8953516647246, 121.733688370556 24.8953530921627, 121.733902486268 24.8954130445619, 121.734529131583 24.8956642736634, 121.735524055923 24.8961678024449, 121.735860931309 24.8961920688922, 121.73611216041 24.8962377469106, 121.736239202399 24.896207770711, 121.73633484075 24.8960807287222, 121.736317711493 24.8957738295358, 121.736347687693 24.895609674157, 121.736815887382 24.8949705387582, 121.736941501933 24.8948567005716, 121.737244118805 24.8947139567639, 121.737362596165 24.8945911970893, 121.737389717489 24.894472719729, 121.737401136993 24.8942489688105, 121.737433968069 24.894164749964, 121.737588131381 24.8940280727681, 121.737802247093 24.8939638380547, 121.738002088424 24.8939381441693, 121.738196220002 24.8939752575593, 121.738324689429 24.8940865977293, 121.738336108934 24.8942036476515, 121.738327544305 24.8944662962576, 121.738404625961 24.894771768006, 121.738510256379 24.8949316410706, 121.73896989143999 24.8953134807561, 121.739164023018 24.8954390953068, 121.739937694455 24.8957324338315, 121.740879803586 24.8960000784709, 121.741416520303 24.8959743845855, 121.741756250565 24.8958687541679, 121.742452840346 24.895349880427, 121.742661246306 24.8950793809115, 121.743072348472 24.8942607451746, 121.743163704508 24.8937076129199, 121.743255060545 24.8928404442884, 121.743172269137 24.8926505950242, 121.742909620531 24.8923451232758, 121.742875362017 24.8922252184774, 121.742875362017 24.892162411202, 121.742929604664 24.8920567807844, 121.743018105825 24.8919996832613, 121.743200817898 24.8919226016052, 121.743549112789 24.8918398101967, 121.744057280744 24.8917741480452, 121.744239992818 24.891677795975, 121.744822387553 24.891155353639, 121.744848081439 24.8909754964414, 121.744748160773 24.8905651079944, 121.744753870526 24.8904166544344, 121.745125004426 24.889401745962, 121.745105020293 24.8891655049603, 121.745045067893 24.8889628087534, 121.74491374359 24.8888200649458, 121.744628255975 24.8885802553489, 121.744422704892 24.8884810484026, 121.743757518748 24.8882440936819, 121.743454901876 24.8881070596265, 121.743354981211 24.8880214133419, 121.743283609307 24.8879471865619, 121.743257915422 24.8878444110204, 121.743255060545 24.8877559098597, 121.743289319059 24.8876602715086, 121.743866004042 24.8870921511541, 121.744182895295 24.8866346572505, 121.744288525713 24.8861728810328, 121.744331348855 24.8860643957389, 121.74445410853 24.8859016677982, 121.744596852337 24.8857878296116, 121.744622546223 24.8857064656412, 121.744608271842 24.8855737139001, 121.744442689025 24.8853146338892, 121.744314219598 24.8852075760335, 121.74404586124 24.8850919535493, 121.743953077765 24.8849720487509, 121.743924529003 24.8848535713905, 121.743931666194 24.8847011923758, 121.74405299843 24.8843600346755, 121.74415720141 24.8836816447296, 121.744204306866 24.883595998445, 121.744307082408 24.8835531753027, 121.744541182252 24.883538900922, 121.744782419287 24.8836045630735, 121.744956566733 24.8836944916723, 121.745019374008 24.8837787105188, 121.745050777646 24.8838582901916, 121.745072189217 24.8840195906943, 121.745072189217 24.8841651893781, 121.74509931054 24.8842779569861, 121.745162117816 24.8843793050896, 121.745293442119 24.8844635239361, 121.745597486429 24.8845188371615, 121.745868699664 24.884545958485, 121.746030000166 24.8845288292281, 121.746229841497 24.8843950069084, 121.746625241844 24.8842037302061, 121.746772267966 24.8841666168161, 121.746870761193 24.8840952449123, 121.747004940373 24.8838300982896, 121.747080594591 24.8837544440715, 121.74721477377 24.8837130483673, 121.747367509644 24.8837230404338, 121.747730078915 24.883855792175, 121.748219690176 24.88412664855, 121.748378135802 24.8841780363208, 121.748726430693 24.8841594796258, 121.749014773184 24.8840381473893, 121.749253155343 24.8838754194485, 121.749390189398 24.8836759349773, 121.74964855569 24.8831841825599, 121.749735629413 24.8829757766008, 121.749799864126 24.8828787108116, 121.749976866448 24.8827716529558, 121.750033963971 24.8826963555973, 121.749944035372 24.8823323588877, 121.749979721324 24.8822195912797, 121.750008270086 24.8821610663186, 121.750556406307 24.8818459593632, 121.750627778211 24.8817720894427, 121.750904701198 24.8813427874412, 121.751317230802 24.8808995679184, 121.751572742218 24.880762533863, 121.751649823874 24.8806155077412, 121.751608428169 24.8804927480666, 121.75138574783 24.880257934503, 121.751153075423 24.879782954483, 121.750776231771 24.8793108293392, 121.750632060525 24.8792498063614, 121.750322306462 24.8792027009049, 121.75008677918 24.8791527405722, 121.748916279957 24.8784640017003, 121.748359579107 24.8782987757429, 121.748191141414 24.8782388233437, 121.748074091492 24.8781246282975, 121.748071236616 24.878039695732, 121.748104067691 24.8776749853034, 121.748159737776 24.8774680067823, 121.748408112002 24.8769698308936, 121.748535153991 24.8768699102282, 121.748667905732 24.8768542084094, 121.748812076977 24.8768627730379, 121.749101846907 24.8769441370082, 121.749484400312 24.8771710996624, 121.74960430511 24.8772025033001, 121.750533567298 24.8772139228047, 121.750707714743 24.8772424715662, 121.751157357737 24.8774651519062, 121.751985271822 24.8775946919116, 121.752581940938 24.8775586491002, 121.753150061292 24.877704247784, 121.753912313225 24.8778241525824, 121.754527539036 24.8778812501055, 121.754980036906 24.8778869598578, 121.755151329475 24.8778212977063, 121.755446809157 24.8773580940504, 121.755478212795 24.8772342637973, 121.755439671967 24.8766265320362, 121.755511043871 24.8763924321916, 121.755693755945 24.8759035346504, 121.755973533808 24.875504565708, 121.756124842244 24.8752761756158, 121.756321828698 24.8752304975973, 121.756493121267 24.8752476268542, 121.757078370879 24.8754617425657, 121.757246808572 24.8755245498411, 121.757577974206 24.8757493713381, 121.758131820179 24.8765002037664, 121.758325951758 24.8766486573264, 121.758719924667 24.8768192361765, 121.759008267158 24.8768877532042, 121.759425079077 24.8769134470896, 121.759653469169 24.8768820434519, 121.7598533105 24.8768021069196, 121.76005315183 24.8766522259216, 121.760217307209 24.8766465161693, 121.760425713168 24.8767421545204, 121.760512786891 24.8768149538623, 121.760665522765 24.8770486968473, 121.760784000126 24.8771400528842, 121.760946728066 24.877154327265, 121.761142287083 24.8770715358566, 121.76157480082 24.8768028206387, 121.761603349582 24.8767000450971, 121.761708979999 24.8765344622803, 121.761803190912 24.8763888635964, 121.761928805463 24.8756644387726, 121.761883127445 24.8755338281886, 121.761874562816 24.8754167782663, 121.761914531082 24.8753197124771, 121.762028012409 24.8752404896638)","wkt1":"LINESTRING (121.76187884513 24.8752968734679, 121.761907393892 24.8753853746286, 121.761901684139 24.8755366830647, 121.761938797529 24.8756615838964, 121.761827457359 24.8763603148349, 121.761556244125 24.8768399340286, 121.761416355193 24.8769484193225, 121.761139432206 24.8771025826347, 121.760931026247 24.8771846603241, 121.76078828244 24.8771618213149, 121.76065410326 24.8771018689157, 121.76061698987 24.8770390616403, 121.760457116806 24.8768021069196, 121.760237291342 24.8766736374927, 121.760014611002 24.8766764923689, 121.759849028185 24.8768249459288, 121.759640622226 24.8769248665942, 121.759412232134 24.8769448507273, 121.759061082367 24.876922011718, 121.758826982522 24.8768734788234, 121.758304540186 24.876660076831, 121.75811611836 24.8765230427756, 121.757839195373 24.876137634495, 121.757516594368 24.8757386655526, 121.757259655514 24.8755473888503, 121.756317546384 24.8752419171019, 121.756183367205 24.8752761756158, 121.756106285548 24.8753475475196, 121.755740861401 24.8759006797743, 121.755481067671 24.8766308143504, 121.755515326185 24.8772210599951, 121.755478212795 24.8773809330597, 121.755295500721 24.8776550011704, 121.755161321542 24.8778548425011, 121.754987174096 24.8779205046526, 121.754570362178 24.877909085148, 121.753928015044 24.8778576973772, 121.753105810712 24.8777292279503, 121.752563384242 24.8775950487711, 121.751961005374 24.8776264524088, 121.751153075423 24.8775008378581, 121.750696295238 24.8772667380135, 121.750530712421 24.8772353343759, 121.749534360644 24.8772153502428, 121.749451569236 24.8771896563574, 121.749069015831 24.8769726857698, 121.748789237968 24.876884184609, 121.748603671018 24.8768927492375, 121.748438088201 24.8770040894074, 121.748266795632 24.8773438196697, 121.74814974571 24.8776371581944, 121.748101212815 24.8780532563937, 121.748138326205 24.8781389026783, 121.748255376127 24.8782388233437, 121.748931981776 24.8784329549221, 121.750091061494 24.8791059919752, 121.750196691911 24.8791373956129, 121.750647762344 24.879214477269, 121.75079907078 24.8792744296682, 121.75120731807 24.8797990131614, 121.751427143534 24.8802465149984, 121.751635549493 24.8804691953383, 121.751692647016 24.8806112254269, 121.751675517759 24.8806825973308, 121.751638404369 24.8807454046061, 121.751552758084 24.8808110667577, 121.751341497249 24.8809338264322, 121.750924685331 24.8813699087646, 121.750633487963 24.8818231203539, 121.750556406307 24.881880217877, 121.750031109095 24.8822106697917, 121.750008270085 24.8822306539248, 121.749993995705 24.8823534135994, 121.750085351742 24.882644610967, 121.750073932237 24.8827074182424, 121.750025399342 24.8827873547747, 121.749842687268 24.8828701461831, 121.749777025117 24.8829500827154, 121.749694233709 24.8831727630553, 121.749440149731 24.88365166853, 121.74927742179 24.8838793449032, 121.749177501125 24.8839564265594, 121.748971950042 24.8840906057386, 121.748726430693 24.8841876715278, 121.748380990678 24.8842048007847, 121.74820113348 24.8841534130139, 121.747929920246 24.8839792655686, 121.747376074272 24.8837594401048, 121.747293282864 24.8837366010956, 121.747099151285 24.8837765693617, 121.747039198886 24.8838393766371, 121.746899309955 24.884116299624, 121.746796534413 24.884173397147, 121.746608112587 24.8842447690508, 121.746279801829 24.8844046421154, 121.746139912898 24.8845009941856, 121.746068540994 24.8845409624517, 121.745954345948 24.884563801461, 121.745763069246 24.884563801461, 121.745260611043 24.8844838649287, 121.74518067451 24.8844267674056, 121.745100737978 24.8843439759972, 121.745052205084 24.8842069419418, 121.745023656322 24.8838736351509, 121.744946574666 24.8837280364671, 121.744826669867 24.8836395353064, 121.744529762748 24.8835653085264, 121.744289953151 24.883576728031, 121.744227145875 24.8836166962972, 121.744184322733 24.8837394559717, 121.744092966696 24.8843553955018, 121.743981626526 24.8846779965071, 121.743973061898 24.8848400107288, 121.743981626526 24.8849599155272, 121.744095821572 24.8850848163589, 121.74431279216 24.8851561882627, 121.744464100596 24.8852875125658, 121.744638248041 24.8855273221626, 121.744663941927 24.8856729208464, 121.744643957794 24.8857557122549, 121.744601134651 24.8858499231679, 121.744472665224 24.8859384243287, 121.744338486045 24.8861411205356, 121.744215726371 24.8866400101433, 121.743918819251 24.8870960766088, 121.743330714763 24.8876484951444, 121.743287891621 24.8877798194475, 121.743305020878 24.8879082888743, 121.743404941543 24.8880281936728, 121.743510571961 24.8880967107005, 121.744641102917 24.8885556320421, 121.744912316152 24.8887726026297, 121.745075044093 24.8889660204891, 121.74514356112 24.8891230386775, 121.74516640013 24.889300040999, 121.745152125749 24.8894456396828, 121.744789556477 24.8904041643512, 121.744778136973 24.8905747432014, 121.744849508877 24.8908088430459, 121.744892332019 24.8909737121438, 121.74486949301 24.8910850523138, 121.744818105239 24.8911735534745, 121.744249984885 24.891686717463, 121.744055853306 24.8917944890378, 121.743393522039 24.8919001194555, 121.743062356405 24.8920057498731, 121.742979564996 24.8920514278916, 121.74290248334 24.8921506348379, 121.742911047969 24.892244845751, 121.742945306483 24.8923362017879, 121.743213664841 24.8926216894032, 121.743302166002 24.8928529343716, 121.743205100212 24.8936915542416, 121.743108034423 24.8942525374057, 121.742699787133 24.8950854475233, 121.74249423605 24.8953366766248, 121.741814775526 24.8958726796226, 121.741577820805 24.8959668905356, 121.741286623438 24.8960097136779, 121.740886940776 24.8960125685541, 121.740227464385 24.895844130861, 121.739413824681 24.8955672078742, 121.739011287143 24.8953652253863, 121.738466005798 24.8949569780964, 121.73838321439 24.8947913952796, 121.738294713229 24.8944809274979, 121.738311842486 24.8942125691395, 121.738303277858 24.8941155033503, 121.73819764744 24.8940070180565, 121.738074887765 24.8939727595426, 121.737843642797 24.893978469295, 121.737626672209 24.8940469863226, 121.737495347906 24.8941297777311, 121.737461089392 24.8942611020341, 121.737441105259 24.8944980567548, 121.737355458975 24.8946493651909, 121.737224134672 24.894762846518, 121.736984325075 24.8948542025549, 121.736847291019 24.8949598329726, 121.73671311184 24.8951625291795, 121.73640193034 24.8956243053972, 121.736344832816 24.8957756138334, 121.736381946206 24.8960982148387, 121.736333413312 24.8961860022804, 121.736222073142 24.8962459546796, 121.736110732972 24.8962687936888, 121.735525483361 24.8962002766611, 121.735365610296 24.8961403242619, 121.734726118038 24.8957727589572, 121.733855380811 24.8954216091904, 121.733589877329 24.8953787860481, 121.733384326246 24.895433028695, 121.733090274002 24.8956928224249, 121.73275054374 24.8958013077187, 121.732393684221 24.8958898088795, 121.732319457441 24.8959212125172, 121.732248085537 24.8960154234302, 121.732196697766 24.8962095550086, 121.732116761234 24.8965435755185, 121.732011130816 24.896737707097, 121.731885516265 24.8968433375146, 121.731739917581 24.8968690314, 121.731639996916 24.8968262082577, 121.731537221375 24.896774820487, 121.731537221375 24.8966977388308, 121.731474414099 24.896403686587, 121.731348799549 24.895890165739, 121.73134023492 24.8956164544878, 121.731344517234 24.8955422277078, 121.731403042195 24.8952984926563, 121.731515809803 24.8950761691758, 121.731514382365 24.8949191509874, 121.731441583024 24.8948035285032, 121.731330242854 24.8947421486659, 121.730964818706 24.8946725610597, 121.730759267623 24.8945969068416, 121.730593684806 24.8945055508047, 121.73029392281 24.8942289846774, 121.729834287749 24.89402664533, 121.729690116504 24.893988104502, 121.729497412363 24.8940009514447, 121.729119141273 24.8941076524409, 121.728752289687 24.8941319188882, 121.728354034464 24.8942318395535, 121.728198443714 24.8943246230285, 121.728131354124 24.8943931400562, 121.727974335936 24.8947507132944, 121.72790439147 24.8948349321409, 121.727788768986 24.894883108176, 121.727618903854 24.8948759709856, 121.727356255248 24.8947946070152, 121.727189244993 24.8947860423868, 121.726956572587 24.8948902453664, 121.726809546465 24.8951286275251, 121.726638253896 24.8956375091994, 121.726528341164 24.8959954392971, 121.726441267441 24.8961749396353, 121.726347056528 24.8962848523672, 121.725830323945 24.8966427824649, 121.725731830717 24.8967598323871, 121.725636192366 24.896990720496, 121.725556255834 24.8971231153776, 121.725453480292 24.8971759305865, 121.725340712684 24.8971944872815, 121.725075209202 24.8971687933961, 121.724889642252 24.8971645110818, 121.72477972952 24.897223036043, 121.72470550274 24.8973086823276, 121.724619856456 24.8975352881222, 121.724537065047 24.8978746615249, 121.724507088848 24.8981740666615, 121.724454273639 24.8982950420385, 121.72440145843 24.8983592767519, 121.724278698755 24.898416374275, 121.724165931147 24.8984178017131, 121.723574971784 24.8982322347631, 121.723380840205 24.8982893322862, 121.723308040863 24.8983706962565, 121.723293766482 24.8984577699792, 121.72328091954 24.8987882218939, 121.723216684826 24.8989994827293, 121.722958318534 24.8995526149839, 121.72260574133 24.9000643515344, 121.721742141293 24.9014375469641, 121.721542299963 24.9016113375499, 121.721448089049 24.9016498783779, 121.7212325459 24.9016798545775, 121.721068390521 24.9016555881302, 121.720767201087 24.901614192426, 121.720507407357 24.9016241844926, 121.720330405035 24.9016612978826, 121.720201935609 24.9017969044998, 121.719977827831 24.9024610200649, 121.719976400393 24.9025752151111, 121.720017796097 24.9027179589187, 121.720121999076 24.9028692673548, 121.720286154455 24.9029873878557, 121.721036986883 24.9034081252288, 121.721323901937 24.9037146675557, 121.721468073183 24.9038242234281, 121.722608596206 24.9041536047642, 121.723129611104 24.9043759282447, 121.723212402512 24.9044658568435, 121.723223822017 24.9045329464331, 121.723203837884 24.9046567766862, 121.723056811762 24.9048223595031, 121.722631435215 24.9050507495954, 121.722498683474 24.9050735886046, 121.722071879489 24.9050050715769, 121.721774972369 24.9050079264531, 121.721466645744 24.905183144477, 121.721305345242 24.9052074109243, 121.720680127364 24.9052345322477, 121.720196225856 24.9053526527486, 121.720047772296 24.9053740643197, 121.719812245014 24.9053069747301, 121.719689485339 24.9053084021682, 121.719513910456 24.9053594330794, 121.719262681354 24.9055478549055, 121.719169897879 24.9056534853232, 121.719119937547 24.905733064996, 121.719091388785 24.9059129221936, 121.71911708267 24.9060110585614, 121.719208438707 24.9061452377406, 121.719452530618 24.9064071726276, 121.719618113435 24.9069267600875, 121.719720888977 24.9070238258767, 121.719806535261 24.9070723587713, 121.720209072799 24.9071094721613, 121.720363236111 24.9071380209228, 121.721042696636 24.9077511055767, 121.721762125426 24.9082985280791, 121.721919143615 24.9085040791621, 121.721964821633 24.9086610973505, 121.721953402129 24.9088038411582, 121.721862046092 24.9089580044705, 121.721665059637 24.9090893287735, 121.721448089049 24.9091521360489, 121.721265376976 24.9091264421635, 121.720802887039 24.9088552289289, 121.720454592148 24.9086896461121, 121.720291864207 24.9087039204928, 121.719335480696 24.9091292970397, 121.719015734567 24.9092492018381, 121.718656020172 24.9092777505996, 121.718419065451 24.9093576871319, 121.718193530235 24.9094968623444, 121.718036512046 24.9096082025143, 121.717850945097 24.9098787020299, 121.71779670245 24.9100407162515, 121.71781097683 24.9101863149354, 121.7179822694 24.9103747367615, 121.718013673037 24.9105688683399, 121.717987979152 24.9106630792529, 121.717899477991 24.9107344511568, 121.717696781784 24.9107886938037, 121.717468391692 24.9107829840514, 121.716209391308 24.9111048713376, 121.716009549978 24.9111191457184, 121.715204474903 24.9110078055484, 121.71503603721 24.911056338443, 121.71486474464 24.9111648237368, 121.714733420337 24.9113411123393, 121.714722000833 24.9114239037477, 121.714744839842 24.9115666475554, 121.71503603721 24.9120855212962, 121.715016053076 24.9121968614662, 121.714981794563 24.9122796528746, 121.714907567783 24.9123538796546, 121.714644919177 24.9126158145417, 121.713976878157 24.9134572892878, 121.713266013995 24.9143958298231, 121.713051898283 24.9145300090023, 121.712403841396 24.9148718804217, 121.71208980502 24.9149939263772, 121.711210503164 24.9150053458818, 121.710996387453 24.9151309604326, 121.710762287608 24.9154078834194, 121.710636673058 24.9157618880624, 121.710593849915 24.9161465826241, 121.710511058507 24.916425646768, 121.710365459823 24.9166511819841, 121.70990011501 24.9170051866271, 121.709780210212 24.9171415069634, 121.70971454806 24.9172549882905, 121.709765935831 24.9174062967266, 121.71001145518 24.9175861539243, 121.710088536836 24.9176775099612, 121.710102811217 24.9177774306265, 121.71008568196 24.9178887707965, 121.710042858818 24.9179886914619, 121.709928663772 24.918065773118, 121.70975166145 24.9181200157649, 121.709257767876 24.918196383702, 121.708752454796 24.9182649007297, 121.708521209828 24.9183591116427, 121.708395595277 24.9184932908219, 121.708375611144 24.9186445992581, 121.70841557941 24.9189036792689, 121.708395595277 24.919035003572, 121.708309948993 24.9191177949804, 121.708195753947 24.9191691827512, 121.708061574767 24.9191806022558, 121.707836039551 24.9191634729989, 121.707594260868 24.9191946815008, 121.707203254661 24.9193379509507, 121.706942463315 24.919538175494, 121.706788370212 24.9197379114981, 121.706498846533 24.9202333850121, 121.706382440105 24.9207855693501, 121.706421242247 24.9211168799528, 121.706624207301 24.9215795208846, 121.705597442911 24.9221346900027, 121.705427310439 24.9223943658805, 121.705397462637 24.9227674634062, 121.705525808186 24.9233375564253, 121.70573772758 24.923856908181, 121.706104855546 24.92384198428, 121.706480937851 24.923477841095, 121.706734644169 24.9234300846117, 121.70689880708 24.9235882779625, 121.706976411365 24.924104644938, 121.707248026364 24.9243076099919, 121.707561428286 24.9243553664752, 121.70777633246 24.9246896618582, 121.708024069217 24.9253373591626, 121.708683705643 24.926128325917, 121.708701614324 24.9263730778938, 121.708280760315 24.9268028862433, 121.70821211037 24.9270386838795, 121.708265836414 24.9274804313498, 121.70850461883 24.9282952763458, 121.708283745095 24.9287400085963, 121.70820912559 24.9291847408468, 121.708429999325 24.9295787318339, 121.708438953666 24.9299130272169, 121.708098688157 24.9306036754636, 121.707938815093 24.9307035961289, 121.707531580484 24.9307666743555, 121.707343539331 24.9309308372668, 121.706991335266 24.9316382301753, 121.706868959278 24.9320740080853, 121.706931639662 24.9323605469849, 121.707359988953 24.9324115257875, 121.708280760315 24.9324321817099, 121.709191118277 24.932172505832, 121.709414976793 24.9323635317651, 121.709994024153 24.9332858288485, 121.710311930895 24.9335006610399, 121.710856625632 24.9337604089011, 121.711165538865 24.9337768703078, 121.71132541193 24.9338625165924, 121.711396783833 24.9339710018862, 121.711468505574 24.9341514151079, 121.711630883678 24.9342586306586, 121.71214008112 24.9345095887325, 121.712677341557 24.9349811840049, 121.712877750838 24.9351836105322, 121.713038499962 24.9354318858159, 121.712522132986 24.9363870154814, 121.712657940486 24.9366093816067, 121.712907013318 24.9370913815216)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0454072380'=='0100020200' || '0454072380'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
