
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231493275</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0171002000">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0171002000">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0171002000" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0171002000" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0171002000" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0171002000',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="U5ZoDpyuieyLQgeehUrqWJ7C-bL40dlsY83xh_Slt-OFmSOed4jjLEr_J_RGA8G40acb4mm9dmu7-RmBT2Fp2-zafUY1" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/taipei_city.svg" width="100%" class="vipstop-city" alt="臺北市">                
 <span class="stationlist-title">花季專車124 </span>                 

                        <a href="../EBus/VsSimpleMap?routeid=0171002000" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0171002000" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">臺北市公共運輸處公車申訴服務電話02-27291181</a>                </div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">陽明山 - 小油坑</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 0800 - 1600 <br>
                        [假日] 0800 - 1600
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> 花季及海芋季期間平日視需求彈性行駛；繡球花季視需求彈性行駛(豪大雨30-60分，大雨特報停駛)<br>
[假日]<br /> 尖峰:30分至60分<br/>離峰:30分至60分<br/>花季及海芋季例假日30-60分，視人潮天候彈性調度；繡球花季視需求彈性行駛(豪大雨30-60分，大雨特報停駛)<br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content">一段票</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">大都會客運陽明山站:02-2861-6206</span>
                </li>

                    <li>
                        <span class="stationlist-move-route-bus-item">備註 :</span>
                        <span class="stationlist-move-route-bus-content">本路線僅花季、繡球花季、海芋季期間(114年1月24日至6月22日)行駛</span>
                    </li>
            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 小油坑</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 陽明山</a>
                </p>


            <p> 
</p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">陽明山總站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129102120" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="25.15148" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.54603" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">陽明山國家公園管理處</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129201500" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.15532" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54608" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">童軍站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129202000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.158318" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5468387" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">磺仔外</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200500" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.16067" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54528" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">氣象台</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129201100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.16172" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54429" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">陽明書屋</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129202100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.163105" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5448478" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">竹子湖派出所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200600" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.16727" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5404" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">頂湖山</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129201700" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.173294" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.540701" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">游園站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129201800" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.17508" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.541178" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">百拉卡公路入口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200060" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.179701" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54296" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">小觀音棧</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200121" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.179995" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5465214" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">小油坑服務站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200100" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.176902" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.547521" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">小觀音棧</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200160" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.180168" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5466289" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">百拉卡公路入口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200020" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.179585" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5428901" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">頂湖山</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129201740" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.1732" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54048" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">竹子湖派出所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200640" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.167226" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5402309" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">水雲澗</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.1644" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54405" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">陽明書屋</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129202140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.16297" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54468" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">氣象台</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129201140" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.16177" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54402" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">磺仔外</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129200530" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.160523" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5452729" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">童軍站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129202040" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.158277" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.5467266" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">陽明山國家公園管理處</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129201520" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.1552" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54612" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">陽明山總站</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="1129102120" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.15148" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.54603" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0171002000";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 12;
        var existBackNum = 11;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0171002000',
                        url: './StopStatusRecent3OfRoute?routeid=0171002000&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0171002000',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0171002000',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0171002000');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0171002000","Name":"花季專車124","BeginStop":"陽明山","GoDirStops":[{"UniStopId":"1129102120","Name":"陽明山總站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54603,"Latitude":25.15148,"PublicId":"1129102120"},{"UniStopId":"1129201500","Name":"陽明山國家公園管理處","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54608,"Latitude":25.15532,"PublicId":"1129201500"},{"UniStopId":"1129202000","Name":"童軍站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5468387,"Latitude":25.158318,"PublicId":"1129202000"},{"UniStopId":"1129200500","Name":"磺仔外","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54528,"Latitude":25.16067,"PublicId":"1129200500"},{"UniStopId":"1129201100","Name":"氣象台","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54429,"Latitude":25.16172,"PublicId":"1129201100"},{"UniStopId":"1129202100","Name":"陽明書屋","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5448478,"Latitude":25.163105,"PublicId":"1129202100"},{"UniStopId":"1129200600","Name":"竹子湖派出所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5404,"Latitude":25.16727,"PublicId":"1129200600"},{"UniStopId":"1129201700","Name":"頂湖山","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.540701,"Latitude":25.173294,"PublicId":"1129201700"},{"UniStopId":"1129201800","Name":"游園站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.541178,"Latitude":25.17508,"PublicId":"1129201800"},{"UniStopId":"1129200060","Name":"百拉卡公路入口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54296,"Latitude":25.179701,"PublicId":"1129200060"},{"UniStopId":"1129200121","Name":"小觀音棧","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5465214,"Latitude":25.179995,"PublicId":"1129200121"},{"UniStopId":"1129200100","Name":"小油坑服務站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.547521,"Latitude":25.176902,"PublicId":"1129200100"}],"LastStop":"小油坑","BackDirStops":[{"UniStopId":"1129200160","Name":"小觀音棧","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5466289,"Latitude":25.180168,"PublicId":"1129200160"},{"UniStopId":"1129200020","Name":"百拉卡公路入口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5428901,"Latitude":25.179585,"PublicId":"1129200020"},{"UniStopId":"1129201740","Name":"頂湖山","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54048,"Latitude":25.1732,"PublicId":"1129201740"},{"UniStopId":"1129200640","Name":"竹子湖派出所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5402309,"Latitude":25.167226,"PublicId":"1129200640"},{"UniStopId":"1129200340","Name":"水雲澗","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54405,"Latitude":25.1644,"PublicId":"1129200340"},{"UniStopId":"1129202140","Name":"陽明書屋","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54468,"Latitude":25.16297,"PublicId":"1129202140"},{"UniStopId":"1129201140","Name":"氣象台","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54402,"Latitude":25.16177,"PublicId":"1129201140"},{"UniStopId":"1129200530","Name":"磺仔外","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5452729,"Latitude":25.160523,"PublicId":"1129200530"},{"UniStopId":"1129202040","Name":"童軍站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.5467266,"Latitude":25.158276999999998,"PublicId":"1129202040"},{"UniStopId":"1129201520","Name":"陽明山國家公園管理處","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54612,"Latitude":25.1552,"PublicId":"1129201520"},{"UniStopId":"1129102120","Name":"陽明山總站","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.54603,"Latitude":25.15148,"PublicId":"1129102120"}],"RouteMapUrl":"../MapOverview?nid=0171002000","RouteTracks":null,"StopDirection":null,"TicketPrice":"一段票","BusTimeDesc":"0800 - 1600","HeadwayDesc":"花季及海芋季期間平日視需求彈性行駛；繡球花季視需求彈性行駛(豪大雨30-60分，大雨特報停駛)","HolidayBusTimeDesc":"0800 - 1600","HolidayHeadwayDesc":"尖峰:30分至60分;離峰:30分至60分;花季及海芋季例假日30-60分，視人潮天候彈性調度；繡球花季視需求彈性行駛(豪大雨30-60分，大雨特報停駛)","RouteNote":"本路線僅花季、繡球花季、海芋季期間(114年1月24日至6月22日)行駛","SegmentBuffer":"","StopLng":0,"StopLat":0,"IsNtpcMainLine":false,"orgphone":"大都會客運陽明山站:02-2861-6206","aliasName":null,"aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":"LINESTRING (121.546225894006 25.1513629427465, 121.546509252995 25.1517593242787, 121.54673700244 25.1520087363049, 121.546953036019 25.152129603704, 121.547112860595 25.1522069340656, 121.547160483645 25.1523763210579, 121.546654164639 25.1522816458527, 121.546187087757 25.1522492260695, 121.545973926938 25.1522576230212, 121.545689519732 25.1521817546413, 121.545534394731 25.152160943055, 121.5449694628 25.1523368361906, 121.544483228223 25.1523546927218, 121.543963465567 25.152430276249, 121.543760812996 25.1524756576234, 121.543653546402 25.1526323221951, 121.543730135316 25.1528262022106, 121.543951076821 25.1528020157645, 121.544323682417 25.1527862215369, 121.544840872471 25.1528481823988, 121.545547493401 25.1530349446694, 121.546474843271 25.1534459745961, 121.5468726347 25.1536818648967, 121.547195501344 25.1539822226061, 121.547467057856 25.1540256095987, 121.547827997824 25.1541087662227, 121.547936727639 25.1543581967338, 121.547708555557 25.1546886500007, 121.54742301987 25.1550271193653, 121.547216760933 25.1550359085515, 121.546578945735 25.1548732948372, 121.54644073246 25.1549580959035, 121.54595483251 25.155431160817, 121.545946805944 25.1555948244757, 121.545985076989 25.1557833851052, 121.546355125662 25.1564825725855, 121.546697044747 25.157136436571, 121.546830722007 25.1574693343545, 121.546862908663 25.1580596559915, 121.546799090535 25.1583993722, 121.54659879442 25.159108647245, 121.546321576815 25.1593687931416, 121.546036321129 25.1599344474989, 121.545644308283 25.1604960103079, 121.545324907148 25.1606240897548, 121.544943830039 25.1607043055178, 121.544563263104 25.1607272822405, 121.544373119702 25.1607685867965, 121.544320436735 25.160884618937, 121.544327485285 25.1612367041074, 121.54433566641 25.1615003739578, 121.5443243862 25.1616684637231, 121.544121385398 25.1619508490629, 121.544055892282 25.1621498385396, 121.544116136607 25.162351259145, 121.544628171493 25.1627475637132, 121.544804809305 25.1629766251682, 121.544852465178 25.1631716645446, 121.544813555742 25.1633607334333, 121.544706595592 25.1635387343302, 121.544511642701 25.1636471494107, 121.54434088028 25.1637382512675, 121.544262611365 25.164203294554, 121.543938612864 25.1646935561024, 121.543614677704 25.1652708469446, 121.543356451658 25.1656216194649, 121.543226120272 25.1657661690684, 121.542999613939 25.1658918783201, 121.542003431303 25.1661432521132, 121.541511821402 25.1663540663137, 121.540973355674 25.1666474592603, 121.540559377949 25.1669588156131, 121.54010344131 25.1674852177306, 121.540193012362 25.1683298175755, 121.540448559884 25.1687951733677, 121.540789913333 25.1691626885278, 121.540829684299 25.1693384647218, 121.540691359772 25.1699173563406, 121.540644711224 25.1704680189881, 121.540633393574 25.1709006496258, 121.540592382369 25.1713343315819, 121.540409539732 25.1726215254249, 121.540489269104 25.1728683128568, 121.540664201034 25.1733363837278, 121.540694441541 25.1735844182514, 121.540594614187 25.1742038817784, 121.540624578832 25.1744748466491, 121.541045512251 25.1749823627846, 121.541706792417 25.1756663319814, 121.541988707629 25.1758422513679, 121.542257682549 25.1758478079207, 121.542423024025 25.175801533042, 121.542770492574 25.1756537232568, 121.543294144845 25.1755803622569, 121.54383288094 25.1756209176273, 121.544220241964 25.1758623542655, 121.54440833305 25.1760998479956, 121.544430162722 25.1764047981775, 121.544377382124 25.1766373892369, 121.544254741981 25.1768884597314, 121.544255230792 25.1770931171112, 121.544270110666 25.1772532156273, 121.544369232448 25.1774216229413, 121.5450158044 25.1782426010851, 121.545145363021 25.1785535645911, 121.545074153196 25.1787417544117, 121.544962476823 25.1788632907603, 121.544468146616 25.178877455646, 121.544314722644 25.1789789702318, 121.544102029496 25.1793114582227, 121.543533267456 25.1795323342337, 121.542709436708 25.1797218446402, 121.542582645035 25.1798137231996, 121.54255320185 25.1799191785978, 121.542676216121 25.179980227032, 121.542901514297 25.1799403363789, 121.543485541617 25.1797555776485, 121.543993151202 25.1796802653945, 121.544581415314 25.1796421113395, 121.544849252045 25.1798857653798, 121.544970943822 25.1800922555228, 121.545179427002 25.1802973069223, 121.545396593243 25.1802841768625, 121.545513570194 25.1802067736943, 121.545941763472 25.1799549149025, 121.546148619506 25.1799026713403, 121.546322473519 25.1799387848228, 121.547290844858 25.1803527476369, 121.547796051429 25.1804992725877, 121.54790136272 25.1803975810112, 121.548039084492 25.1803453715014, 121.548481121176 25.1804110272556, 121.548685006583 25.1804059164386, 121.54888601827 25.1803599975742, 121.549096281808 25.1801939457116, 121.549202199965 25.179998708643, 121.549269004267 25.1797278168327, 121.549294030946 25.179416164817, 121.549187550641 25.1790375970997, 121.548989410063 25.1787845595425, 121.548470159428 25.1784498249659, 121.548140743835 25.1782683058848, 121.547744186589 25.1781396134064, 121.547356643822 25.1779115731914, 121.547140279593 25.1775338989693, 121.547028830135 25.1770515059046, 121.547465876744 25.1769868001812, 121.547636118657 25.1775205146503, 121.547409797029 25.1779162728731, 121.547517275146 25.1779870326502, 121.547757479105 25.1781171727749, 121.54816172695 25.1782451347243, 121.548508357949 25.1784327814298, 121.549016767891 25.1787683710902, 121.549237239986 25.1790529531415, 121.549329773351 25.1794355835328, 121.549312302885 25.1797655669188, 121.549256658991 25.1800023512621, 121.549146115114 25.1801815962794, 121.548967935527 25.1803331611317, 121.548794944807 25.1804279684642, 121.548496684352 25.1804468452337, 121.548064546669 25.1803777739429, 121.547931113825 25.1804165969105, 121.547840613593 25.1805469317722, 121.547204319043 25.1803612367717, 121.546195125797 25.1799401444325, 121.546012155827 25.1799633651537, 121.545403390306 25.1803255597338, 121.545160594153 25.1803200130323, 121.544997213037 25.1801655383254, 121.544810449526 25.1798945350522, 121.544574671708 25.1796742784967, 121.543996035663 25.1797099816112, 121.543517474393 25.1797706407954, 121.542930297915 25.1799645995781, 121.542664991348 25.1800215543857, 121.542551545911 25.1799702481742, 121.542514762094 25.1798346429688, 121.542680843424 25.1797086936052, 121.543555918825 25.179475901824, 121.54405292526 25.1793080716302, 121.544295741766 25.1789596045155, 121.544442670531 25.1788422730227, 121.544933690619 25.1788147547324, 121.545034740173 25.1787311544801, 121.545112020843 25.1785372871159, 121.544986588765 25.1782539053298, 121.544357212878 25.1774559429008, 121.544234972764 25.1772641214055, 121.544212749618 25.1771119759797, 121.544218972481 25.1768871205454, 121.544339042715 25.1766297623722, 121.544385774908 25.1764050381486, 121.544379071119 25.1761156297784, 121.544151191426 25.1758399142231, 121.543783675156 25.1756338763591, 121.54329671248 25.1756025139122, 121.542816148132 25.1756618606733, 121.542449410438 25.1758251747114, 121.542241520756 25.1758851271445, 121.541983203765 25.1758709784701, 121.541702144022 25.1757025185578, 121.541043820095 25.1750211645535, 121.540596573188 25.1745013881898, 121.54057308181 25.1742023182954, 121.540657767105 25.1736034075199, 121.540643530318 25.1733453609494, 121.540472652593 25.1728942117488, 121.540394008654 25.1726429919494, 121.540561294249 25.1713740181287, 121.540591717193 25.1709483022516, 121.540603488341 25.170523161477, 121.540658054096 25.1699437041313, 121.540798197498 25.1693258488595, 121.540751996736 25.1691633848254, 121.540438182975 25.1688172024881, 121.540175218734 25.1683541361753, 121.540067182792 25.1675068837125, 121.540514928299 25.1669537674844, 121.54090098566 25.1666483718148, 121.54146910679 25.1663473664452, 121.541959297513 25.1661336269972, 121.542944788528 25.1658711619862, 121.543172999693 25.1657410106008, 121.543307465965 25.1656172532507, 121.543544365584 25.16529, 121.543876759847 25.1647034419342, 121.544237182792 25.1641842771346, 121.544304365584 25.1637534419556, 121.544481149981 25.1636137921846, 121.544672441915 25.1635183146622, 121.544774225812 25.1633657631669, 121.544811079777 25.1631953014563, 121.544778168452 25.1630023207712, 121.544614928299 25.1627846022334, 121.544086759847 25.1623555800038, 121.54402 25.16215, 121.54407 25.16196, 121.544071017935 25.1619586956533, 121.544278591396 25.1616749276909, 121.544299892938 25.1614982131265, 121.544276398331 25.1612195541487, 121.544283379924 25.1608853988297, 121.544328686398 25.1607632129309, 121.544464225812 25.1607055795279, 121.544889769579 25.1606787491797, 121.545260702487 25.1606075364065, 121.545641408604 25.1604524635623, 121.545995480313 25.1599278690182, 121.546274225812 25.159372137069, 121.546562394264 25.1591106525572, 121.546752710101 25.1584229736434, 121.546830422944 25.1580702094134, 121.546799154111 25.1574834718991, 121.546671548375 25.1571737685972, 121.546347322563 25.1565170615546, 121.545951408604 25.1558117828473, 121.545903660592 25.1556062740741, 121.54590197132 25.155441482677, 121.54636506807 25.1549845728702, 121.546547322563 25.1548403266414, 121.547206057361 25.1550006532521, 121.547407605736 25.1549985175616, 121.547660699122 25.1546983880808, 121.547908591396 25.1543303266833, 121.547796294171 25.1541179727531, 121.547472670175 25.1540590198855, 121.547170132509 25.1540168844816, 121.546841824287 25.1537021585975, 121.546479154111 25.1534819605466, 121.545537881648 25.1530673857313, 121.544835913959 25.1528654031313, 121.544325207841 25.1528122876987, 121.543958874569 25.1528372113506, 121.543716197132 25.1528450763259, 121.543604365584 25.1526318081567, 121.543739437285 25.1524418080779, 121.543952817208 25.1523881919629, 121.544455272529 25.1523214820392, 121.544953802868 25.1523044228525, 121.545497118185 25.1521183961281, 121.5457058959 25.1521548391951, 121.545942920377 25.1522196488364, 121.546177580587 25.1522165243563, 121.546645078183 25.1522425925071, 121.547134247597 25.1523437486412, 121.547083421809 25.1522329248032, 121.546964774271 25.1521614477627, 121.546732799321 25.1520168715514, 121.546536204394 25.1517934826447, 121.546300132509 25.1518906947402, 121.546139572493 25.1518424107315, 121.545992935194 25.1517026959565, 121.545836579017 25.1515378821442, 121.546202630236 25.1513839423576)","wkt0":"LINESTRING (121.546019660469 25.1514546421838, 121.546203670498 25.151362160134, 121.54627805544624 25.151371488207392, 121.54632335186602 25.151402982324225, 121.5465216057613 25.151755359341305, 121.5466542126714 25.151880741137344, 121.54676384313665 25.151970469263002, 121.54706910161779 25.152164780938119, 121.54732249898062 25.15234245403385, 121.54734088013649 25.152383455480742, 121.54731462134238 25.152419108901622, 121.54724963082705 25.152416732007225, 121.54707107102732 25.152368599885637, 121.54684261951887 25.152298481452309, 121.54665880796034 25.152263422220543, 121.54637980827327 25.152247378161963, 121.54617498967949 25.152247972386395, 121.54599774281948 25.152264016444896, 121.5458408465249 25.152238464795182, 121.54563668440088 25.152157650239925, 121.54553952686281 25.152151113766205, 121.54537803527923 25.152182013457068, 121.54519291078101 25.152239059019653, 121.54513645437376 25.15225688575249, 121.54493294871965 25.152312742831846, 121.54457057736138 25.152351367393049, 121.54400470034903 25.152396528402949, 121.54388194048671 25.152421485795987, 121.5437729664913 25.152469617896713, 121.54369156422968 25.152558751366445, 121.54366596190546 25.1526205505339, 121.5436817171819 25.152719785670012, 121.54373226536049 25.152787526974063, 121.54379200411701 25.152817238060464, 121.54386815461984 25.152832093600956, 121.54396793803734 25.152823180276879, 121.54435919406907 25.152782178977741, 121.54456663854229 25.152794063413694, 121.54475176304054 25.152817832282125, 121.54502944978789 25.152892109966118, 121.54546009401074 25.153003229296957, 121.54571414784343 25.1530852317329, 121.54595704168864 25.153211206382203, 121.5462143778706 25.153343717311628, 121.54660825978175 25.153524359781819, 121.54683277247109 25.153642014931094, 121.54704875105239 25.153820874309378, 121.54717807561322 25.153950413496048, 121.54727457668146 25.153992602834492, 121.54756276694644 25.154021125195886, 121.54779318786447 25.154069850881164, 121.54790216185989 25.154139968296573, 121.54793301594295 25.154229100546125, 121.54793826770175 25.154314073230076, 121.54787721600553 25.154442423465653, 121.54767764917054 25.154713978843123, 121.54753979050163 25.15488748874596, 121.54747742586571 25.154959982536393, 121.54735072718428 25.154997417837542, 121.54722928026167 25.154987910460559, 121.54707632278618 25.154977214660573, 121.54668375381472 25.154876792937173, 121.54657346687961 25.154875604513915, 121.54648418697973 25.154898184553815, 121.54620846964194 25.155181028910164, 121.5459931475305 25.155427031661727, 121.54591043232917 25.155459118940584, 121.54585135004248 25.155428220079617, 121.54565834790604 25.155194101532629, 121.54545352931224 25.154973055182541, 121.54501106863204 25.154649803885047, 121.54461193496208 25.154188693934394, 121.54458305028859 25.154103126947742, 121.54459355380621 25.153999733425469, 121.54468939840461 25.15391654317153, 121.54481937943528 25.15387732488928, 121.54501763333056 25.153819091659056, 121.54517387315532 25.153859498393189, 121.54526446599486 25.153942688686019, 121.54553361863417 25.154359827727692, 121.54582377830874 25.155020592065824, 121.54600758986729 25.155208362573724, 121.54600102516875 25.155298682461929, 121.54596557579674 25.155503090383082, 121.5459524463997 25.155614801544107, 121.54609686976713 25.155971325841957, 121.54628855896388 25.156325472279693, 121.54655114690465 25.156784197345331, 121.54674677492049 25.157225094681792, 121.54681373484541 25.157406919803925, 121.54685968773502 25.157542397169721, 121.54684918421739 25.158051030147679, 121.54681898660421 25.158320794908512, 121.54669425733235 25.158854380718154, 121.54664567856328 25.159095622534103, 121.54653539162817 25.159215649072674, 121.54635158006965 25.159343994151577, 121.5462596742904 25.159521062603581, 121.54599839928933 25.159947689563129, 121.54583559476606 25.160186552473856, 121.54569379727802 25.160411154485608, 121.54560976913699 25.160505035627221, 121.54548372692541 25.160558512194573, 121.54515943081856 25.160673783826681, 121.54482988295287 25.160724883587509, 121.54458042440916 25.160734390517394, 121.54441236812706 25.160772418229527, 121.54434409526247 25.160818764487658, 121.54431914940811 25.160868675822872, 121.54431652352868 25.161364222971649, 121.54430995883018 25.161663689337402, 121.54426794475964 25.161770641432703, 121.54416947428184 25.161864521527953, 121.5440854461408 25.161971473447146, 121.54403818031143 25.162078425272561, 121.54406443910553 25.162216274153643, 121.54411958257309 25.162319660712214, 121.54426138006109 25.162453944272404, 121.5444307492829 25.162573967506376, 121.54461849966054 25.162745089536706, 121.54475767126914 25.162935224844379, 121.54479771593009 25.163009496368435, 121.54483513471166 25.163168734363566, 121.54478393006322 25.163404025945965, 121.54471106190967 25.16351275902387, 121.54459158439663 25.163614956145327, 121.54444125280054 25.163691603930218, 121.54437560581536 25.163749832447792, 121.54435459878009 25.163800930919898, 121.54432111881763 25.163907286973419, 121.54425350242288 25.164216847919768, 121.54416947428184 25.164351723556596, 121.54404605794967 25.164519872269377, 121.54390229105211 25.164710004810196, 121.54379331705668 25.164914396960963, 121.54368303012156 25.16515384430652, 121.54358259023422 25.165309514537061, 121.5434407927462 25.165530542156613, 121.54332459758241 25.165706413309628, 121.54324122591122 25.165792566315673, 121.5431237178077 25.16586743025772, 121.542874259264 25.165954771465344, 121.54276856761781 25.165985073502352, 121.54239569274193 25.166063502269061, 121.54198408614479 25.166190651829119, 121.54177204638262 25.166258385652792, 121.54162696654534 25.1663296843739, 121.54137816447147 25.166446733017334, 121.54105058601534 25.166617849613669, 121.54084904977081 25.166727768133963, 121.54065013940568 25.166910767396612, 121.54053000542277 25.167026033024968, 121.54031468331135 25.167258940560082, 121.54019914461742 25.167382523969493, 121.5401394058609 25.167471052392507, 121.5401558176072 25.16774970855279, 121.54016303877557 25.168028958223832, 121.54021293048434 25.168292165307033, 121.5402582269041 25.168462091022832, 121.54037179618847 25.168659941295648, 121.54048339606329 25.16884709666364, 121.54055757715659 25.168924335303203, 121.54069280994607 25.169034251744371, 121.54075714399156 25.169093071853268, 121.54080440982091 25.169167339627005, 121.54081031804955 25.169262402311372, 121.54080440982091 25.169405590339814, 121.54075780046141 25.169606409781053, 121.54070331346371 25.169847036190721, 121.54067902407917 25.169950416280141, 121.54063701000867 25.170403148742732, 121.54061272062415 25.17083270830457, 121.54059171358888 25.171174334814786, 121.54056611126465 25.171592603186419, 121.54051490661621 25.171861149736781, 121.54047551842508 25.172139795863924, 121.5404236573068 25.172474883326903, 121.54041052790976 25.172615096956523, 121.54041971848768 25.172751745677683, 121.5405464171691 25.173030983892446, 121.54065932998363 25.173303092005554, 121.54067311585052 25.173377951336253, 121.54068361936814 25.173577575993377, 121.54066195586306 25.173800965103059, 121.54063110178001 25.174129512704113, 121.54062453708148 25.174357653736184, 121.54065342175497 25.174480635834168, 121.54070659581296 25.17458876491926, 121.54082804273557 25.174724223198215, 121.54108931773665 25.175031974342691, 121.54130989160686 25.175259519573455, 121.54158298306527 25.175554793038629, 121.54179633576716 25.175731243842389, 121.54196504851912 25.175817983874495, 121.54206548840642 25.175860759758017, 121.5422473305554 25.175863730304926, 121.54237271629714 25.175835213051609, 121.54261692308204 25.175719955751479, 121.54284274871108 25.175636780312548, 121.54297929444027 25.175601133678494, 121.54352219500782 25.175596380793159, 121.54378872176768 25.175620739328515, 121.5439416792432 25.17567480337739, 121.54407034733418 25.175729461512315, 121.54422658715893 25.175854224554566, 121.54434672114185 25.17603186314199, 121.54441171165718 25.176169102140971, 121.54442615399392 25.176292082411372, 121.54441761988583 25.176461402870505, 121.54437757522489 25.176608741183916, 121.54432046234777 25.176771526048896, 121.54426531888016 25.17691529936198, 121.54423971655595 25.177068578161883, 121.54427450945812 25.177228986001882, 121.54431061529998 25.177309783945041, 121.54437035405647 25.177401869770826, 121.54449967861731 25.177571188688304, 121.54472813012579 25.177870021151204, 121.54492178873211 25.178144494855289, 121.54500778628271 25.178261532155854, 121.54508393678553 25.178412432874971, 121.54509837912225 25.178531252207375, 121.54508131090613 25.178634624932336, 121.5450721203282 25.178675023444697, 121.54503995330543 25.178728492043412, 121.54492835343063 25.178823547272096, 121.54488436995057 25.178841964214076, 121.5446335984671 25.178852063826248, 121.54447867158206 25.178855628395048, 121.54439136109175 25.178874639426887, 121.54428960826471 25.179005934284543, 121.54421148835235 25.179109900700443, 121.54412089551275 25.179261394461985, 121.54397515920566 25.179357043367393, 121.54367055719437 25.179452098105845, 121.54317951774514 25.179622008266133, 121.54269110417533 25.179751520047397, 121.54260970191366 25.179806176354159, 121.54259788545636 25.179894101665766, 121.5426188924916 25.17993925247681, 121.54268979123562 25.179966580591156, 121.54275937703991 25.179957075160775, 121.54313356485551 25.17986558535544, 121.54365086309883 25.179714686435538, 121.54403030267321 25.179673100086188, 121.5445082127254 25.179645771906028, 121.54460143144438 25.179662406451204, 121.54471171837952 25.179740826419291, 121.54503470154668 25.180122231908193, 121.54512266850681 25.180235702781196, 121.54519750606995 25.18027907120214, 121.54536162353294 25.180295705660871, 121.54548963515404 25.1802493668059, 121.54584741122333 25.180018266355884, 121.54601152868632 25.179935093850176, 121.54614544853611 25.179915488894139, 121.54622291197866 25.179923212059009, 121.54634698478064 25.179946975640181, 121.54648090463046 25.180014107731949, 121.54678156782263 25.180140054565396, 121.54710192511034 25.180285012080525, 121.54742359533779 25.180403829587284, 121.54770653384395 25.180467990992771, 121.54778071493722 25.180453732905583, 121.54784045369377 25.18042284037762, 121.54796387002592 25.180356896685961, 121.54802886054124 25.18032897457153, 121.54810304163453 25.18032956865914, 121.54846935181186 25.180399670976513, 121.54863084339544 25.180407988197928, 121.54883369257971 25.180383630619311, 121.54897220771846 25.180302834713927, 121.54910809697779 25.180170353076672, 121.54920656745557 25.179996879145559, 121.54926302386282 25.179835286768412, 121.54928206148853 25.179727162337585, 121.54927549679002 25.179420017139918, 121.54925711563416 25.1792435716763, 121.54915798868649 25.178985735084893, 121.54902997706535 25.178806912612444, 121.54884419609731 25.178686311261956, 121.54849232825666 25.178454019654506, 121.54831245551725 25.178333417954814, 121.5479487712193 25.178221133506444, 121.54767896211013 25.178089837803341, 121.54742162592819 25.177956759661306, 121.54735597894302 25.177882497242091, 121.5472358449601 25.17769654394586, 121.54716166386685 25.17747910299045, 121.54706844514784 25.177132147220032, 121.54703430871555 25.1769265873422, 121.5470198663788 25.17676855552412, 121.54704218635382 25.176684192589978, 121.54708420042432 25.176649734473322, 121.54713671801248 25.176649734473322, 121.54727720256079 25.176703203960514, 121.54741637416939 25.176774496573614, 121.54747443072195 25.176813076256771, 121.54749904834138 25.176850504850105, 121.54752116316955 25.176902117673251)","wkt1":"LINESTRING (121.54752116316955 25.176902117673251, 121.54759001044521 25.1773415312839, 121.54765828330976 25.177510256183837, 121.54760707866133 25.177635017403286, 121.54747972351007 25.177801365497238, 121.54746265529394 25.177890480454174, 121.54750729524385 25.177957019579534, 121.54760051396279 25.178022370470863, 121.54792349712993 25.178168518701035, 121.54824385441761 25.178276644514639, 121.54843423067464 25.178365759124073, 121.54888325605329 25.178675877456978, 121.54906312879267 25.17880895481381, 121.54916652279437 25.178953319817843, 121.54920656745531 25.179038869369169, 121.54927615325961 25.179241158173532, 121.54930109911398 25.179346015527358, 121.54930569440295 25.179466616225032, 121.54930733557758 25.179601177946346, 121.54930733557755 25.179784454930424, 121.54928829795185 25.1798806975151, 121.54922888743027 25.180030408051305, 121.54914288987969 25.180178336138578, 121.54906641114198 25.180284380861732, 121.54893183482234 25.18037943487688, 121.54879660203284 25.180445378556339, 121.54864988102096 25.180452210557124, 121.54841617775368 25.180433793858477, 121.54821267209965 25.180389831405297, 121.54807546990061 25.180367850172757, 121.54795664885744 25.180392801841826, 121.54785817837966 25.180475379948248, 121.54777480670847 25.18050270794237, 121.54769931267553 25.180508648809845, 121.54742884709654 25.180453992818141, 121.54718595325139 25.18036369156075, 121.54683014659169 25.180212793257624, 121.54636011417779 25.179996544969931, 121.54619862259423 25.179949611911763, 121.54607980155106 25.179953770537896, 121.54593406524397 25.179992386345255, 121.54573384193915 25.180115956846564, 121.54551851982775 25.180263884830008, 121.5453990423147 25.180318540906974, 121.54530844947516 25.18033576944789, 121.54521063546723 25.180316164556309, 121.54510822617036 25.180258538038551, 121.54501500745141 25.180151008071729, 121.54475241951066 25.179817723980641, 121.54465723138216 25.179730986794997, 121.54459814909551 25.179695935449036, 121.54451609036403 25.179675142272934, 121.54429945531291 25.17967573636373, 121.54398763213329 25.17971197589674, 121.54366530543605 25.179757126775247, 121.54337777164095 25.179831982142236, 121.54299767559675 25.179947235553904, 121.54275018646261 25.180017932180316, 121.54266156303264 25.180040507564982, 121.54261167132388 25.180025061249609, 121.54252370436373 25.179966246415457, 121.54251123143658 25.17987535070684, 121.54254996315781 25.179760691317576, 121.54264318187676 25.179708411352987, 121.54275937704053 25.179688806360485, 121.54348674563637 25.179479686244221, 121.54389310047463 25.179358491467145, 121.54404474501041 25.179278288974874, 121.54411630022427 25.179205809640159, 121.54421608364174 25.179066791779178, 121.54432308822759 25.178912327303227, 121.54439726932085 25.178840441845736, 121.54447998452217 25.178812519383879, 121.54469399369388 25.178813707573877, 121.54485154645832 25.178819648523689, 121.54493557459934 25.178788161486391, 121.54500975569258 25.178703799950153, 121.54504717447411 25.178634290753177, 121.54506161681086 25.178480419825693, 121.54502879331828 25.178368135512773, 121.54493097931034 25.178195253114431, 121.54476489243784 25.177981377643128, 121.54457582912052 25.177728291183929, 121.5443716669966 25.1774591634571, 121.54427122710928 25.177324302319708, 121.54422790009906 25.177190035136018, 121.54420623659394 25.177053985493711, 121.54421936599097 25.176928629575333, 121.54428304356658 25.176724257564668, 121.54437494934584 25.176493150430463, 121.54438742227305 25.176418293012837, 121.54436772817749 25.176171144386906, 121.54425612830269 25.175950136056603, 121.54412614727202 25.175821214345543, 121.54398763213329 25.175739227195685, 121.54387012402981 25.175685757285635, 121.54378806529833 25.175660804652914, 121.54360753608908 25.175642387230255, 121.54343094569893 25.175631693241623, 121.5431217483987 25.175629910910093, 121.54297995091071 25.175629910910093, 121.54273443118613 25.175704174701746, 121.54244558445131 25.175836661193689, 121.54233267163681 25.175875872414803, 121.54215214242755 25.175890131037537, 121.54200640612046 25.175872307758858, 121.54181734280314 25.175784379545902, 121.54166898061661 25.17568219262413, 121.54146875731182 25.175479006746087, 121.541215359949 25.175224132753513, 121.54097180963397 25.174941334879321, 121.54065801704479 25.174566448450747, 121.54061731591398 25.174459507578312, 121.54058711830083 25.174319296070088, 121.54059302652952 25.174079272605407, 121.54062322414269 25.173845189860398, 121.54064423117792 25.173586747728976, 121.54064554411764 25.17342158212583, 121.54061731591398 25.173293845984336, 121.54047026666721 25.172971831489448, 121.54037179618943 25.172649816143977, 121.54037704794824 25.17243177205993, 121.54042562671728 25.172185803606023, 121.54049258664215 25.171713471487855, 121.54054444776045 25.171331445555587, 121.54058121007215 25.170822273828449, 121.54060549945665 25.170405191086068, 121.54064029235879 25.169955429322005, 121.54068493230872 25.169754016316496, 121.54073154166819 25.169535372913238, 121.54076239575123 25.169358319000473, 121.54077618161813 25.169265632957039, 121.54074729694464 25.169168787849213, 121.54067114644182 25.169077884089052, 121.5404984948708 25.168903206085179, 121.54042562671725 25.168824779144888, 121.5403238738902 25.16862930571812, 121.54020767872645 25.168408877860937, 121.5401676340655 25.16827994817487, 121.54014071880155 25.16807734410704, 121.54011708588691 25.167839684947403, 121.54007769769578 25.167550928445152, 121.54008294945459 25.167437445764296, 121.54025297514623 25.167251476535384, 121.5407085652234 25.166790414220678, 121.54105649424486 25.166562853183134, 121.54150092433456 25.166341233278871, 121.54177007697379 25.16621467803223, 121.54208518250266 25.166113671403107, 121.54262283131131 25.165970479509042, 121.54306004023263 25.165863531096733, 121.54319199067282 25.165791637944633, 121.54330621642704 25.165660328854948, 121.54345917390251 25.165395333609887, 121.5436324819434 25.16513390275902, 121.54384123935633 25.164732248814381, 121.5440755990934 25.164391792585803, 121.54420492365421 25.164193341221779, 121.54427910474745 25.163865361014086, 121.54430602001136 25.163715036457461, 121.54440449048914 25.163636606180443, 121.54463950669609 25.163517772331293, 121.54470974897026 25.163399532536463, 121.54475307598048 25.163190384477954, 121.54474125952315 25.163013915524626, 121.54467561253794 25.162876067545074, 121.54449442685886 25.16267820788832, 121.54426663182026 25.16249817314695, 121.54409660612865 25.162374584787834, 121.5440125779876 25.162203462237706, 121.54399682271115 25.162045411335754, 121.54407231674411 25.161906373906817, 121.54419638954612 25.161766742141321, 121.54425481536292 25.161679992112891, 121.5442646624107 25.161541548446564, 121.54426400594086 25.161330020481252, 121.54425612830261 25.160949150382848, 121.54428698238566 25.160821995358209, 121.54434409526277 25.160745345769971, 121.54446488571551 25.160698405300682, 121.54470252780186 25.160671667050604, 121.54497627573009 25.160652058996824, 121.54540429407346 25.160539164080408, 121.5455644727173 25.160473803817883, 121.54569248433843 25.160346648297715, 121.54579555010518 25.160149378723716, 121.54596491932693 25.159922399481804, 121.54609883917669 25.159712057084768, 121.54621897315961 25.159491613109907, 121.54631416128809 25.159333558694037, 121.54649862931645 25.159173721501308, 121.54661022919127 25.159023985353805, 121.54667521970661 25.158669252556589, 121.54677565959395 25.158247374687694, 121.54681176543581 25.158040000383497, 121.54681045249609 25.157853422628026, 121.54680979602625 25.157537903545109, 121.54678025488292 25.157372122005025, 121.54664370915373 25.157078587112654, 121.54646711876359 25.15670067475375, 121.54616382969202 25.156183717272512, 121.54611065563405 25.156092803833804, 121.54599708634966 25.155840860355532, 121.54590058528146 25.155631105128855, 121.54586316649987 25.155490277763008, 121.54586185356015 25.155417190078683, 121.54566556907449 25.155193767292502, 121.54546140695058 25.154970344097197, 121.54502551096893 25.154644121728793, 121.5446158737814 25.15417825803662, 121.54459486674612 25.154111705935389, 121.54460799614316 25.154015443010454, 121.54468283370629 25.153937006496946, 121.54481937943545 25.153885903892835, 121.54502419802921 25.153828859100177, 121.5451607437584 25.153870454264126, 121.54524214602004 25.153945325523498, 121.54549948220195 25.154358899271255, 121.54580671009262 25.155024417301671, 121.54598920871142 25.155220506743259, 121.5460876791892 25.155207434123625, 121.54618155437802 25.155157520472137, 121.54642247881365 25.154921024560124, 121.54655442925385 25.15483367545157, 121.54665552561103 25.154824762273716, 121.5470251181376 25.1549079519084, 121.54715247328886 25.154949546704476, 121.547275889621 25.154942416169014, 121.54739799301343 25.154918647714457, 121.54754504226024 25.154806935916042, 121.54779843962305 25.154465857770969, 121.5478942842214 25.154318492702522, 121.54787852894495 25.154222229940729, 121.54783520193475 25.154134286116662, 121.54771047266289 25.154087937319009, 121.54731659075182 25.154030892620806, 121.54717610620351 25.153990485943442, 121.54704612517284 25.153875207996244, 121.54679141487033 25.153648217080807, 121.54642773057243 25.153474705415665, 121.54584741122346 25.153179972706607, 121.54557235035551 25.153067665087704, 121.54506555562989 25.152936936530011, 121.5446381937564 25.152823440252227, 121.54435262937086 25.15281749803583, 121.54396071686932 25.152866224201759, 121.54384189582615 25.152868006865997, 121.54373029595133 25.152841266899689, 121.54366924425513 25.152781844731358, 121.54361738313682 25.152679044311814, 121.54363051253384 25.152549503775415, 121.543683030122 25.152472254766234, 121.54378609588873 25.152414615089068, 121.54395415217083 25.152367077190497, 121.54420689306376 25.152329046858306, 121.54478130418413 25.152266059094547, 121.54506096034099 25.152215550015214, 121.54526184011567 25.152161475565929, 121.54543843050578 25.15210502419221, 121.54565703496645 25.152118097144239, 121.54589598999253 25.152197129051665, 121.54599446047031 25.15221257889225, 121.5463863729718 25.15222208648548, 121.54671329495802 25.152243478567542, 121.54704546870305 25.152304683670515, 121.54712818390439 25.152299335653034, 121.54714000036171 25.152268435991878, 121.54712096273599 25.152236942098426, 121.54707632278608 25.152200100175005, 121.54672379847564 25.151989744463709, 121.54654589514578 25.151851884026836, 121.546505194015 25.151838216819865, 121.54642576116292 25.151845941763124, 121.54633188597411 25.151878624209957, 121.54620715670228 25.151872681947545, 121.54610409093553 25.151825143837854, 121.54592553113582 25.15162251243758, 121.54588876882413 25.151570814636425, 121.54591043232924 25.15152505909299, 121.54595835462843 25.151489405410889, 121.54601916014846 25.151454717339352)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0171002000'=='0100020200' || '0171002000'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
