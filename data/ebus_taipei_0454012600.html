
<!DOCTYPE html>
<!--[if lt IE 8]> <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9 oldie" lang="en"> <![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->
<!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<head>
    <script>
        var SitePath = '/';
    </script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="format-detection" content="telephone=no" />
    <title>大臺北公車</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=4, minimum-scale=0.5, user-scalable=yes">

    <link rel="stylesheet" href="/styles/html5reset-1.6.1.min.css" />
    <link href="/web/css?v=sRaS4eVeEUiSbsmDNyPCQX6_bGwBuAfoNm1EFEuVJsQ1" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" media="screen and (max-width:768px)" href="/pad/css?v=-VA-V4vm8GvG2qYKGZXk3Qi1cWfbcBMLSWm5uytMv8A1">

    <link rel="stylesheet" type="text/css" media="screen and (max-width:480px)" href="/phone/css?v=tNT4bc9cbLmN5rC7jOPAfHE2gTc_N47eqhKenWJ5sQk1">

    
    
    
    <link href="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1" rel="stylesheet"/>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <link href="/CustomScrollbar/css?v=cTpwHD23PH7gbg8rY79THNO6JzhoW_RwUaR7zeCFjOI1" rel="stylesheet"/>

    <link href="/toastr/css?v=bUMX5PdhipTCZJVvmdqKc60mrvySkxFZQUqXQRjL8kI1" rel="stylesheet"/>

    <link href="/simpleRouteMap/css?v=eN0OvNIAPpKksgTz7sjIy-B4L9bOLNcs7ckhBHKid1Q1" rel="stylesheet"/>




    <script>
        var viccknCulture = null;
        function Mybus(event, _elem) {
            event.preventDefault();
            var islogin = jQuery('a.login-link');
            if (islogin.length>0) {
                //
                alert(i18n._('Please Login'));
            } else {
                window.location.replace(_elem.href);
            }
        }
    </script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>

    <script src="/bundles/jquery?v=q7mEgdXrcJJy32YRlrFef8zHiCgDFSUdNzefyodQYIQ1"></script>

    

    

</head>
<body class="tebus">
    <!--[if lt IE 7]><p class=chromeframe>Your browser is <em>ancient!</em> <a href="http://browsehappy.com/">Upgrade to a different browser</a> or
    <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to experience this site.</p><![endif]-->
    <a href="javascript:void(0);" class="tebus-up web-none" title="置頂"></a>  
    <!-- being header web-->
    <header class="tebus-main-header-c  pad-none">
        <div class="teBUS-main-header">
            <div class="teBUS-logo-c">
                <a href="/Dybus.aspx" class="teBUS-logo" title="首頁"></a>
                <p class="teBUS-visite">到訪人數<span class="teBUS-visite-number">231492811</span></p>
            </div>
            <nav class="teBUS-nav-language-marquee-c">
                <ul class="teBUS-nav-language-c">
                    
                            <li class="pad-none">
                               
                            <a class="nav-language-link" href="https://e-bus.tpc.gov.tw" target="_blank">無障礙 </a> /
                            </li>


                    <li><a class="nav-language-link" href="/Home/SetCulture?culture=zh-TW&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454012600">中文</a> / </li>
                        <li><a class="nav-language-link" href="/Home/SetCulture?culture=en&amp;returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454012600">English</a> / </li>
                    <li><a class="nav-language-link login-link" href="javascript:void(0);" alt="會員登入">會員登入</a>/</li>
                    <li><a href="/MyBus" class="nav-language-link" onclick="Mybus(event, this)">我的公車</a></li>
                    <li>/<a class="nav-language-link" href="https://www.pto.gov.taipei/Questionnaire_Content.aspx?n=63FD5A257079935F&s=E4505D512A861F41&sms=7F78FC0503254E9A" target="_blank">滿意度調查</a> </li>

                      
                    
                </ul>
                <input id="marqueeSpeed" name="marqueeSpeed" type="hidden" value="6" />
                
                <marquee scrollamount="6"><div class='teBUS-marquee2' ></div></marquee>
            </nav>
        </div>
    </header>
    <!-- end header web-->
    <!-- being header pad-->
    <header class="teBUS-pad-main-header-c web-none">

        <div class="teBUS-pad-main-nav-icon">
            <ul class="teBUS-nav-main-language-pad-c">
                <li class="nav-main-language-title">語言</li>

                <li>
                    <span class="label-checkbox-language-c">

<form action="/Home/SetCulture?returnURL=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454012600" id="SetCultureForm" method="get" role="form">                            <label class="label-radio label-checkbox-language">
                                <input checked="checked" class="radio fast-search-radio" id="culture" name="culture" type="radio" value="zh-TW" />
                                中文
                            </label>
                            <label class="label-radio label-checkbox-language">
                                <input class="radio fast-search-radio" id="culture" name="culture" type="radio" value="en" />
                                English
                            </label>
<input id="returnURL" name="returnURL" type="hidden" value="/Route/StopsOfRoute?routeid=0454012600" /></form>                    </span>
                </li>
                <li class="nav-main-language-title">功能選單</li>
                
                <li><a href="/ebus" class="main-nav-pad">公車動態</a></li>
                <li><a href="/Query/BusRoute" class="main-nav-pad">GIS動態</a></li>
                <li><a href="/Transfer/TransPlan" class="main-nav-pad">轉乘規劃</a></li>
                
                    <li><a href="https://pda.5284.gov.taipei" class="main-nav-pad">PDA</a></li>
                    <li><a href="/projectbus" class="main-nav-pad">專區</a></li>
                        <li><a href="/RelatedLinks" class="main-nav-pad">相關連結</a></li>
                        <li></li>
                
            </ul>
        </div>
        <div class="teBUS-main-nav-pad-c">
            <a href=javascript:history.back(); class="teBUS-pad-main-come-back-icon" title="回上一頁"></a>
            <a href="/Dybus.aspx" class="teBUS-logo-pad" title="logo" alt="logo"></a>
            <a href=javascript:toggleMenu(); class="teBUS-pad-main-nav-icon-c" title=""></a>
        </div>
    </header>
    <!-- end header pad-->
    <!-- being content -->
    <div class="teBUS-main-container">

        <!--begin main list-->
        <div class="teBUS-main-nav-c pad-none">

    <ul class="teBUS-main-nav-pool">
        <li class="main-nav-typt"><a href="javascript:void(0)" onclick="history.go(-1)" class="main-nav" title="回上一頁"><img src="/images/nav_011.svg" width="100%" alt="回上一頁"></a></li>
       
            <li class="main-nav-typt"><a href="/ebus" class="main-nav"><img src="/images/nav_013.svg" width="100%" alt="公車動態">公車動態</a></li>
        <li class="main-nav-typt"><a href="/Query/BusRoute" class="main-nav" title="GIS動態"><img src="/images/nav_002.svg" width="100%" alt="GIS動態">GIS動態</a></li>
        <li class="main-nav-typt"><a href="/Transfer/TransPlan" class="main-nav" title="轉乘規劃"><img src="/images/nav_003.svg" width="100%" alt="轉乘規劃">轉乘規劃</a></li>

       
        <li class="main-nav-typt"><a href="https://pda.5284.gov.taipei" target="_blank" class="main-nav"><img src="/images/atk-PDA.svg" width="100%" alt="PDA">PDA</a></li>
        <li class="main-nav-typt">
            <a href="/Query/NearBus" class="main-nav"><img src="/images/atk-nearbystop.svg" width="100%" alt="附近站牌">附近站牌</a>
        </li>
        

        
        <li class="main-nav-typt"><a href="/RelatedLinks" class="main-nav" title="相關連結"><img src="/images/nav_008.svg" width="100%" alt="相關連結">相關連結</a></li>
        
        <li class="main-nav-typt"><a href="/projectbus" class="main-nav" title="專區"><img src="/images/nav_012.svg" width="100%" alt="專區">專區</a></li>

        
    </ul>
</div>
<div id="Login_DL" class="teBus-dialog-c" style="display:none">
    <form id="LoginForm">
        <div class="teBus-dialog login-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img login-img" alt=" "></span>會員登入</h1>
            <span class="teBus-dialog-close-icon-c"><a href='javascript: void(0);' class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>

            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li" style=" margin:0 auto;width: 50%;">
                    

                   
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                    
                </li>

                <li>
                    <label class="teBus-login-dialog-enter-c">
                        <input class="teBus-dialog-checkbox-one login-enter-checkbox" data-val="true" data-val-required="記住我 欄位是必要項。" id="RememberMe" name="RememberMe" type="checkbox" value="true" /><input name="RememberMe" type="hidden" value="false" />
                        <label for="RememberMe">記住我</label>
                        
                        <a href="javascript:void(0)" class="teBus-dialog-submit login-enter-submit">登入</a>
                        <!--input type="submit" value="登入" class="teBus-dialog-submit login-enter-submit"-->
                    </label>
                </li>
            </ul>

            <div class="teBus-login-dialog-link-pool ">
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one register-link"><img src="/images/dialog_register_icon.svg" width="100%">註冊</a>
                <a href="javascript:void(0)" class="teBus-login-dialog-link-one forgot-password-link"><img src="/images/dialog_forgot_password_icon.svg" width="100%">忘記密碼</a>
                
    <a href="javascript:void(0)" class="teBus-login-dialog-link-one resend-confirm-email-link"><img src="/images/atk-resendmail.svg" width="100%">重發確認信</a>
                
                
            </div>
        </div>

    </form>
<form action="/Account/ExternalLogin?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454012600" class="form-horizontal" id="ExternalLoginForm" method="post" role="form">        <input type="hidden" name="__RequestVerificationToken" class="verification-token" />
        <input type="hidden" name="provider" />
</form></div>

<script>
    function OpenLoginDialog() {
        $("#Login_DL").dialog('open');
        // Press enter key to submit
        $(".teBus-dialog-input-text-one").keyup(function (event) {
            if (event.keyCode == 13) {
                $(".login-enter-submit").click();
            }
        });
    }
    function CloseLoginDialog() {
        $("#Login_DL").dialog('close');
    }
    $(function () {
        $("#Login_DL").show();
        $("#Login_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Login_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#LoginForm").find('input[name="Email"]').val('');
                $("#LoginForm").find('input[name="Password"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $('.login-enter-submit').click(function () {
            if ($('#LoginForm').valid()) {
 
                    $.ajax({
                        url: '/Account/Login?ReturnUrl=%2FRoute%2FStopsOfRoute%3Frouteid%3D0454012600',
                        dataType: "json",
                        type: "post",
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest',
                            "Email": $("#LoginForm").find('input[name="Email"]').val(),
                            "Password": $("#LoginForm").find('input[name="Password"]').val(),
                            "RememberMe": $('input[name="RememberMe"]').is(":checked"),
                            "RecaptchaToken": $('[name=h-captcha-response]').val()
                            //"RecaptchaToken": $('#LoginForm textarea').val()
                        },
                        success: function (data) {
                            if (data.ErrorCode === 100) window.location.replace(data.Msg);
                            if (data.ErrorCode === 101 || data.ErrorCode === 103) $("#LoginForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                            if (data.ErrorCode === 102) $("#LoginForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        }
                    });
            }
        });

        // Register, forgot password link clicked
        $(".register-link,.forgot-password-link,.resend-confirm-email-link").click(function () {
            var startDate = new Date('2015-12-11 10:29:00');
            var endDate = new Date('2015-12-11 10:29:30');
            var now = new Date();
            if (now > startDate && now < endDate) {
                swal({
                    title: "HTML <small>系統公告</small>!",
                    text: "<h3>親愛的使用者您好</h3> <label> 由於系統設備將於2015/12/12進行維護，</label><label>會影響本系統部分功能的使用，</label><label>造成不便敬請見諒</label>",
                    html: true
                });
            } else {
                if ($(this).hasClass('register-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenRegisterDialog();
                    }, 400);

                }
                if ($(this).hasClass('forgot-password-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenForgotPasswordDialog();
                    }, 400);

                }
                if ($(this).hasClass('resend-confirm-email-link')) {
                    CloseLoginDialog();
                    setTimeout(function () {
                        OpenResendConfirmEmailDialog();
                    }, 400);

                }
            }

        });

        // External Login
        $('.facebook-login, .g-login').click(function () {
            if ($(this).hasClass('facebook-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Facebook');
            }
            if ($(this).hasClass('g-login')) {
                $('#ExternalLoginForm').find('input[name="provider"]').val('Google');
            }
            $('#ExternalLoginForm').submit();

        });
    });
</script>


<!-- dialog_會員註冊 BEGIN-->
<div id="Register_DL" class="teBus-dialog-c" style="display:none">
    <form id="RegisterForm">
        
        <div class="teBus-dialog register-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img register-img" alt=" "></span>註冊</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title"> 電子郵件</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" title="ex. ebus-taipei@mail.com" type="text" value="" /></label>
                    <a href="javascript:void(0)" class="register-a-one-icon register-check-icon" style="display:none"></a>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
           
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">名稱</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-required="名稱是必要項" id="Nickname" name="Nickname" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Nickname" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-length="密碼必須至少6個字元長度" data-val-length-max="100" data-val-length-min="6" data-val-required="密碼是必要項" id="Password" name="Password" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Password" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">確認密碼</span>
                    <label><input autocomplete="off" class="teBus-dialog-input-text-one" data-val="true" data-val-equalto="兩次密碼輸入並不相同" data-val-equalto-other="*.Password" id="ConfirmPassword" name="ConfirmPassword" type="password" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="ConfirmPassword" data-valmsg-replace="true"></span>
                </li>
                <!--li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">上傳照片</span>
                    <label><input name="" type="text" value="" class="teBus-dialog-input-text-one"></label>
                    <a href="javascript:void(0);" class="register-a-one-icon register-browse-icon">瀏覽</a>
                    <div class="teBus-dialog-gust-photo-img" title="預覽照片" ><img src="images/dialog_gust_photo_img.svg" width="100%" alt="預覽照片"></div>
                </li-->
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    <span class="teBus-dialog-li-title">認證</span>
                    <p class="teBus-diolag-note"></p>
                    <div class="col-md-10">
                        <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                        <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                        </div>

</li>
            </ul>
            <!--input type="submit" value="註冊" class="teBus-dialog-submit register-enter-submit"-->
            <!--input type="submit" value="取消" class="teBus-dialog-submit register-close-submit"-->
            <a href="javascript:void(0)" class="teBus-dialog-submit register-enter-submit">註冊</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit register-close-submit">取消</a>
        </div>
      
    </form>
</div>
<!-- dialog_會員註冊 END-->

<script>
    function OpenRegisterDialog() {
        $("#Register_DL").dialog('open');
    }
    function CloseRegisterDialog() {
        $("#Register_DL").dialog('close');
    }
    function verifyCallback(token) {
        alert(token)
    }

    $(function () {
        $("#Register_DL").show();
        $("#Register_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#Register_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#RegisterForm").find('input[name="Email"]').val('');
                $("#RegisterForm").find('input[name="Nickname"]').val('');
                $("#RegisterForm").find('input[name="Password"]').val('');
                $("#RegisterForm").find('input[name="ConfirmPassword"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        // Form subnit action
        $(".register-enter-submit").click(function () {
            debugger;
            //$("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text('');
            if ($('#RegisterForm').valid()) {
                
                $.ajax({
                    url: '/Account/Register',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#RegisterForm").find('input[name="Email"]').val(),
                        "Nickname": $("#RegisterForm").find('input[name="Nickname"]').val(),
                        "Password": $("#RegisterForm").find('input[name="Password"]').val(),
                        "ConfirmPassword": $("#RegisterForm").find('input[name="ConfirmPassword"]').val(),
                        "Tel": '',
                        "RecaptchaToken":$('#RegisterForm textarea').val()
                            //$('.h-captcha iframe').data("hcaptcha-response")
                            //$("iframe").attr("data-hcaptcha-response")
                          //  $('[name=h-captcha-response]').val()
                      
                    },
                    success: function (data) {
                        if (data.ErrorCode === 200) {
                            $(".register-close-submit").trigger('click');
                            alert('Welcome! 歡迎申請[大台北公車]會員');
                        }
                        if (data.ErrorCode === 201) $("#RegisterForm").find('input[name="recaptcha_challenge_field"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                        if (data.ErrorCode === 202) $("#RegisterForm").find('input[name="Password"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });


            }
        });

        $("#RegisterForm").find('input[name="Email"]').focusout(function () {
            if ($("#RegisterForm").find('input[name="Email"]').valid())
            $.ajax({
                url: '/Account/AccountAvailable',
                dataType: "json",
                type: "post",
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    "account": $("#RegisterForm").find('input[name="Email"]').val()
                },
                success: function (data) {
                    if (data.ErrorCode === 100) {
                        $(".register-check-icon").css("background-color", "#75bc59");
                        $(".register-check-icon").text('✔');
                        $(".register-check-icon").show();
                    }
                    if (data.ErrorCode === 101) {
                        $(".register-check-icon").css("background-color", "#FF0000");
                        $(".register-check-icon").text('✘');
                        $(".register-check-icon").show();
                    }
                }
            });
        });

        $(".register-close-submit").click(function () {

            CloseRegisterDialog();

        });
    });
</script>

<!-- dialog_忘記密碼 BEGIN-->
<div id="ForgetPw_DL" class="teBus-dialog-c" style="display:none">
    <form id="ForgotPasswordForm">
        <div class="teBus-dialog forgot-password-c">
            <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img forgot-password-img" alt=" "></span>忘記密碼</h1>
            <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0)" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
            <ul class="teBus-dialog-ul">
                <li class="teBus-dialog-li">
                    <span class="teBus-dialog-li-title">電子郵件 </span>
                    <label><input class="teBus-dialog-input-text-one" data-val="true" data-val-email="電子郵件欄位不是有效的電子郵件地址。" data-val-required="電子郵件是必要項" id="Email" name="Email" type="text" value="" /></label>
                    <span class="field-validation-valid teBus-diolag-note" data-valmsg-for="Email" data-valmsg-replace="true"></span>
                </li>
                <li class="teBus-dialog-li"  style=" margin:0 auto;width: 50%;">
                    
                    
                    <div class="h-captcha" data-sitekey="e57803e5-35a9-40c1-92dc-889ae1a81fc8"></div>
                    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
                </li>
            </ul>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-enter-submit">送出</a>
            <a href="javascript:void(0)" class="teBus-dialog-submit forgot-password-close-submit">取消</a>
        </div>
    </form>
</div>
<!-- dialog_忘記密碼 END-->

<script>
    function OpenForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('open');
    }
    function CloseForgotPasswordDialog() {
        $("#ForgetPw_DL").dialog('close');
    }

    $(function () {
        $("#ForgetPw_DL").show();
        $("#ForgetPw_DL").dialog({
            autoOpen: false,
            modal: true,
            width: $("#ForgetPw_DL").find('.teBus-dialog').width(),
            show: {
                effect: "clip",
                duration: 300
            },
            hide: {
                effect: "clip",
                duration: 300
            },
            close: function (event, ui) {
                $("#ForgotPasswordForm").find('input[name="Email"]').val('');
            },
            position: { my: "center", at: "center", of: window }
        });
        $('.forgot-password-enter-submit').click(function () {
            if ($('#ForgotPasswordForm').valid()) {
                $.ajax({
                    url: '/Account/ForgotPassword',
                    dataType: "json",
                    type: "post",
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest',
                        "Email": $("#ForgotPasswordForm").find('input[name="Email"]').val(),
                        "RecaptchaToken": $('#ForgotPasswordForm textarea').val()
                    },
                    success: function (data) {
                        if (data.ErrorCode === 300) {
                            $(".forgot-password-close-submit").trigger('click');
                            alert(data.Msg);
                        }
                        if (data.ErrorCode === 301 || data.ErrorCode === 103) $("#ForgotPasswordForm").find('input[name="Email"]').closest('.teBus-dialog-li').find('.teBus-diolag-note').text(data.Msg);
                    }
                });
            }
        });

        $(".forgot-password-close-submit").click(function () {
            CloseForgotPasswordDialog();
        });
    });
</script>


<script>
    $(function () {
        // Login link clicked
        $(".login-link").click(function () { OpenLoginDialog(); });
    });
</script>

        <!--end main list -->
        
<input name="__RequestVerificationToken" type="hidden" value="hovjg0z_7rM2gPifdWHZnwYYSIqK0gVgyzq4BO6poxqyCB6JGWr9-i1-ZHOeT2kPqHMHajHpe7xjk2qbxY_KJqmY-Rk1" />
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-54651832-1', { 'cookieDomain': 'none' });
  ga('set', 'language', 'zh-TW');
  ga('set', 'screenResolution', screen.width + 'x' + screen.height);
  ga('set', 'viewportSize', screen.availWidth + 'x' + screen.availHeight);
  ga('set', 'screenColors', screen.colorDepth + '-bits');
  ga('set', 'hostname', location.hostname);

  ga('send', 'pageview');
  ga('send', 'event', {
      'eventCategory': 'PageView',
      'eventAction': 'Inter',
      'eventLabel': document.location.pathname,
      'eventValue': 1
  });

</script>

<script>
    $(function () {
        var token = $('input[name=__RequestVerificationToken]').filter(function () { return $(this).val() !== '' });
        $('input[name=__RequestVerificationToken]').val(token.val());
    });
</script>

    <script>
        $(function () {
            $('#sectionMain').show();
        });
    </script>

<script>
    $(function () {
    var alertPageNum = '2';
        $.ajax({
            url: '/NewsAlert/GetAlertNews',
            type: 'post',
            dataType: 'json',
            data: {
                '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                'X-Requested-With': 'XMLHttpRequest'
            },
            error: function (response) {
            },
            success: function (response) {
                response.forEach(function (info) {
                    var s = info.AlertPageList.split(';');
                    s.forEach(function (v) {
                        if (v == alertPageNum) {
                            var img = '';
                            if (info.AlertPicLink != null && info.AlertPicLink.length > 0)
                            {
                                //img = '<img src="' + info.AlertPicLink + '"   ><br/>';
                                img = '<img class="swal2-image" src="' + info.AlertPicLink + '" alt="">';
                                //img = info.AlertPicLink;
                            }

                            if (localStorage.getItem("FnAlertId" + info.Id) != "true")
                                Swal.fire({
                                    title: '<font color="#E78838">' + info.AlertContent + '</font>',
                                    html: img,
                                    //imageUrl: img,
                                    async: false,
                                    confirmButtonText: '確定',
                                    input: 'checkbox',
                                    inputPlaceholder: '不再提示'
                                }).then((result) => {
                                    /* Read more about isConfirmed, isDenied below */
                                    if (result.isConfirmed) {
                                        if (result.value) {
                                            localStorage.setItem("FnAlertId" + info.Id, "true");
                                        } else { }
                                    } else if (result.isDenied) {
                                        //Swal.fire('Changes are not saved', '', 'info')
                                    }
                                });//end swal
                        }
                    });

                });//for
            },
            complete: function () {
              
            }
        });
    });

</script>
<section class="info-c route-list" id="sectionMain" style="display:none;">
    <div id="findPanel" class="word-info-c stationlist-c">
        <h2>查詢結果</h2>
        <div class="search-c">
            <div class="stationlist-text-c">
                                <img src="/images/new_taipei_city.svg" width="100%" class="vipstop-city" alt="新北市">                
 <span class="stationlist-title">F126 </span>                 

                        <a href="../EBus/VsSimpleMap?routeid=0454012600" class="stationlist-move-route-icon stationlist-move-table-icon @*pad-none*@" title="動態簡圖" alt="動態簡圖"></a>
                    <a href="../MapOverview?nid=0454012600" target="_blank" class="stationlist-move-route-icon stationlist-route-list-icon" style="width:90px;height:30px;position:relative;" title="路線圖" alt="路線圖"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-info-table-icon " title="公車資訊" alt="公車資訊"></a>
                        <a href="javascript:void(0);" class="stationlist-move-route-icon stationlist-bus-time-icon" title="時刻表" alt="時刻表"></a>

                    <br />


                            <a style="color:#4CAF50;">新北市政府交通局公車申訴服務電話02-89682460</a></div>
            <ul class="stationlist-move-route-bus-info" style="display: none;">
                <li>
                    <span class="stationlist-move-route-bus-item">起迄站名 :</span>
                    <span class="stationlist-move-route-bus-content">八里分駐所 - 長庚醫院</span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">頭末班車 :</span>
                    <span class="stationlist-move-route-bus-content">
                        [平日] 0630 - 1710 <br>
                        [假日] 0630 - 1710
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item-02">發車間隔 :</span>
                    <span class="stationlist-move-route-bus-content">
[平日] <br /> F126八里分駐所班表:0630 1500 1710<br/>F126長庚醫院班表:0700 1530 1800<br>
[假日]<br /> F126八里分駐所班表:0630 1500 1710<br/>F126長庚醫院班表:0700 1530 1800<br>
                    </span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">分段緩衝 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">收費方式 :</span>
                    <span class="stationlist-move-route-bus-content"></span>
                </li>
                <li>
                    <span class="stationlist-move-route-bus-item">業者服務電話 :</span>
                        <span class="stationlist-move-route-bus-content">八里區公所八里區公所站:(02)2610-2621</span>
                </li>

            </ul>
                <p class="stationlist-come-go-c">
                    <a href="javascript:void(0);" class="stationlist-come-go stationlist-go">去程往 長庚醫院</a>
                    <a href="javascript:void(0);" class="stationlist-come-go-gray stationlist-come">返程往 八里分駐所</a>
                </p>


            <p> 
</p>
        </div>

        <div id="GoDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c" >
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">八里分駐所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200000" />
                                    <input data-val="true" data-val-number="欄位 Latitude 必須是數字。" data-val-required="Latitude 欄位是必要項。" id="item_Latitude" name="item.Latitude" type="hidden" value="25.145911" />
                                    <input data-val="true" data-val-number="欄位 Longitude 必須是數字。" data-val-required="Longitude 欄位是必要項。" id="item_Longitude" name="item.Longitude" type="hidden" value="121.3977429" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">八里</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494300000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.146813" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.398251" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">下庄市場</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494700520" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.146794" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.399874" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">廖添丁廟</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200540" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.143191" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.396419" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">中華路三段88巷口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200220" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.138517" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.39295" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">樂山療養院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200640" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.12882" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.39215" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">楓林坑口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2524502320" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.127284" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.390733" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">長坑國小</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494100720" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.125668" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3907228" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">林口加油站2</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2445000460" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.077883" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.396665" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">林口區公所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2444902460" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.076704" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.388861" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">林口高中</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2444902360" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.07399" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.380874" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 12</span>
                                    <span class="auto-list-stationlist-place">崇林國中</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2444701060" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.068593" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3697419" />
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 13</span>
                                    <span class="auto-list-stationlist-place">長庚醫院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="3337500340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.059661" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3678435" />
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
        <div id="BackDirectionRoute" class="auto-list-pool-c stationlist-list-pool-c"   style = "display:none">
            <ul class="auto-list-pool stationlist-list-pool">

                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 1</span>
                                    <span class="auto-list-stationlist-place">長庚醫院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="3337500340" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.059661" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3678435" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 2</span>
                                    <span class="auto-list-stationlist-place">崇林國中</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2444903620" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.068202" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3697713" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 3</span>
                                    <span class="auto-list-stationlist-place">林口高中</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2444902320" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.073847" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.38103" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 4</span>
                                    <span class="auto-list-stationlist-place">林口區公所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2444902420" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.07654" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.388861" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 5</span>
                                    <span class="auto-list-stationlist-place">林口加油站2</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2445000420" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.077807" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.396844" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 6</span>
                                    <span class="auto-list-stationlist-place">樂山療養院</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200620" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.128764" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.392253" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 7</span>
                                    <span class="auto-list-stationlist-place">中華路三段99巷口</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200200" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.138831" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.39325" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 8</span>
                                    <span class="auto-list-stationlist-place">八里分駐所</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.145911" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.3977429" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 9</span>
                                    <span class="auto-list-stationlist-place">八里</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494300000" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.146813" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.398251" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 10</span>
                                    <span class="auto-list-stationlist-place">下庄市場</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494700520" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.146794" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.399874" />
                                   
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="javascript:void(0);" class="auto-list-link auto-list-stationlist-link">
                                <span class="auto-list auto-list-stationlist">
                                    <span class="auto-list-stationlist-position auto-list-stationlist-position-time"></span>
                                    <span class="auto-list-stationlist-number"> 11</span>
                                    <span class="auto-list-stationlist-place">廖添丁廟</span>
                                    <input id="item_UniStopId" name="item.UniStopId" type="hidden" value="2494200540" />
                                    <input id="item_Latitude" name="item.Latitude" type="hidden" value="25.143191" />
                                    <input id="item_Longitude" name="item.Longitude" type="hidden" value="121.396419" />
                                   
                                </span>
                            </a>
                        </li>
            </ul>
        </div>
    </div>
    <!-- being 地圖區塊縮合 -->
    

<link href="/jss/leaflet/leaflet.css" rel="stylesheet" />
<script src="/jss/leaflet/leaflet.js"></script>
<script src="/jss/leaflet/wicket.js"></script>
<script src="/jss/leaflet/wicket-leaflet.js"></script>
<script src="/jss/LMap.js"></script>
<script src="/jss/LMapLayerToggle.js"></script>


<!-- being 地圖區塊縮合 -->
<div class="map-s-c">
    <a href="javascript:void(0);" id="close-open-map" class="open-map-icon pad-none" title="展開地圖" alt="展開地圖"></a>
    <div class="map-date">
        <div class="map-icon-pool-c">
            <div class="map-icon-pool">
                <a href="javascript:void(0);" class="map-icon map-youbike" title="YouBike" alt="YouBike"></a>
                
                <a href="javascript:void(0);" class="map-icon map-my-place" title="&lt;我的位置&gt;" alt="&lt;我的位置&gt;"></a>
               <!-- <a href="javascript:void(0);" id="MapButton" class="map-icon map-map" title="開啟地圖" alt="開啟地圖"></a>-->
            </div>
        </div>
        <div id="map_canvas" class="map">
            <a href="javascript:void(0);"  style="color: #0094ff" id="maplink" title="開啟地圖" alt="開啟地圖">開啟地圖</a>
           
        </div>
    </div>
</div>
<style>
    .word-info-none {
        display: none;
    }
</style>
<script>
    $('#close-open-map').click(function () {
        $('#close-open-map').toggleClass("close-map-icon pad-none");
        $('.map-s-c').toggleClass("map-b-c pad-none");
        $('#findPanel').toggleClass("word-info-none");

        var cls = $('#close-open-map').attr('class');
        if (cls == "open-map-icon close-map-icon") {
            $('#close-open-map').attr("title", i18n._('Shrink the map'));
            $('#close-open-map').attr("alt", i18n._('Shrink the map'));
        }
        else{
            $('#close-open-map').attr("title", i18n._('Enlarge the map'));
            $('#close-open-map').attr("alt", i18n._('Enlarge the map'));
        }

        MoveCenter();
    });

    //地圖縮放用
    function MoveCenter() {
        map.invalidateSize();
    };

    $('.map-youbike').click(function () {
        $('.map-youbike').toggleClass("map-youbike-o");
        var bl = $('.map-youbike').hasClass("map-youbike-o");

        if (bl) YoubikeFetch();
        else StopFetchYoubike();
    });

    $('.map-newbike').click(function () {
        $('.map-newbike').toggleClass("map-newbike-o");
        var bl = $('.map-newbike').hasClass("map-newbike-o");

        if (bl) NewbikeFetch();
        else StopFetchNewbike();
    });

    $('.map-my-place').click(function () {
        $('.map-my-place').toggleClass("map-my-place-o");
        var bl = $('.map-my-place').hasClass("map-my-place-o");

        if (bl) getLocation();
        else clearNowLocMarkers()
    });

    function newloadmap()
    {

    }

    $('.map-map').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });

    $('#maplink').click(function () {
        var options = {
            zoom: 10,
            center: centerPoint,
            mapTypeId: google.maps.MapTypeId.ROADMAP,
            mapTypeControl: false,
            zoomControl: true,
            zoomControlOptions: {
                style: google.maps.ZoomControlStyle.SMALL
            },
            styles: [{ featureType: "landscape", stylers: [{ saturation: -100 }, { lightness: 60 }] }, { featureType: "road.local", stylers: [{ saturation: -100 }, { lightness: 40 }, { visibility: "on" }] }, { featureType: "transit", stylers: [{ saturation: -100 }, { visibility: "simplified" }] }, { featureType: "administrative.province", stylers: [{ visibility: "off" }] }, { featureType: "water", stylers: [{ visibility: "on" }, { lightness: 30 }] }, { featureType: "road.highway", elementType: "geometry.fill", stylers: [{ color: "#ef8c25" }, { lightness: 40 }] }, { featureType: "road.highway", elementType: "geometry.stroke", stylers: [{ visibility: "off" }] }, { featureType: "poi.park", elementType: "geometry.fill", stylers: [{ color: "#b6c54c" }, { lightness: 40 }, { saturation: -40 }] }, {}]
        };
        $("#MapButton").hide();
        map = new google.maps.Map(document.getElementById("map_canvas"), options);

        // 畫路線軌跡
        drawRouteTrack();

        var routePathBounds = new google.maps.LatLngBounds();
        var path = new google.maps.MVCArray();

        if (objArr.RouteTracks.length != 0) {
            for (var i = 0; i < objArr.RouteTracks.length; i++) {
                var latlng = new google.maps.LatLng(objArr.RouteTracks[i]
                    .Latitude,
                    objArr.RouteTracks[i].Longitude);
                path.push(latlng);
                routePathBounds.extend(latlng);
            }
            routePath.setPath(path);
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }

        pointRouteStops(true);
        routePath.setOptions({ strokeColor: '#9863b6' });


        if (objArr.RouteTracks.length != 0) {
            if (map == null)
            { }
            else {
                map.fitBounds(routePathBounds);
            }
        }
        stopStationStatusReport();
        stationStatusReport();
        stopBusStatusReport();
        busStatusReport();

    });


</script>
    <!-- end 地圖區塊縮合 -->

</section>

<section class="info-c route-chart" style="display:none;">
    <!--路線簡圖-->
</section>

<div id="Toolbar" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog tool-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img tool-dialog-img" alt=" "></span>快捷工具列</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <div class="tool-icon-pool">
            <a id="routeList" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_route_icon.svg" width="100%" alt="行經路線">行經路線</a>
            <a id="busAlert" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_remind_icon.svg" width="100%" alt="到站提醒">到站提醒</a>
            <a id="addToMybus" href=javascript:void(0) class="teBus-login-dialog-link-one"><img src="/images/dialog_add_bus_icon.svg" width="100%" alt="加入我的公車">加入我的公車</a>
            <a class="teBus-login-dialog-link-one-recent3" id="recent3">
                <font>
                    .</font><br />
                    <font>
                        .</font><br />
                        <font">.</font><br />
            </a>
</div>
    </div>
</div>

<input type="hidden" id="selected_stop_id" />
<input type="hidden" id="selected_stop_name" />
<div id="SetAlertTime" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>設定到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="set-up-remind-dialog-c">
            <a href="javascript:setAlertConfirm(180);" class="set-up-remind-time-dialog">3分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(300);" class="set-up-remind-time-dialog">5分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(600);" class="set-up-remind-time-dialog">10分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(900);" class="set-up-remind-time-dialog">15分鐘前提醒</a>
            <a href="javascript:setAlertConfirm(1200);" class="set-up-remind-time-dialog">20分鐘前提醒</a>
        </div>
    </div>
</div>
<div id="News_Detail_DL" class="teBus-dialog-c" style="display:none">
    <div class="teBus-dialog news-dialog-c">
        <h1 class="teBus-dialog-h1"><span class="teBus-dialog-title-img remind-dialog-img" alt=" "></span>到站提醒通知</h1>
        <span class="teBus-dialog-close-icon-c"><a href="javascript:void(0);" class="teBus-dialog-close-icon" title="關閉" alt="關閉"></a></span>
        <div class="remind-dialog-c">
        </div>
    </div>
</div>
<script>
    $(function () {
        window.setInterval(StartBusArrivalAlert, 1000 * 60);

        $("#News_Detail_DL").dialog({
            autoOpen: false,
            width: $('#News_Detail_DL').width(),
            modal: true,
            show: {
                effect: "clip",
                duration: 600
            },
            buttons: {},
            hide: {
                effect: "clip",
                duration: 500
            },
            close: function (event, ui) {
                $('#News_Detail_DL').find('.remind-dialog-c').html('');
            }
        });

        $(".ui-dialog-titlebar").hide();
    });
    function StartBusArrivalAlert() {
        if (localStorage.bus_alert !== undefined && !$("#News_Detail_DL").dialog("isOpen")) {
            var busAlert = JSON.parse(localStorage.bus_alert);
            var m = $.map(busAlert, function (value, index) {
                return { "UniStationId": value.StopId, "UniRouteId": value.RouteId, "UniBusId": "", "BusLicence": "", "BusType": 0, "RouteDirect": 0, "ETA": 0 };
            });
            $.ajax({
                url: '/Stop/StatusOfRutStp',
                type: 'post',
                dataType: 'json',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'models': JSON.stringify(m)
                },
                error: function (response) {

                },
                success: function (response) {
                    $.each(busAlert, function (idx, val) {
                        $.each(response, function (index, value) {
                            if (value.ETA !== 0 && val.RouteId === value.UniRouteId &&
                                val.StopId === value.UniStationId && val.SetTime > value.ETA) {
                                $('#News_Detail_DL').find('.remind-dialog-c').append(
                                    $('<p/>', { 'class': 'remind-content-dialog', 'text': val.RouteName + " " + val.StopName }),
                                    $('<p/>', { 'class': 'remind-time-dialog', 'text': i18n._('Estimate') + Math.floor(value.ETA / 60) + i18n._('Arrives minute(s)') })
                                );
                                for (var i = 0; i < busAlert.length; i++) {
                                    if (busAlert[i].RouteId == value.UniRouteId && busAlert[i].StopId == value.UniStationId && val.SetTime > value.ETA) {
                                        busAlert.splice(i, 1);
                                    }
                                    AlertDelete(i);
                                }
                                localStorage.setItem('bus_alert', JSON.stringify(busAlert));
                            }
                        });
                        if ($('#News_Detail_DL').find('.remind-dialog-c').html().trim() !== '') {
                            if (!$("#News_Detail_DL").dialog("isOpen")) {
                                $("#News_Detail_DL").dialog("open");
                            }
                        }
                    });
                }
            });
        }
    }
</script>

<div id="AddToMyBus" class="teBus-dialog-c" style="display:none;">
    <div class="teBus-dialog alternative-route-dialog-c">
        <h1 class="teBus-dialog-h1">選擇公車群組</h1>
        <span class="teBus-dialog-close-icon-c"><a href="#" class="teBus-dialog-close-icon" title="關閉"></a></span>
        <ul class="dialog-chose-bos-group-pool"></ul>
    </div>
</div>





    </div>
    <!-- end content -->
    <!-- loading dialog -->
    <div id="Loading_DL" class="teBus-dialog-c" style="display: none;">
        <div class="teBus-dialog loading-dialog-c">
            <p class="loading-dialog-p"><img src="/images/dialog_loading_bus_img.gif" class="loading-dialog-img" width="100%" alt=" ">資料載入中，請稍候</p>
        </div>
    </div>
    <!-- end loading dialog -->
    
<footer class="teBUS-main-footer">
    <div class="teBUS-main-footer-logo">
                <a href="https://www.gov.taipei/" target="_blank" class="teBUS-main-footer-taipei" title="臺北市政府" alt="臺北市政府"><img src="/images/taipei_city.svg" width="100%" title="臺北市政府" alt="臺北市政府"></a>
                <a href="https://www.ntpc.gov.tw/" target="_blank" class="teBUS-main-footer-new-taipei" title="新北市政府" alt="新北市政府"><img src="/images/new_taipei_city.svg" width="100%" title="新北市政府" alt="新北市政府"></a>

      
        <span class="teBUS-main-footer-ebus-logo" title="大臺北公車"><img src="/images/logo_img02.svg" width="100%" title="大臺北公車" alt="大臺北公車"></span>
    </div>
    <div class="teBUS-main-footer-text">
        <p class="teBUS-main-footer-Copyright">本網站所有版權歸屬於臺北市政府與新北市政府 Copyright&#169;2014<span></span></p>
        <p>
            建議瀏覽器IE9.0以上版本/Firefox/Google Chrome (最佳螢幕解析1024*768) <br />
            如有大臺北公車網站服務任何問題，請撥1999為您服務
            聯絡地址:110210臺北市信義區松德路300號4樓
        </p>
    </div>
    <div class="teBUS-main-footer-link-pool">
        <a href="/Home/WebSite" class="teBUS-main-footer-link" target="_self">網站導覽</a>
        
        <a href="/Home/CopyrightNotice" class="teBUS-main-footer-link" target="_self">著作權聲明</a>
        <a href="/Home/SecurityPrivacyPolicy" class="teBUS-main-footer-link" target="_self">隱私權及網站安全政策</a>
        <p class="teBUS-main-footer-date">網站更新日期:<span>2025-06-02</span><br />網站檢視日期:2025-06-02</p>
    </div>
</footer>
<!-- end footer -->

    <script src="/bundles/modernizr?v=wBEWDufH_8Md-Pbioxomt90vm6tJN2Pyy9u9zHtWsPo1"></script>

    
    <script src="/jss/tebus-script.js"></script>
    <script src="/bundles/sweetAlert?v=cMcnF9PMfZnW6d_oMLsRilV8d-Fh8HT8X6rfi8S_EV41"></script>

    <script src="/sweetAlert/css?v=Q7l7a83fZdl7_6jt13P3HsHoLWvbYv1YpqCreuQlPuQ1"></script>

    <script src="/bundles/sweetAlert2?v=PwfQxO_e6ZEtKGd2oGReTt3SIS48xCdv8zRgwComWDA1"></script>

    <script src="/sweetAlert2/css?v=fJb18S8FvSIfJsXWl8pwQn02lsvJyZVA2V9a_xRxskI1"></script>

    
    <script src="/bundles/customScrollbar?v=FNWrR0EcYik_CfSZ44D3T7EmJWx0Sy8nttPc_daLKEU1"></script>

    <script src="/bundles/busInfoHelper?v=Bz-GVCVvhrGERqTqUhEyiA19qHoesHwpCKpDnLmBTC81"></script>

    <script src="/bundles/busArrivalAlert?v=MDKgeaTn7JrPx59avQagl_lTQuO4AjqKyXZGq_1HMcs1"></script>

    <script src="/bundles/jqueryval?v=kO9SZjRLUEvNZbFlwaT1hsJ0t0ngQHk32HeNdumCbRM1"></script>

    <script src="/bundles/toastr?v=nU7i1d5lsXeim4T9MB2Gdegj9fc8yXl1nK6hEZMOAm81"></script>

    
<style>
.marker-g {
    background-image: url("../images/mapIcon/station_01.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .marker-b {
    background-image: url("../images/mapIcon/station_02.png");
    background-size:24px 24px;
	/*background-color: rgba(218, 94, 94, 0.6);*/
	}
    .custompopup .leaflet-popup-content-wrapper a {
    color: #ffffff;
}
    .custompopup .leaflet-popup-content p{
    margin: 0;
}
    


    </style>

<script src="/jss/VsSimpleMap.js"></script>

    <script>

        viccknCulture = 'zh-TW';
        //var InfoBox = new google.maps.InfoWindow({ content: " " });
        var routePath;
        var Marker_Bus_Status = [];
        var busFetchInterval = null;
        var stopFetchInterval = null;
        var goStopStationNum = []; //去程站位數量
        var backStopStationNum = []; //返程站位數量



        //#region 時刻表
        $('.stationlist-bus-time-icon').click(function () {
            var _date = new Date();
            var _nowDate = _date.getFullYear() + "/" +( _date.getMonth()+1) + "/" + _date.getDate();
            //var _url = "http://web.taiwanbus.tw/eBUS/subsystem/Timetable/TimeTableAPIByWeek.aspx?RouteId=" + "" + "&SearchDate=" + _nowDate;
            var _url = "../Route/RouteSchedule?routeid=0454012600";

            window.open(_url, "_blank");
        });
        //#endregion


        var existGoNum = 13;
        var existBackNum = 11;

        function getStopStationNum(goBack) {
            switch (goBack) {
                case 1:
                    var go = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (go && go.length === existGoNum) {
                        goStopStationNum = go;
                    }

                    goStopStationNum = $("#GoDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });
                    break;
                case 2:
                    var back = $("#BackDirectionRoute div > div > li > a > span > span.auto-list-stationlist-number")
                        .text()
                        .trim()
                        .split(' ')
                        .filter(function(v){return v!==''})
                        .map(function(item, index) { return parseInt(item) });

                    if (back && back.length === existBackNum) {
                        backStopStationNum = back;
                    }

                    break;

            }
        }

        getStopStationNum(1);
        getStopStationNum(2);

        function bindInfoWindow(marker, map, InfoBox, content) {
            google.maps.event.addListener(marker,
                'click',
                function() {
                    InfoBox.setContent(content);
                    InfoBox.open(map, marker);
                });
        }

        function createBusMarker(lat, lng, title, icon) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(lat, lng),
                map: map,
                title: title,
                icon: icon
            });
            Marker_Bus_Status.push(marker);
        }

        function clearBusMarkers() {
            while (Marker_Bus_Status[0]) {
                Marker_Bus_Status.pop().setMap(null);
            }
        }

        function drawRouteTrack() {
            routePath = new google.maps.Polyline({
                geodesic: true,
                strokeColor: '#9863b6',
                strokeOpacity: 1.0,
                strokeWeight: 4
            });
            routePath.setMap(map);
        }


        function pointRouteStopsLMap(isGoDirection) {
            clearMarkers();
            var stops;
            var iconUrl;
            if (isGoDirection) {
                if (objArr.GoDirStops ==null)
                {stops = objArr.BackDirStops;
                    iconUrl = 'marker-g';
                }
                else
                {
                    stops = objArr.GoDirStops;
                    iconUrl = 'marker-g';
                }
                //stops = objArr.GoDirStops;
                //iconUrl = 'marker-g';
            } else {
                stops = objArr.BackDirStops;
                //iconUrl = "images/mapIcon/station_02.png";
                iconUrl = 'marker-b';
            }
            var arMarker = [];
            for (var i in stops) {
                infoLink =
                    "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'><p class='inforwindow-1ocation'>" + stops[i].Name + "</p><p class='inforwindow-1ocation-number'>"+ "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";
                // "<div class='inforwindow-bike-c'><div class='inforwindow-1ocation-c'>" + "<p class='inforwindow-1ocation-number'>" + stops[i].PublicId + "</p></div><a class='inforwindow-transplan-start-end-icon02' href='" + SitePath + "Stop/RoutesOfStop?Stopid=" + stops[i].UniStopId + "'>" + i18n._('List of Routes') + "</a></div>";

                var GoStopsicon = new L.DivIcon({ html: '<div align="center"  valign="center"><span>' + (parseInt(i)+1) + '</span></div>', className:  iconUrl, iconSize: new L.Point(24, 24),iconAnchor: [12, 24], });
                //var GoStopsicon = L.icon({
                //    iconUrl: '/images/mapIcon/station_01.png',
                //    iconSize: [16, 16]
                //});
                m = L.marker([stops[i].Latitude, stops[i].Longitude], { icon: GoStopsicon });
                m.bindPopup(infoLink, {
                    maxWidth : 300,
                    maxHeight:170,
                    className:'custompopup'
                });
                setStationMarkers(m);
                //m.bindTooltip(data[i].tooltip);

                arMarker.push(m);
            }
            StoplayerGroup = L.layerGroup(arMarker).addTo(map)
            //layerMap.set('layername', L.layerGroup(arMarker).addTo(map));
        }

        function stopStatusRecent3Report(stopId) {
            (
                function startFatch() {
                    $.ajax({
                        // url: '/Route/StopStatusRecent3OfRoute?routeid=0454012600',
                        url: './StopStatusRecent3OfRoute?routeid=0454012600&stopid='+stopId,
                        type: 'post',
                        dataType: 'html',
                        data: {
                            '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                            'X-Requested-With': 'XMLHttpRequest'
                        },
                        error: function(xhr) {

                        },
                        success: function(response) {
                            // clearBusMarkers();
                            //var jsonObjArr = JSON.parse(response);// vic
                            // var jsonObjArr = response;
                            //  alert(response);
                            $('#recent3').empty();
                            $('#recent3').append(response);


                        }
                    });
                    //if (busFetchInterval == null) {
                    //    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                    //}
                })();
        }

        function busStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/BusStatusOfRoute?routeid=0454012600',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        clearBusMarkers();
                        var jsonObjArr = JSON.parse(response);// vic
                        // var jsonObjArr = response;
                        if (BuslayerGroup != null) {
                            BuslayerGroup.clearLayers();
                        }
                        var arMarker = [];
                        for (var i in jsonObjArr) {
                            if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                                    $('.stationlist-come-go-c').length === 0) &&
                                jsonObjArr[i].RouteDirect === 1) {

                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                                //createBusMarker(value.position.Latitude,
                                //    value.position.Longitude,
                                //    value.BusLicence,
                                //    busIcon(value.BusType));
                            }
                            if ($('.stationlist-come').hasClass('stationlist-come-go') && jsonObjArr[i].RouteDirect === 2) {
                                m = L.marker([jsonObjArr[i].position.Latitude, jsonObjArr[i].position.Longitude], { icon:  L.icon({iconUrl: busIcon(jsonObjArr[i].BusType),iconAnchor: [16, 32]}) });
                                m.bindPopup(jsonObjArr[i].BusLicence);
                                arMarker.push(m);
                            }


                        }
                        BuslayerGroup = L.layerGroup(arMarker).addTo(map)
                        //$.each(jsonObjArr,
                        //    function(idx, value) {
                        //        if (($('.stationlist-go').hasClass('stationlist-come-go') ||
                        //                $('.stationlist-come-go-c').length === 0) &&
                        //            value.RouteDirect === 1) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //        if ($('.stationlist-come').hasClass('stationlist-come-go') && value.RouteDirect === 2) {
                        //            //createBusMarker(value.position.Latitude,
                        //            //    value.position.Longitude,
                        //            //    value.BusLicence,
                        //            //    busIcon(value.BusType));
                        //        }
                        //    });
                    }
                });
                if (busFetchInterval == null) {
                    busFetchInterval = window.setInterval(startFatch, 1000 * 13);
                }
            })();
        }

        function stopBusStatusReport() {
            clearBusMarkers();
            clearInterval(busFetchInterval);
            busFetchInterval = null;
        }

        function busIcon(btype) {
            var url;
            if (btype === 2) {
                url = SitePath + "images/mapIcon/LowFloorBus06.png";
                return url;
            }
            if (btype === 51) {
                url = SitePath + "images/mapIcon/FukangBus06.png";
                return url;
            }
            if (btype === 52) {
                url = SitePath + "images/mapIcon/YuanZaiBus06.png";
                return url;
            }
            if (btype === 6) {
                url = SitePath + "images/mapIcon/AccMiniBus06.png";
                return url;
            }
            url = SitePath + "images/mapIcon/NormalBus06.png";
            return url;
        }

        //依據清單，過濾重複項目
        function unique(list) {
            var result = [];
            $.each(list,
                function(i, e) {
                    if ($.inArray(e, result) === -1) result.push(e);
                });
            return result;
        }

        function stationStatusReport() {
            (function startFatch() {
                $.ajax({
                    url: '/Route/StopStatusOfRoute?routeid=0454012600',
                    type: 'post',
                    dataType: 'json',
                    data: {
                        '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                        'X-Requested-With': 'XMLHttpRequest'
                    },
                    error: function(xhr) {

                    },
                    success: function(response) {
                        // Clearing
                        $('.auto-list-stationlist-bus').remove();
                        $('.auto-list-stationlist-position')
                            .removeClass('auto-list-stationlist-position-none auto-list-stationlist-position-now auto-list-stationlist-position-time')
                            .html('');
                        
                        var jsonObjArr = JSON.parse(response);
                        var goStationList = []; //去程站位及站序
                        var backStationList = []; //返程站位及站序
                        var uniStation = []; //取得車號
                        var tempduplicate = [];//重複站牌編號項目(暫存)
                        var duplicateStation; //重複站排項目
                        var filterDuplicate;//取得有重複的站位及公車編號

                        if (jsonObjArr.length !== 0) {

                            var hasSeq = jsonObjArr[0].StopSequence !== 65535;
                            //hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                            // if ($('.stationlist-go').hasClass('stationlist-come-go') ||$('.stationlist-go').hasClass('stationlist-go')) {
                            if ($('.stationlist-go').hasClass('stationlist-come-go') ||objArr.BackDirStops === null) {
                                //if ($('.stationlist-go').hasClass('stationlist-come-go') ||!($('.stationlist-come-go-c').length == 0)) {

                                //取得去程站位及站序
                                $.each( $('#GoDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    goStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                        
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                if (tempduplicate.length==0)
                                {hasSeq=false;
                                }

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(goStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                //去程
                                $('#GoDirectionRoute li').map(function(index, item) {

                                    //站排編號
                                    var _UniStopId = $(item).find('input#item_UniStopId').val();
                                    //站牌站序
                                    var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());

                                    var tmp = jsonObjArr.filter(function(item) {

                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                        return false;
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }
                                            }
                                        }

                                        if (value.Vehicles.length > 0) {

                                            var _html = "<span class='auto-list-stationlist-bus'>";

                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                //'<img src=\"../images/seats/seat00.png\">'
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                {
                                                    if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                        value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                        dogimg="<img src='" +
                                                            SitePath +
                                                            "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                    }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html = _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                        "'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }
                                        if(value.NextDepTime!='FF')
                                        {
                                           
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else
                                    {
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });

                            } else {

                                //取得返程站位及站序
                                $.each( $('#BackDirectionRoute li  '), function( index, item ){
                                    var uniStopId = $(item).find('input#item_UniStopId').val();
                                    var stopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim());
                                    backStationList.push({ stopSeq: stopSeq, uniStopId: uniStopId });
                                });

                                //取得相同站牌編號
                                $.grep(jsonObjArr,function(item) {

                                    if (($.inArray(item.UniStationId, uniStation) === -1)) {
                                        //未重複
                                        uniStation.push(item.UniStationId);
                                    } else {
                                        //有重複
                                        tempduplicate.push(item.UniStationId);
                                    }
                                });

                                //重複站排項目
                                duplicateStation = unique(tempduplicate);

                                //取得有重複的站位及公車編號
                                filterDuplicate = $.grep(jsonObjArr,function(item) {

                                    //取得有重複站位
                                    if (($.inArray(item.UniStationId, duplicateStation) !== -1)) {

                                        //確定該站位，有在站位列表中
                                        var result = $.grep(backStationList,function(e) { return e.uniStopId === item.UniStationId; });

                                        if (result && result.length > 0) {

                                            //在資料內找出該站位的進站公車，是否有重複
                                            if (item.Vehicles && item.Vehicles.length > 0) {

                                                //依據該公車編號，取得是否有重複的
                                                var busIdDuplicate = $.grep(item.Vehicles,function(value) {

                                                    var getVehicles = $.grep(jsonObjArr,function(data) {

                                                        //找出有重複的公車編號
                                                        var filterVehicles = $.grep(data.Vehicles,function(vehicles) {
                                                            return value.UniBusId === vehicles.UniBusId;
                                                        });

                                                        //若相同公車編號找尋結果，有2筆以上，則回傳該項目
                                                        if (filterVehicles && filterVehicles.length > 0) {
                                                            return data;
                                                        }
                                                    });

                                                    if (getVehicles && getVehicles.length > 0) {
                                                        return value;
                                                    }
                                                });

                                                if (busIdDuplicate && busIdDuplicate.length > 0) {
                                                    return item;
                                                }


                                            }


                                        }

                                    }
                                });

                                hasSeq = jsonObjArr[0].UniRouteId[9] =='0' ?hasSeq:false;
                                //返程
                                $('#BackDirectionRoute li').map(function(index, item) {

                                    var _UniStopId = $(item).find('input#item_UniStopId').val();

                                  if ($('.stationlist-come-go-c').length === 0)
                                    { var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.BackDirStops.length;
                                    }
                                    else
                                    {
                                        var _StopSeq =parseInt($(item).find('.auto-list-stationlist-number').text().trim()) +objArr.GoDirStops.length;
                                    }

                                    var tmp = jsonObjArr.filter(function(item) {
                                        if (hasSeq) {
                                            if (item.UniStationId == _UniStopId &&
                                                item.StopSequence == (_StopSeq - 1))
                                                return true;
                                        } else {
                                            if (item.UniStationId == _UniStopId)
                                                return true;
                                        }
                                    });

                                    if (tmp && tmp.length > 0) {

                                        var value = tmp[0];

                                        //依據有重複的站位及公車編號，取得下一站位的等待時間
                                        var  filterBusId = filterDuplicate.filter(function(item) {
                                            if (item.UniStationId === value.UniStationId) {
                                                return true;
                                            }
                                            return false;
                                        }).map(function(dirItem) {

                                            var nextStation = jsonObjArr.filter(function (station) {
                                                if ( station.StopSequence ===( parseInt(dirItem.StopSequence) +1)) {

                                                    return true;
                                                }
                                                return false;
                                            });

                                            if (nextStation && nextStation.length > 0 ) {
                                                dirItem.NextETA = nextStation[0].ETA;
                                            }

                                            return dirItem;

                                        });

                                        //若公車站編號相同超過1個以上，表示有重複
                                        if (filterBusId && filterBusId.length > 1) {

                                            //車號編號
                                            var busArray= [];
                                            //重複車號編號
                                            var tempbusArray= [];

                                            //取得重複車號
                                            $.each(filterBusId , function(index, item) {
                                                $.each(item.Vehicles , function(iVehicles, vehicles) {

                                                    if (($.inArray(vehicles.UniBusId, busArray) !== -1)) {
                                                        //未重複
                                                        busArray.push(vehicles.UniBusId);
                                                    } else {
                                                        //有重複
                                                        tempbusArray.push(vehicles.UniBusId);
                                                    }
                                                });
                                            });

                                            //過濾收集重複車號項目
                                            var duplicateBus = unique(tempbusArray);

                                            if (duplicateBus.length > 0 ) {

                                                //依進站時間排序
                                                filterBusId.sort(function (a, b) {
                                                    if (a.NextETA> b.NextETA) {
                                                        return 1;
                                                    }
                                                    if (a.ETA< b.ETA) {
                                                        return -1;
                                                    }
                                                    // a must be equal to b
                                                    return 0;
                                                });

                                                for (var i = 0; i < filterBusId.length; i++) {

                                                    if (i !==0) {
                                                        filterBusId[i].Vehicles =  $.grep(filterBusId[i].Vehicles, function(iVehicles, vehicles) {

                                                            if (($.inArray(vehicles.UniBusId, duplicateBus) === -1)) {
                                                                //未重複
                                                                return vehicles;
                                                            }

                                                        });
                                                    }
                                                }

                                            }
                                        }


                                        if (value.Vehicles.length > 0) {
                                            var _html = "<span class='auto-list-stationlist-bus'>";
                                            for (var i = 0; i < value.Vehicles.length; i++) {
                                                var dogimg=""
                                                if($('#doglink').attr('dognum')!=null)
                                                { if (value.Vehicles[i].BusLicence.indexOf($('#doglink').attr('dognum')) > -1) {
                                                    value.Vehicles[i].BusLicence=value.Vehicles[i].BusLicence.replace($('#doglink').attr('dognum'), '');
                                                    dogimg="<img src='" +
                                                        SitePath +
                                                        "images/stationlist_dogwhite_bus.png' class='bus-number-img' alt=''>";
                                                }
                                                }
                                                if (value.Vehicles[i].BusType == 2) {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'><img src='" +
                                                        SitePath +
                                                        "images/stationlist_accessibility_bus.svg' class='bus-number-img' alt='" +
                                                        i18n._('Accessibility Bus') +
                                                       "'>" +
                                                                                                               value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                } else {
                                                    _html =
                                                        _html +
                                                        "<p class='bus-number'>" +
                                                                                                                value.Vehicles[i].BusLicence +setSeatImg(value.Vehicles[i].bSetL)+
                                                        "</p>";
                                                }
                                            }
                                            $(item)
                                                .find('span.auto-list-stationlist')
                                                .append(_html.concat("</span>"));
                                        }

                                        //轉為時間
                                        if(value.NextDepTime!='FF')
                                        {
                                            $(item).find('span.auto-list-stationlist-position').addClass('auto-list-stationlist-position-now').html('預計'+value.NextDepTime+'發車');
                                        }
                                        else{
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), value.ETA);
                                        }
                                    }else{
                                        //if( jsonObjArr[0].UniRouteId[9] !='0')
                                        //    FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        if (jsonObjArr[0].UniRouteId[9] =='0')
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65535);
                                        }else
                                        {
                                            FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                        }
                                    }

                                    return item;
                                });
                            }

                        }
                        else{
                            //去程
                            $('#GoDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });

                            //返程
                            $('#BackDirectionRoute li').map(function(index, item) {
                                FormatETA($(item).find('span.auto-list-stationlist-position'), 65529);
                                return item;
                            });
                        }

                    }

                });
                if (stopFetchInterval === null) {
                    stopFetchInterval = window.setInterval(startFatch, 1000 * 15);
                }
            })();

        }

        function setSeatImg(lv)
        {
            var s = '';
            if (lv>-1)
            {
                //s = '<img src=\"../images/seats/seat'+lv+'.png\" class="bus-number-img" >';
                s = '&ensp;<img width="20px" src=\"../images/seats/people'+lv+'_B.svg\" class="bus-number-img" >';
            }
            return s;
        }

        function stopStationStatusReport() {
            clearInterval(stopFetchInterval);
            stopFetchInterval = null;
        }

        function shownewchart(_id) {

            AptsBusMap.init({
                AptsSpringWebHome: SitePath,
                uniRouteId: _id,
                goBack: 0
            });
            AptsBusMap.load('myMap');

            $('.route-list').hide();
            $('.route-chart').show();

        }

        function hidenewchart() {
            $('.route-list').show();
            $('.route-chart').hide();
            //clearInterval(AptsBusMap.......interval);//沒有停止方法
        }

        function toggleRouteListAndChart() {
            if ($('.route-chart').is(":visible")) {
                $('.route-list').toggle();
                $('.route-chart').toggle();
                google.maps.event.trigger(map, "resize");
                $('.route-chart').html('');
                busStatusReport();
                stationStatusReport();
            } else {
                stopBusStatusReport();
                stopStationStatusReport();
                $('.route-chart')
                    .html('<button onclick="toggleRouteListAndChart()">back</button><div id="myMap" class="left" style="width:900px;margin-top:30px;"></div>');
                shownewchart('0454012600');

            }
        }

        function FormatETA(elem, eta) {
            if (eta < 0) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            if (eta >= 0 && eta <= 180) {
                elem.addClass('auto-list-stationlist-position-now').html(ConvertETA(eta));
                return;
            }
            if ( eta === 65535 ||
                 eta === 65529 ||
                 eta === 65534 ||
                eta === 65532 ||
                eta === 65533 ||
                eta === 65531 ||
                eta === 65530
               ) {
                elem.addClass('auto-list-stationlist-position-none').html(ConvertETA(eta));
                return;
            }
            elem.addClass('auto-list-stationlist-position-time').html(ConvertETA(eta) + i18n._('Mins'));
        }


        function addToMyBus(routeid, stopid, groupid) {
            $.ajax({
                url: '/MyBus/NewContentOfGroup',
                type: 'post',
                dataType: 'html',
                data: {
                    '__RequestVerificationToken': $('input[name=__RequestVerificationToken]').val(),
                    'X-Requested-With': 'XMLHttpRequest',
                    'unirouteid': routeid,
                    'unistationid': stopid,
                    'groupid': groupid
                },
                beforeSend: function() {
                    $('#ProcessIconSpan').show();
                },
                error: function(response) {
                    toastr["warning"](i18n._('Added Failure'), "");
                },
                success: function(response) {
                    toastr["info"](i18n._('Added Success'), "");
                },
                complete: function() {
                    $('#ProcessIconSpan').hide();
                }
            });
        }

        var routeJsonString = JSON.stringify({"UniRouteId":"0454012600","Name":"F126","BeginStop":"八里分駐所","GoDirStops":[{"UniStopId":"2494200000","Name":"八里分駐所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3977429,"Latitude":25.145911,"PublicId":"2494200000"},{"UniStopId":"2494300000","Name":"八里","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.398251,"Latitude":25.146813,"PublicId":"2494300000"},{"UniStopId":"2494700520","Name":"下庄市場","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.399874,"Latitude":25.146794,"PublicId":"2494700520"},{"UniStopId":"2494200540","Name":"廖添丁廟","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.396419,"Latitude":25.143191,"PublicId":"2494200540"},{"UniStopId":"2494200220","Name":"中華路三段88巷口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.39295,"Latitude":25.138517,"PublicId":"2494200220"},{"UniStopId":"2494200640","Name":"樂山療養院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.39215,"Latitude":25.12882,"PublicId":"2494200640"},{"UniStopId":"2524502320","Name":"楓林坑口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.390733,"Latitude":25.127284,"PublicId":"2524502320"},{"UniStopId":"2494100720","Name":"長坑國小","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3907228,"Latitude":25.125668,"PublicId":"2494100720"},{"UniStopId":"2445000460","Name":"林口加油站2","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.396665,"Latitude":25.077883,"PublicId":"2445000460"},{"UniStopId":"2444902460","Name":"林口區公所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.388861,"Latitude":25.076704,"PublicId":"2444902460"},{"UniStopId":"2444902360","Name":"林口高中","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.380874,"Latitude":25.07399,"PublicId":"2444902360"},{"UniStopId":"2444701060","Name":"崇林國中","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3697419,"Latitude":25.068593,"PublicId":"2444701060"},{"UniStopId":"3337500340","Name":"長庚醫院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3678435,"Latitude":25.059661,"PublicId":"3337500340"}],"LastStop":"長庚醫院","BackDirStops":[{"UniStopId":"3337500340","Name":"長庚醫院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3678435,"Latitude":25.059661,"PublicId":"3337500340"},{"UniStopId":"2444903620","Name":"崇林國中","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3697713,"Latitude":25.068202,"PublicId":"2444903620"},{"UniStopId":"2444902320","Name":"林口高中","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.38103,"Latitude":25.073847,"PublicId":"2444902320"},{"UniStopId":"2444902420","Name":"林口區公所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.388861,"Latitude":25.07654,"PublicId":"2444902420"},{"UniStopId":"2445000420","Name":"林口加油站2","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.396844,"Latitude":25.077807,"PublicId":"2445000420"},{"UniStopId":"2494200620","Name":"樂山療養院","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.392253,"Latitude":25.128764,"PublicId":"2494200620"},{"UniStopId":"2494200200","Name":"中華路三段99巷口","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.39325,"Latitude":25.138831,"PublicId":"2494200200"},{"UniStopId":"2494200000","Name":"八里分駐所","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.3977429,"Latitude":25.145911,"PublicId":"2494200000"},{"UniStopId":"2494300000","Name":"八里","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.398251,"Latitude":25.146813,"PublicId":"2494300000"},{"UniStopId":"2494700520","Name":"下庄市場","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.399874,"Latitude":25.146794,"PublicId":"2494700520"},{"UniStopId":"2494200540","Name":"廖添丁廟","Name_TW":null,"Name_EN":null,"StopOrder":0,"RoutesNumber":null,"BusETA":0,"BType":0,"BLicense":null,"Longitude":121.396419,"Latitude":25.143191,"PublicId":"2494200540"}],"RouteMapUrl":"../MapOverview?nid=0454012600","RouteTracks":null,"StopDirection":null,"TicketPrice":"","BusTimeDesc":"0630 - 1710","HeadwayDesc":"F126八里分駐所班表:0630 1500 1710;F126長庚醫院班表:0700 1530 1800","HolidayBusTimeDesc":"0630 - 1710","HolidayHeadwayDesc":"F126八里分駐所班表:0630 1500 1710;F126長庚醫院班表:0700 1530 1800","RouteNote":"","SegmentBuffer":"","StopLng":0,"StopLat":0,"IsNtpcMainLine":false,"orgphone":"八里區公所八里區公所站:(02)2610-2621","aliasName":null,"aliasEname":null,"memo":null,"memoEn":null,"showBusTimeDesc":true,"RouteStatus":1,"wkt":"LINESTRING (121.396677714882 25.1434287425236, 121.39696527393 25.1437377703289, 121.397494186887 25.1440512260773, 121.399208669382 25.1450895117401, 121.40057688512 25.1459368643949, 121.399538628441 25.1473589470931, 121.398257387085 25.1468762281455, 121.39757626896 25.1464623972322, 121.397760545931 25.1457508606575, 121.397590945887 25.1452130228592, 121.397325674023 25.1443951899363, 121.397127807306 25.143942476215, 121.396979407267 25.1435689861309, 121.396049868566 25.142498701893, 121.395625868456 25.1420120270141, 121.395181755521 25.1415194451055, 121.39476590926 25.1410150509818, 121.394441929689 25.1406208839769, 121.394236996303 25.1403684392716, 121.39396737572 25.140049561003, 121.393649375638 25.1396002758563, 121.393436288403 25.1392553142875, 121.393147098585 25.1386879217413, 121.392979129311 25.1383267181745, 121.392866062615 25.1379724030109, 121.392752995919 25.1375491918846, 121.392691570262 25.1371623953165, 121.39251327278 25.1360571149097, 121.392352370175 25.1350915857265, 121.392304534265 25.1348602906501, 121.392063180356 25.1341752609602, 121.391967508537 25.1337943591686, 121.391941416222 25.1333293030449, 121.391967508537 25.1326511545393, 121.392130585502 25.1314474070615, 121.392230606041 25.1307101919962, 121.392324103501 25.1300541751159, 121.392352370175 25.129768243175, 121.392334975299 25.1295024882753, 121.392298011186 25.129202282971, 121.392224082962 25.1286427179999, 121.392165375255 25.1283986149756, 121.392088729081 25.1282524482134, 121.391916954678 25.128124490635, 121.39115538525 25.1277834338192, 121.391022749319 25.1276633500961, 121.390820533882 25.1273557580537, 121.390842277477 25.1263709661619, 121.39087489287 25.1251879504135, 121.390807487724 25.1249325208606, 121.390789005668 25.1247255683938, 121.390903159544 25.1243094476878, 121.391080369846 25.1238453397762, 121.391185826284 25.1235222349772, 121.391281498103 25.1232047892168, 121.391346728889 25.122812779477, 121.39134564171 25.122625510099, 121.391243446811 25.1224146163823, 121.391067051894 25.1222935430455, 121.390623210754 25.122292558709, 121.390444641477 25.122308308093, 121.390292436309 25.1223486658804, 121.389935569551 25.1224746608381, 121.389798313105 25.1225664500517, 121.38958848741 25.1226304317683, 121.389324846316 25.1226498723602, 121.389144374474 25.1226075460043, 121.389047615475 25.1225258462526, 121.389004128284 25.122318151457, 121.388988907768 25.1218904565599, 121.388935635959 25.121652984351, 121.388816861569 25.1214251090306, 121.388621169211 25.1212016628394, 121.388505656361 25.1210978143604, 121.388187112689 25.1209413032157, 121.388113184464 25.1208674771345, 121.38808926651 25.1207523083588, 121.388111010105 25.1205460870747, 121.388263487067 25.1199547369997, 121.388245005011 25.119614149556998, 121.388293928101 25.119592493676, 121.388336328112 25.1196102121244, 121.388398297359 25.1199370186012, 121.388448307628 25.1200039547597, 121.388512451234 25.1200423445988, 121.388605948694 25.1200403758894, 121.388657046143 25.1199852520132, 121.388675528199 25.1199232376228, 121.388682051278 25.1197460534769, 121.388663569222 25.1196306375548, 121.388605948694 25.1194413945809, 121.388502394821 25.1192806977814, 121.388424117878 25.1192196673948, 121.38827626143 25.1191930896363, 121.388151235756 25.1192098237812, 121.388033820341 25.1192472295086, 121.387932712623 25.1192413233419, 121.387881615174 25.1191674962337, 121.387903358769 25.1190729974701, 121.388069697274 25.1189556121855, 121.388138189599 25.1188808005406, 121.388220815261 25.1187427434047, 121.388380630687 25.1183613013094, 121.388383892227 25.1182795987187, 121.388362148631 25.1182018335515, 121.388282784508 25.1181267753527, 121.38801724085 25.1179102137338, 121.387958533142 25.1177950421711, 121.387987886996 25.1174401752633, 121.388025938288 25.1169698888903, 121.38806181522 25.116460471468, 121.388060456246 25.116078037863, 121.387868025427 25.1156751769732, 121.38780388182 25.1155784606304, 121.387724245902 25.1154955256902, 121.38745462532 25.1154571344229, 121.387262194501 25.1155132447326, 121.387076286761 25.1155043852117, 121.387043671368 25.1154561500313, 121.387353517602 25.1153655859675, 121.38764107665 25.1153498356887, 121.38792156903 25.1154866661681, 121.388025938288 25.1155004476467, 121.388102040872 25.1154581188145, 121.388133569085 25.1153892113819, 121.388135743445 25.1153111982774, 121.388074589583 25.1150264623284, 121.38803979983 25.1149152256323, 121.387983266482 25.1148116179105, 121.38787536389 25.1147683044426, 121.38764270742 25.1147751952227, 121.387366291964 25.1147555072787, 121.387028994441 25.1146285199643, 121.386661255884 25.1144924268238, 121.386497091739 25.1143004687913, 121.386428599414 25.114109987061, 121.38640141992 25.1139542052703, 121.386550363548 25.1136150777154, 121.386530794312 25.1135195902515, 121.386418814796 25.1134241027131, 121.386213066025 25.1133549480317, 121.386107609587 25.1132594603646, 121.385812712075 25.1128880913833, 121.385755091548 25.1127707001584, 121.385547983802 25.1124052361896, 121.385419696589 25.1119893196366, 121.385206609355 25.1113829156887, 121.385108763176 25.1110240924556, 121.384963081087 25.1102119372154, 121.384810875919 25.1093982999195, 121.384771737447 25.1089818809146, 121.384836968234 25.1080752048421, 121.384904373379 25.1077227708515, 121.38499569648 25.1068987801555, 121.38499352212 25.1062898897952, 121.385008742637 25.1056091300466, 121.38494786057 25.1050282908222, 121.384895132351 25.1042421845292, 121.384788588734 25.1035973471661, 121.384701614352 25.1028703012673, 121.384610291252 25.1023677165724, 121.384462434804 25.1017878464541, 121.384248803979 25.100908683289, 121.384100947531 25.1002795805718, 121.384063983419 25.1001909742953, 121.383848721825 25.0995825427965, 121.383744352567 25.0993418275573, 121.383603019197 25.0990676380472, 121.383418198636 25.0987540668846, 121.38321380884 25.0984306496315, 121.3829311421 25.0978335315125, 121.382671849726 25.0973171425943, 121.382517470199 25.096912989213, 121.382441367615 25.0965127726731, 121.382441367615 25.0962961727696, 121.382479962497 25.0960357601052, 121.382813183095 25.0946160336757, 121.38311813702 25.093279486978, 121.383370362727 25.0922033470559, 121.383599214068 25.0911719963912, 121.384647255364 25.0905694275884, 121.385890445429 25.0897664902014, 121.387248332959 25.0889345016982, 121.387370097093 25.0888360411459, 121.387459245834 25.0886903193833, 121.387470117632 25.0885505050965, 121.387424456081 25.0883924753759, 121.386878148248 25.0874388773724, 121.386264435269 25.0863503782623, 121.385714322306 25.085392333496, 121.38574476334 25.0852480845851, 121.386615050744 25.0840753789392, 121.386943922624 25.0836357345063, 121.387609820232 25.082730839875, 121.388450210193 25.0815970043525, 121.389171010379 25.0806059358697, 121.390207092698 25.079241665038, 121.390625113318 25.0788276050948, 121.391893308518 25.0786675934456, 121.39258529844 25.0786301753066, 121.394202478345 25.0785907877796, 121.395823463379 25.0783721867744, 121.396252355798 25.078299319686, 121.396826930305 25.0781949424296, 121.396820407226 25.077962555011, 121.396674181547 25.0774613450516, 121.396441525077 25.0765642824184, 121.396227894253 25.0757661767135, 121.394654745128 25.0758488924138, 121.394193237317 25.0758744948811, 121.393207165267 25.0760502655218, 121.391879718771 25.0762865953974, 121.390793626182 25.0764776283802, 121.390075543946 25.0765603435998, 121.389141656525 25.0765859459184, 121.387790292073 25.0766430587636, 121.386909132871 25.076654875211, 121.386641143059 25.0766450281716, 121.386428055824 25.076591854145, 121.386156260882 25.0764638425048, 121.385690404351 25.0761364275085, 121.385268578602 25.0758843419825, 121.384249891159 25.0752531411818, 121.383594865349 25.0749178452054, 121.382565306108 25.074423023475, 121.381644464845 25.0740857557766, 121.380443674791 25.0737548878764, 121.38012132599 25.0736918653179, 121.379796802829 25.0736583845704, 121.379327141169 25.0737017125948, 121.379026535964 25.0737568573308, 121.37880910001 25.0738297271225, 121.378598187135 25.0739242608418, 121.378345417839 25.0740581834857, 121.377844771556 25.0743949588991, 121.377694740748 25.0744107144513, 121.376347725015 25.0733737978478, 121.37552962224 25.0727450459448, 121.374289150125 25.0718381013347, 121.373477026838 25.0712383916007, 121.372338749621 25.0703531004358, 121.371361918599 25.0696750950332, 121.37065470816 25.0690812832969, 121.369888790014 25.0684978087619, 121.369427282202 25.0678769100228, 121.368961425672 25.0671550681985, 121.368700502527 25.0665420409353, 121.368633097382 25.0662973215646, 121.368691805089 25.0648994081815, 121.368814112813 25.0643710626893, 121.369246810361 25.0630578212927, 121.369688748936 25.0620956549945, 121.369884441295 25.0617780498238, 121.370382369628 25.0611334811404, 121.370260061904 25.0609222352039, 121.368713005095 25.0599108102194, 121.367526891968 25.0591219520266, 121.366096163393 25.0582060428851, 121.366022235169 25.0583124068786, 121.367124635454 25.0590554749806, 121.367316522683 25.0591977850573, 121.368300420373 25.0598581213473, 121.368911958992 25.0602427003507, 121.370154061877 25.0610763610629, 121.369664287392 25.0618007007624, 121.369115805199 25.0627589301145, 121.368778779471 25.0638766907523, 121.368537425562 25.0648053598962, 121.368437405023 25.0657931094889, 121.368430881945 25.0661520653689, 121.368456974259 25.0664534102337, 121.368520030686 25.0666291943959, 121.36882715897 25.0673274046277, 121.369431630921 25.0682658953267, 121.369991528502 25.068773051526, 121.371227651898 25.069788342384, 121.372987795942 25.0710892022698, 121.374173909069 25.0719429763806, 121.375401335027 25.0728341644609, 121.377664843304 25.0745869795535, 121.378598187135 25.0739661116837, 121.378909664139 25.0738499140166, 121.379311920653 25.073747502422, 121.379584259185 25.07372189951, 121.37988921311 25.073719930055, 121.380370290157 25.073784922053, 121.381610762272 25.0741216982179, 121.382522906097 25.0744673359503, 121.384006906481 25.075180764595, 121.384264024496 25.0753191170808, 121.385303911944 25.0759577028629, 121.38607254804 25.0764761513222, 121.386372609656 25.0766238570341, 121.386603091767 25.0766927863054, 121.386862384141 25.0767144497826, 121.388524682007 25.0766612757862, 121.39005488753 25.0766100711752, 121.390553359454 25.076554927724, 121.391104016006 25.0764761513222, 121.392736416428 25.0761822164253, 121.394192150137 25.0759163450565, 121.395776171059 25.0758415070856, 121.396181145523 25.0758021186616, 121.396605145632 25.0774086637284, 121.396753002081 25.077962555011, 121.396763873878 25.0780812105066, 121.39539565814 25.0783293527479, 121.394136703969 25.0784652399527, 121.391812857215 25.0785518925843, 121.390683821026 25.0787035345419, 121.390176651664 25.0791884921391, 121.389802118234 25.0796995418226, 121.389221020648 25.0804705433776, 121.388446405063 25.0814975532326, 121.387627758698 25.0826195738056, 121.386781389249 25.08375536915, 121.385686599222 25.0852397151892, 121.385588753043 25.0855193511676, 121.387272794504 25.088519982238, 121.387279317582 25.0886322275511, 121.387177122684 25.0887523496143, 121.385830106952 25.0895823701561, 121.383752652666 25.0908731427402, 121.383533983282 25.0910169238211, 121.383528547383 25.0912591323205, 121.383348890926 25.0920655059428, 121.383171680624 25.0928383987492, 121.38295750621 25.0937638945398, 121.382839819 25.0942854674076, 121.382410382991 25.096040682845, 121.382374506059 25.0964930817885, 121.382450608643 25.0969004363155, 121.382538670204 25.0971487865367, 121.382716967686 25.097516019042, 121.382953972875 25.0980107474166, 121.383162711391 25.0984365568035, 121.383519849945 25.0990457323955, 121.383745167952 25.0994818756426, 121.384025932127 25.1002633360925, 121.384540711747 25.1023487650032, 121.384635296387 25.1028575028579, 121.384677696398 25.1032193035279, 121.384722270768 25.1035562448219, 121.384822291307 25.1042402155652, 121.384943240056 25.1056238971094, 121.384930193899 25.106080198476, 121.384943240056 25.1067166548198, 121.384913886202 25.1071210219205, 121.384870127217 25.1075034835472, 121.384806476762 25.1079252432549, 121.384707050251 25.1089688370338, 121.384720096409 25.1091689250873, 121.384750537442 25.1093827949818, 121.384799460532 25.1096451481043, 121.38496933237 25.1105705167244, 121.385044347774 25.111031721767, 121.385134583695 25.1113767630357, 121.385304455534 25.1118606067123, 121.385487101735 25.1124133576228, 121.385742860775 25.112894490063, 121.386054337779 25.1132966218108, 121.386171753194 25.1134029379391, 121.386391363507 25.1134819366691, 121.386458768653 25.1135410011067, 121.38646964045 25.1136158160201, 121.386426153259 25.1137174559441, 121.38632939426 25.1139450995353, 121.386342440417 25.1140947288216, 121.386427512234 25.1143233561108, 121.386619127668 25.1145482914765, 121.387355691961 25.1148153093984, 121.387869927991 25.114836966126, 121.387946030575 25.1148763419844, 121.387991692125 25.1149718283884, 121.38806562035 25.1153473747073, 121.388047138294 25.1154221885151, 121.387946030575 25.1154320324337, 121.387653307423 25.1152873267495, 121.387341286829 25.115306030215, 121.387026004696 25.1153916723622, 121.386967296989 25.1154408919599, 121.386969471349 25.1155058617984, 121.38705753291 25.1155678784303, 121.387256486807 25.1155826442904, 121.387464409938 25.1155196432749, 121.387700599743 25.1155592650111, 121.387787574124 25.1156823137994, 121.38799413828 25.1161100304239, 121.387998486999 25.1164393072199, 121.38794630237 25.1171918662525, 121.387891943382 25.1178051319916, 121.387952825449 25.1179394987932, 121.388309420413 25.1182426848795, 121.388315943491 25.118339153022, 121.388161020374 25.1187432355872, 121.388032733162 25.1189145150045, 121.38785226132 25.11904297441, 121.387830517725 25.1191965349015, 121.387893574151 25.119293002291, 121.388033276751 25.1193146582251, 121.388292025536 25.1192555965776, 121.388422487108 25.1192811899617, 121.388533379445 25.1194465624683, 121.388609482029 25.1197202141007, 121.388611656388 25.1199623657536, 121.388552948681 25.1199918964102, 121.388468148659 25.1199466160672, 121.388398569154 25.1195922475863, 121.388337687086 25.11952727992, 121.388211574233 25.1195651777295, 121.388183307559 25.1196281766596, 121.388189806755 25.1199155394394, 121.388046322909 25.1205126191484, 121.388024579313 25.1207395118214, 121.38804197419 25.120893070181, 121.388149061397 25.120993965793, 121.388429553777 25.1211219308395, 121.388583933304 25.1212420209921, 121.388771471814 25.1214708809972, 121.388869317993 25.1216854676233, 121.388919328262 25.1219123581185, 121.388938897498 25.1223124915227, 121.388993256487 25.1225566067076, 121.38911719498 25.1226629147808, 121.389323759136 25.1227081941172, 121.38958468228 25.122680632784, 121.389817882341 25.1226176354276, 121.38995921571 25.122523139332, 121.390446272247 25.1223558023169, 121.39104095958 25.1223558023169, 121.391197513466 25.1224562045535, 121.391282313488 25.12264125944, 121.391282313488 25.12281302556, 121.391217082702 25.1231929772656, 121.391042590349 25.1237451847622, 121.390846897991 25.1242850857574, 121.390731656936 25.1247329507707, 121.390738180014 25.1249022531613, 121.390809933879 25.125203453346, 121.390772969767 25.126882679981, 121.39075829284 25.1273620329391, 121.390986600591 25.1277203160572, 121.39113500063 25.1278369547028, 121.391645975121 25.1280731845297, 121.392015616242 25.1282582309084, 121.392098241904 25.1283979997959, 121.392146077814 25.1286037156844, 121.392265667588 25.1294014766548, 121.392283062465 25.1297740257983, 121.392222180398 25.1303453968477, 121.392102590623 25.1312558447629, 121.391967780332 25.1322351838629, 121.391913421343 25.1326628425442, 121.391874282872 25.1337962046258, 121.391926467501 25.134099843484, 121.392205329111 25.1349093793758, 121.392355359919 25.1357686134242, 121.392596713828 25.1372838229969, 121.392703257445 25.1377946299111, 121.392803277984 25.1381568192607, 121.393040826763 25.1387188011519, 121.393332190941 25.1393019407476, 121.393734991045 25.1399126350093, 121.394048098818 25.1403309169877, 121.394638437432 25.1410621688625, 121.395765842851 25.1423701441319, 121.396353463516 25.1430369207142, 121.396960653416 25.1437278056705, 121.398278315295 25.1445082450845, 121.400583679993 25.1459298523543, 121.400183054249 25.1464814649774, 121.399538356646 25.1473573478744, 121.39825711529 25.1468731527128, 121.397559145879 25.1464573535054, 121.39764829462 25.1461970477186, 121.397752120287 25.1457536900815, 121.397325945818 25.1443785822614, 121.39712916628 25.1439371863436, 121.396974786753 25.1435659106149, 121.396868243136 25.1434544538636, 121.396533391767 25.1430922802298)","wkt0":"LINESTRING (121.397732900336 25.1457377830666, 121.397630032529 25.1461913090737, 121.397536846398 25.146459975581, 121.39825711529 25.1468731527128, 121.399538356646 25.1473573478744, 121.400183054249 25.1464814649774, 121.400583679993 25.1459298523543, 121.398278315295 25.1445082450845, 121.396960653416 25.1437278056705, 121.396353463516 25.1430369207142, 121.395765842851 25.1423701441319, 121.394638437432 25.1410621688625, 121.394048098818 25.1403309169877, 121.393734991045 25.1399126350093, 121.393332190941 25.1393019407476, 121.393040826763 25.1387188011519, 121.392803277984 25.1381568192607, 121.392703257445 25.1377946299111, 121.392596713828 25.1372838229969, 121.392355359919 25.1357686134242, 121.392205329111 25.1349093793758, 121.391926467501 25.134099843484, 121.391874282872 25.1337962046258, 121.391913421343 25.1326628425442, 121.391967780332 25.1322351838629, 121.392102590623 25.1312558447629, 121.392222180398 25.1303453968477, 121.392283062465 25.1297740257983, 121.392265667588 25.1294014766548, 121.392146077814 25.1286037156844, 121.392098241904 25.1283979997959, 121.392015616242 25.1282582309084, 121.391645975121 25.1280731845297, 121.39113500063 25.1278369547028, 121.390986600591 25.1277203160572, 121.39075829284 25.1273620329391, 121.390772969767 25.126882679981, 121.390809933879 25.125203453346, 121.390731838424 25.1248217324153, 121.390867381888 25.1247515402648, 121.391087640015 25.12471523398, 121.391349045265 25.1246892144759, 121.391656438476 25.1247061574088, 121.392179248977 25.1247037369898, 121.392288167831 25.1246686409146, 121.392462437998 25.1245948181356, 121.392802506865 25.1244846890718, 121.392895692996 25.1243191929237, 121.392950152423 25.1241061960531, 121.393038497716 25.1239857802087, 121.393218818931 25.1238841226113, 121.393360413441 25.1238671796784, 121.393337419461 25.1236750589216, 121.393249074168 25.1233788601484, 121.393199455579 25.1231561816019, 121.393210347464 25.1230185202721, 121.393374935955 25.1225350415801, 121.393183722855 25.1219244908913, 121.393113530705 25.121136644512, 121.393160728875 25.1207384855891, 121.393216398512 25.1206126238019, 121.393731947755 25.1202090189363, 121.393944944626 25.1198199365846, 121.394191827362 25.1193140690169, 121.39422087239 25.1192051501626, 121.394286223703 25.118846928153, 121.394332211663 25.1186242496064, 121.394441130518 25.1184306160877, 121.39453068602 25.1183555830992, 121.394566992305 25.118194020132, 121.394591196495 25.1177565294006, 121.394707376606 25.117355344954, 121.394857442583 25.1161269823196, 121.395043814845 25.1155999360858, 121.395438343139 25.1152979888175, 121.395692487132 25.1151334003266, 121.395830451014 25.1149500535885, 121.395956312802 25.1146596033105, 121.395791724311 25.1139346878247, 121.395784463054 25.1138045903043, 121.395820769338 25.1137198756399, 121.396014402857 25.1134826745794, 121.396237081404 25.1132309510051, 121.396203195538 25.112740211056, 121.396224979309 25.1125732021461, 121.396370204448 25.1122978794867, 121.396382306543 25.1119154532872, 121.396401669895 25.1116933798454, 121.396464600788 25.1115336321925, 121.396525111263 25.1114440766901, 121.396692120173 25.111306112808, 121.396815561541 25.1111027976133, 121.39696078668 25.1108680169718, 121.397026137993 25.1105926943124, 121.397178624389 25.1103004287201, 121.397519903465 25.1098000070951, 121.397495699276 25.1096487309086, 121.397570732264 25.1090393904293, 121.39762882232 25.1087707239221, 121.397776467878 25.1084010049223, 121.397800672068 25.1082630410402, 121.397718377822 25.1079701703431, 121.39769901447 25.1077505173203, 121.397730479917 25.1075593042205, 121.397805512906 25.1073680911208, 121.397856341704 25.1073130265889, 121.398003987262 25.1072089485726, 121.398076599832 25.1071000297183, 121.398037873128 25.1069596454172, 121.397907170503 25.1068047386022, 121.397807933324 25.1065996080933, 121.397740161593 25.105044488896, 121.397524744303 25.1046626678013, 121.397515062627 25.104556169366, 121.397551368912 25.1044666138636, 121.397965260558 25.1039589309816, 121.398100804022 25.1034663757184, 121.3982000412 25.1030434075009, 121.398347686758 25.1024848958203, 121.398720431282 25.1016716350417, 121.39867686374 25.1009975483546, 121.398742215052 25.1007682136558, 121.398916485219 25.1005237513384, 121.39908107371 25.0997982307479, 121.399194833402 25.0996342473618, 121.399710382646 25.0991241440609, 121.399782995216 25.0986987554244, 121.399831403595 25.0985559507043, 121.400003253343 25.0983986234704, 121.400196886862 25.0980597648126, 121.400221091052 25.0977826268389, 121.400044400466 25.0969021994334, 121.400252556498 25.0965106966628, 121.400305805716 25.096314642725, 121.400085547589 25.095285359552, 121.40005892298 25.0945477368666, 121.399887073232 25.0940836215264, 121.399862869042 25.093648551214, 121.39972490516 25.0932225574728, 121.399693439713 25.0928988264337, 121.399620827144 25.0925557320427, 121.399405409854 25.091971200858, 121.399257764296 25.0917097956078, 121.399090755386 25.091175488117, 121.399071392034 25.090980039284, 121.399059289939 25.0900027951192, 121.399018142817 25.0897807216774, 121.39901088156 25.0895047939132, 121.399035085749 25.0892966378806, 121.399189992564 25.089078800172, 121.399482863261 25.0888349429594, 121.399497385775 25.0887090811722, 121.39922387843 25.088390190971, 121.399090755386 25.0881796145194, 121.399047187844 25.0874925180803, 121.398940689409 25.0872214311541, 121.398921326057 25.0871100918808, 121.398950371085 25.0869769688367, 121.399027824492 25.0869188787811, 121.399139163766 25.086930980876, 121.399255343877 25.0873279295894, 121.399352160636 25.0875481877169, 121.399444136558 25.0875578693929, 121.399461079491 25.0874392688626, 121.399432034463 25.0873085662375, 121.399347319798 25.0871657615174, 121.399330376865 25.0867191942149, 121.399376364826 25.0864408460317, 121.399412671111 25.0863270863394, 121.400027457533 25.0854829652187, 121.400983523032 25.0848137193696, 121.400492177978 25.0837953280821, 121.400342112001 25.0828283706979, 121.400235613566 25.0825548633527, 121.399654713009 25.0817561250879, 121.399323115609 25.0813761193074, 121.397527164722 25.0799801426583, 121.397258498215 25.0796455197338, 121.397147158942 25.0794107390923, 121.396763873878 25.0780812105066, 121.396753002081 25.077962555011, 121.396605145632 25.0774086637284, 121.396181145523 25.0758021186616, 121.395776171059 25.0758415070856, 121.394192150137 25.0759163450565, 121.392736416428 25.0761822164253, 121.391104016006 25.0764761513222, 121.390553359454 25.076554927724, 121.39005488753 25.0766100711752, 121.388524682007 25.0766612757862, 121.386862384141 25.0767144497826, 121.386603091767 25.0766927863054, 121.386372609656 25.0766238570341, 121.38607254804 25.0764761513222, 121.385303911944 25.0759577028629, 121.384264024496 25.0753191170808, 121.384006906481 25.075180764595, 121.382522906097 25.0744673359503, 121.381610762272 25.0741216982179, 121.380370290157 25.073784922053, 121.37988921311 25.073719930055, 121.379584259185 25.07372189951, 121.379311920653 25.073747502422, 121.378909664139 25.0738499140166, 121.378598187135 25.0739661116837, 121.377664843304 25.0745869795535, 121.375401335027 25.0728341644609, 121.374173909069 25.0719429763806, 121.372987795942 25.0710892022698, 121.371227651898 25.069788342384, 121.369991528502 25.068773051526, 121.369431630921 25.0682658953267, 121.36882715897 25.0673274046277, 121.368520030686 25.0666291943959, 121.368456974259 25.0664534102337, 121.368430881945 25.0661520653689, 121.368437405023 25.0657931094889, 121.368537425562 25.0648053598962, 121.368778779471 25.0638766907523, 121.369115805199 25.0627589301145, 121.369664287392 25.0618007007624, 121.370154061877 25.0610763610629, 121.368911958992 25.0602427003507, 121.368300420373 25.0598581213473, 121.367316522683 25.0591977850573)","wkt1":"LINESTRING (121.368217815608 25.0597839879857, 121.366027445993 25.0583464782412, 121.365703607878 25.0587914369116, 121.36516047781 25.0597361772403, 121.36488253801 25.0602321340391, 121.364642846807 25.0607465776594, 121.36447710289 25.0611188639967, 121.364319008691 25.0615899592079, 121.364048718611 25.0628355884942, 121.363990070763 25.0634029426727, 121.363946722354 25.0643132592648, 121.367406945366 25.0644828280417, 121.368304512426 25.0644656161734, 121.368783894833 25.0645013148633, 121.368691805089 25.0648994081815, 121.368633097382 25.0662973215646, 121.368700502527 25.0665420409353, 121.368961425672 25.0671550681985, 121.369427282202 25.0678769100228, 121.369888790014 25.0684978087619, 121.37065470816 25.0690812832969, 121.371361918599 25.0696750950332, 121.372338749621 25.0703531004358, 121.373477026838 25.0712383916007, 121.374289150125 25.0718381013347, 121.37552962224 25.0727450459448, 121.376347725015 25.0733737978478, 121.377694740748 25.0744107144513, 121.377844771556 25.0743949588991, 121.378345417839 25.0740581834857, 121.378598187135 25.0739242608418, 121.37880910001 25.0738297271225, 121.379026535964 25.0737568573308, 121.379327141169 25.0737017125948, 121.379796802829 25.0736583845704, 121.38012132599 25.0736918653179, 121.380443674791 25.0737548878764, 121.381644464845 25.0740857557766, 121.382565306108 25.074423023475, 121.383594865349 25.0749178452054, 121.384249891159 25.0752531411818, 121.385268578602 25.0758843419825, 121.385690404351 25.0761364275085, 121.386156260882 25.0764638425048, 121.386428055824 25.076591854145, 121.386641143059 25.0766450281716, 121.386909132871 25.076654875211, 121.387790292073 25.0766430587636, 121.389141656525 25.0765859459184, 121.390075543946 25.0765603435998, 121.390793626182 25.0764776283802, 121.391879718771 25.0762865953974, 121.393207165267 25.0760502655218, 121.394193237317 25.0758744948811, 121.394654745128 25.0758488924138, 121.396227894253 25.0757661767135, 121.396441525077 25.0765642824184, 121.396674181547 25.0774613450516, 121.396820407226 25.077962555011, 121.396826930305 25.0781949424296, 121.397266349548 25.0794201798519, 121.397345396647 25.0795961233949, 121.397608037009 25.0799441856213, 121.39890338947 25.0808691641753, 121.399492417853 25.0813944448978, 121.399742308682 25.0816902340426, 121.399946301196 25.0819649864594, 121.400418033884 25.082596725775, 121.40045628248 25.0827414329644, 121.400611826772 25.0837480085238, 121.400744421906 25.0840514473878, 121.401103958711 25.0847768957644, 121.400055947172 25.0855227433923, 121.399436319912 25.086391624005, 121.399375122158 25.0867046250181, 121.399408270941 25.0871808200421, 121.399520466824 25.0874281609649, 121.399502617479 25.0875123078768, 121.399433770006 25.0876041045079, 121.399313924404 25.0875735056309, 121.399194078802 25.0872904660182, 121.399107381984 25.0869640779964, 121.39901048554 25.0869742776221, 121.398972236943 25.0871170723816, 121.399086982732 25.0874734218039, 121.399099732265 25.087917105521, 121.399135430954 25.0882071573763, 121.399311374497 25.0884487610096, 121.399512817105 25.0886400039912, 121.399548515794 25.088742000248, 121.399517916917 25.0888643957561, 121.399224677679 25.0890913374275, 121.399069133387 25.0893201915288, 121.399053833949 25.0895088846039, 121.399056383855 25.0897740748716, 121.399099732265 25.090028428037, 121.399104832077 25.0906193688499, 121.399130331142 25.0911586740578, 121.399311374497 25.0917062664616, 121.399451619351 25.0919969557935, 121.39955871542 25.092264058491, 121.399663261583 25.0925317986652, 121.39973720887 25.0928811358447, 121.399747408495 25.0930723788263, 121.399767807747 25.0932610719014, 121.399869804003 25.0934625145086, 121.399915702319 25.0936512075837, 121.39993610157 25.0940866041049, 121.400104395394 25.0945455872606, 121.400129894458 25.0952659358243, 121.400338986785 25.0963120349333, 121.400300738188 25.0965007280084, 121.400208941557 25.0966358730486, 121.400096745675 25.0969265623806, 121.400280338937 25.0977616567332, 121.400247190154 25.0980752952229, 121.400040647734 25.0984271823089, 121.399877453723 25.0985738019281, 121.399829005501 25.0987063970619, 121.399747408495 25.0991347813405, 121.399211928147 25.099671536642, 121.399120131516 25.0998296308401, 121.398941638066 25.1005353174419, 121.398773344243 25.1007954078968, 121.398724896021 25.1010121499425, 121.398750395085 25.1016509015008, 121.398712146489 25.1017834966346, 121.398457155847 25.1023087773572, 121.398406157718 25.1024732463213, 121.398056820539 25.1038017475663, 121.397987973065 25.1039942655011, 121.397597837383 25.1044863974402, 121.397572338319 25.10466106603, 121.397794180177 25.105043551993, 121.397850278119 25.1060488525992, 121.397850278119 25.1065945325732, 121.397962474001 25.1068112746189, 121.398092519228 25.1069591691913, 121.398118018293 25.1070994140444, 121.398061920351 25.1071963104884, 121.397898726341 25.107321255903, 121.397842628399 25.1073875534699, 121.397748281862 25.107658481027, 121.397748281862 25.1078803228856, 121.397786530458 25.1080486167094, 121.397847728212 25.1082500593166, 121.397794180177 25.1084489520173, 121.397620786541 25.1089372590968, 121.397531539816 25.1096741820523, 121.397562138693 25.1097608788706, 121.397539189535 25.1098577753146, 121.397194952169 25.1103275955725, 121.397067456847 25.1106361342494, 121.397006259093 25.1108732755465, 121.396850714802 25.1111053170307, 121.396738518919 25.1113054846847, 121.396514127154 25.1115120271047, 121.396455479307 25.1116701213028, 121.39641723071 25.1118996128806, 121.396427430336 25.1122693493116, 121.39635348305 25.1124325433225, 121.396274435951 25.1125536638774, 121.396254036699 25.1127219577012, 121.396289735389 25.1131477920734, 121.396271886044 25.1132599879559, 121.396098492408 25.1134410313117, 121.395835852046 25.1137597696142, 121.395828202327 25.1139318882976, 121.395993946245 25.1146452246187, 121.395866450924 25.1149512133891, 121.395736405696 25.1151220571193, 121.395068330214 25.1156396881226, 121.394889836765 25.1161464820237, 121.394739392286 25.117316251594, 121.394647595655 25.1176936377442, 121.394611896965 25.1179907018421, 121.394611896965 25.1181940568792, 121.39455834893 25.1183725503286, 121.394466552299 25.1184745465854, 121.394382405387 25.1186141539619, 121.394323757539 25.1189073932002, 121.394252360159 25.1193077285082, 121.394063667084 25.1197195383951, 121.39393872167 25.1198878322189, 121.393747478688 25.1202212324833, 121.393257896656 25.120631767417, 121.393199248808 25.1207662749807, 121.39314060096 25.1211513108501, 121.393227297778 25.1219354070744, 121.393423640573 25.1225441972322, 121.393245147123 25.1230331417883, 121.393250246936 25.123170836735, 121.393377742257 25.1236629686741, 121.393403878798 25.1238711047857, 121.393226660302 25.1238911852987, 121.393050716759 25.1239855318363, 121.392956370221 25.124123226783, 121.392907921999 25.1243195695773, 121.39280082593 25.1244853134946, 121.392701379579 25.1245286619038, 121.39245913847 25.1245975093771, 121.392191398295 25.124709067783, 121.391375428241 25.1246886685317, 121.390875646583 25.1247498662858, 121.390788949764 25.1247906647885, 121.390867996863 25.1251910000965, 121.390801699296 25.1273507708345, 121.391122987505 25.1277791551131, 121.391860547937 25.1280947060326, 121.392088729081 25.1282524482134, 121.392165375255 25.1283986149756, 121.392224082962 25.1286427179999, 121.392298011186 25.129202282971, 121.392334975299 25.1295024882753, 121.392352370175 25.129768243175, 121.392324103501 25.1300541751159, 121.392230606041 25.1307101919962, 121.392130585502 25.1314474070615, 121.391967508537 25.1326511545393, 121.391941416222 25.1333293030449, 121.391967508537 25.1337943591686, 121.392063180356 25.1341752609602, 121.392304534265 25.1348602906501, 121.392352370175 25.1350915857265, 121.39251327278 25.1360571149097, 121.392691570262 25.1371623953165, 121.392752995919 25.1375491918846, 121.392866062615 25.1379724030109, 121.392979129311 25.1383267181745, 121.393147098585 25.1386879217413, 121.393436288403 25.1392553142875, 121.393649375638 25.1396002758563, 121.39396737572 25.140049561003, 121.394236996303 25.1403684392716, 121.394441929689 25.1406208839769, 121.39476590926 25.1410150509818, 121.395181755521 25.1415194451055, 121.395625868456 25.1420120270141, 121.396049868566 25.142498701893, 121.396811990379 25.1434853327312, 121.396979407267 25.1435689861309, 121.398345466713 25.1444342391858, 121.398021914082 25.1449617115417, 121.397722831818 25.145732528103, 121.39757626896 25.1464623972322, 121.398257387085 25.1468762281455, 121.399538628441 25.1473589470931, 121.40057688512 25.1459368643949, 121.399208669382 25.1450895117401, 121.398233990596 25.1445008529627, 121.397494186887 25.1440172394564, 121.39696527393 25.1437377703289, 121.396477745258 25.1431995181516)","CustomRouteInfo":null,"CustomRouteInfoEN":null});
        var objArr = jQuery.parseJSON(routeJsonString);
        var TrackObj=null;
        var layerWkt=null;
        var layerWkt0=null;
        var layerWkt1=null;

        $(function() {
            // Configure toastr options
            toastr.options = {
                "closeButton": true,
                "debug": false,
                "newestOnTop": true,
                "progressBar": true,
                "positionClass": "toast-top-right",
                "preventDuplicates": false,
                "onclick": null,
                "showDuration": "300",
                "hideDuration": "1000",
                "timeOut": "5000",
                "extendedTimeOut": "1000",
                "showEasing": "swing",
                "hideEasing": "linear",
                "showMethod": "fadeIn",
                "hideMethod": "fadeOut"
            }

            // Init Map
            initialize();
            //// 畫去程的站點
            pointRouteStopsLMap(true);
            //// 畫路線軌跡
            //drawRouteTrack();

            //var routePathBounds = new google.maps.LatLngBounds();
            //var path = new google.maps.MVCArray();

            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)) {
                var latlngs = [];
                //for (var i = 0; i < objArr.RouteTracks.length; i++) {
                //    var pointA = [objArr.RouteTracks[i]
                //        .Latitude,
                //        objArr.RouteTracks[i].Longitude];
                //    latlngs.push(pointA);
                //}
                if (TrackObj != null)
                {
                    map.removeLayer(TrackObj);
                }
                var wkt = new Wkt.Wkt();
                if (objArr.wkt0==null)
                {
                    wkt.read(objArr.wkt);}
                else{
                    wkt.read(objArr.wkt0);
                }

                if( map==null)
                {}
                else{
                    //map.defaults.color = '#9863b6';
                    TrackObj= wkt.toObject({
                        color: '#9863b6',
                        strokeColor: '#9863b6',
                        strokeOpacity: 0.8,
                        strokeWeight: 2,
                        fillColor: '#9863b6',
                        fillOpacity: 0.35,
                        editable: false
                    }); // Make an object
                    TrackObj.addTo(map);

                    //var firstpolyline = L.polyline(latlngs ,{ color: '#9863b6',
                    //    weight: 4,
                    //    opacity: 1.0,
                    //    smoothFactor: 1}).addTo(map);
                    //map.fitBounds(firstpolyline.getBounds());
                    //routePath=firstpolyline;

                }
            }

            $('.stationlist-go, .stationlist-come')
                .click(function() {
                    if ($(this).hasClass('stationlist-go')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("left");
                            $('#BackDirectionRoute').toggle("left");

                            pointRouteStopsLMap(true);

                            TrackObj.setStyle({
                                color: '#9863b6'
                            });
                            TrackObj.options.color="#9863b6";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt0 != null && objArr.wkt0.length != 0)){ if( map==null)
                            {}
                            else{
                                if( map==null)
                                {}
                                else{
                                    if (TrackObj != null)
                                    {
                                        map.removeLayer(TrackObj);
                                    }
                                    var wkt = new Wkt.Wkt();
                                    if (objArr.wkt0==null)
                                    {
                                        wkt.read(objArr.wkt);}
                                    else{
                                        wkt.read(objArr.wkt0);
                                    }
                                    TrackObj= wkt.toObject({
                                        color: '#9863b6',
                                        strokeColor: '#9863b6',
                                        strokeOpacity: 0.8,
                                        strokeWeight: 2,
                                        fillColor: '#9863b6',
                                        fillOpacity: 0.35,
                                        editable: false
                                    }); // Make an object
                                    TrackObj.setStyle({
                                        color: '#9863b6'
                                    });
                                    TrackObj.options.color="#9863b6";
                                    TrackObj.addTo(map);
                                }



                            }
                            }
                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();


                        }

                    }
                    if ($(this).hasClass('stationlist-come')) {
                        if ($(this).hasClass('stationlist-come-go')) {
                            event.preventDefault();
                        } else {
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go-gray');
                            $('.stationlist-go, .stationlist-come').toggleClass('stationlist-come-go');

                            $('#GoDirectionRoute').toggle("right");
                            $('#BackDirectionRoute').toggle("right");
                            pointRouteStopsLMap(false);

                            TrackObj.setStyle({
                                color: '#916955'
                            });
                            TrackObj.options.color="#916955";
                            if ((objArr.wkt != null && objArr.wkt.length != 0)||(objArr.wkt1 != null && objArr.wkt1.length != 0)) {if( map==null)
                            {}
                            else{
                                if (TrackObj != null)
                                {
                                    map.removeLayer(TrackObj);
                                }
                                var wkt = new Wkt.Wkt();
                                if (objArr.wkt1==null)
                                {
                                    wkt.read(objArr.wkt);}
                                else{
                                    wkt.read(objArr.wkt1);
                                }
                                TrackObj= wkt.toObject({
                                    color: '#9863b6',
                                    strokeColor: '#9863b6',
                                    strokeOpacity: 0.8,
                                    strokeWeight: 2,
                                    fillColor: '#9863b6',
                                    fillOpacity: 0.35,
                                    editable: false
                                }); // Make an object
                                TrackObj.setStyle({
                                    color: '#916955'
                                });
                                TrackObj.options.color="#916955";
                                TrackObj.addTo(map);
                            }}

                            stopStationStatusReport();
                            stationStatusReport();
                            stopBusStatusReport();
                            busStatusReport();
                        }

                    }
                });

            $('.stationlist-list-pool li a')
                .click(function() {
                    var idx = $(this).find('.auto-list-stationlist-number').text();
                    var activedMarker = overlays[(parseInt(idx) - 1)];
                    map.flyTo(activedMarker._latlng);
                    activedMarker.openPopup();
                    //google.maps.event.trigger(activedMarker, 'click');
                    //centerMapTo(activedMarker.getPosition().lat(), activedMarker.getPosition().lng());

                    var stopId = $(this).find('input[name="item.UniStopId"]').val();
                    document.getElementById("routeList").href = SitePath + "Stop/RoutesOfStop?stopid=" + stopId;
                    if('0454012600'=='0100020200' || '0454012600'=='0100027700')
                    {
                        stopStatusRecent3Report(stopId);//vic
                    }
                    //Set value to bus arrival alert dialog
                    $('#selected_stop_id').val(stopId);
                    $('#selected_stop_name').val($(this).find('.auto-list-stationlist-place').text());

                    $("#Toolbar")
                        .dialog({
                            autoOpen: true,
                            width: $('#Login_DL').width(),
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });

            $('#busAlert')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();

                    $("#SetAlertTime")
                        .dialog({
                            autoOpen: true,
                            width: 500,
                            modal: true,
                            show: {
                                effect: "clip",
                                duration: 600
                            },
                            buttons: {},
                            hide: {
                                effect: "clip",
                                duration: 500
                            }
                        });
                    $(".ui-dialog-titlebar").hide();
                });


            $('#addToMybus')
                .click(function() {
                    $("#Toolbar").dialog("close");
                    $("#Toolbar").dialog("destroy");
                    $("#Toolbar").hide();
                    var isSuccess = true;
                    $('#AddToMyBus').find('ul').html('');
                    $.ajax({
                        url: '/MyBus/MyBusGroup',
                        type: 'post',
                        dataType: 'json',
                        beforeSend: function() {
                        },
                        error: function(response) {
                            isSuccess = false;
                            toastr["error"](i18n._('Not log in'), "");
                        },
                        success: function(response) {
                            $.each(response,
                                function(idx, value) {
                                    $('#AddToMyBus')
                                        .find('ul')
                                        .append(
                                            $('<li></li>')
                                            .append($('<a>')
                                                .attr({ href: "javascript:AddMyBus('" + value.GroupId + "');" })
                                                .addClass('dialog-chose-bos-group')
                                                .append(value.GroupName))
                                        );
                                });
                        },
                        complete: function() {
                            if (isSuccess) {
                                $("#AddToMyBus")
                                    .dialog({
                                        autoOpen: true,
                                        modal: true,
                                        width: $('#Login_DL').width(),
                                        show: {
                                            effect: "clip",
                                            duration: 600
                                        },
                                        buttons: {},
                                        hide: {
                                            effect: "clip",
                                            duration: 500
                                        }
                                    });
                                $(".ui-dialog-titlebar").hide();
                            }
                        }
                    });
                });

            //$('.stationlist-move-table-icon')
            //    .click(function() {
            //        toggleRouteListAndChart();
            //    });

            $('.stationlist-bus-info-table-icon')
                .click(function() {
                    $('.stationlist-move-route-bus-info').slideToggle();
                });

            stationStatusReport();
            busStatusReport();


        });

        function AddMyBus(gid) {
            var RouteId = objArr.UniRouteId;
            var StopId = $('#selected_stop_id').val();
            $('#AddToMyBus').dialog("close");
            $('#AddToMyBus').dialog("destroy");
            $('#AddToMyBus').hide();
            addToMyBus(RouteId, StopId, gid);

        }

        function setAlertConfirm(stime) {
            var RouteId = objArr.UniRouteId;
            var RouteName = objArr.Name;
            var StopId = $('#selected_stop_id').val();
            var StopName = $('#selected_stop_name').val();
            var direction = $('.stationlist-back').hasClass('stationlist-come-go') ? 0 : 1;
            $('#SetAlertTime').dialog("close");
            $('#SetAlertTime').dialog("destroy");
            $('#SetAlertTime').hide();
            AlertAdd(RouteId, RouteName, StopId, StopName, direction, stime);
        }
    </script>


    <script>
       
        $(function () {
            window.alert = sweetAlert;

            // Selected language radio button
            $('input[name=culture]').click(function () {
                $('.teBUS-pad-main-nav-icon').slideToggle({
                    complete: function () {
                        $('#SetCultureForm').submit();
                    }
                })
            });
            $('#Loading_DL').show();
            $('#Loading_DL').dialog({
                autoOpen: false,
                modal: true,
                width: $('#Loading_DL').width(),
                minHeight: 60,
                show: false,
                buttons: {},
                hide: false
            });
            $(".ui-dialog-titlebar").hide();

            // Scroll to Top Action
            $('a.tebus-up').click(function () {
                $('body, html').animate({
                    scrollTop: 0
                }, 700);
                return false;
            });
        });

        function OpenLoadingDialog() {
            if ($('#Loading_DL').dialog("instance") !== undefined) {
                $('#Loading_DL').dialog("open");
            }
        }

        function CloseLoadingDialog() {
            $('#Loading_DL').dialog("close");
        }

        function toggleMenu() {
            $('.teBUS-pad-main-nav-icon').slideToggle();
        }

        function goTop() {
            window.document.body.scrollTop = 0;
        }

        //$(".nav-language-link").click(function () {
        //    href = $(this).attr('href');
        //    lang = href.match('(^|/?)?culture=([^&]*)(&|$)');

        //    localStorage["culture"] = lang[2];
        //});
    </script>
</body>


</html>
